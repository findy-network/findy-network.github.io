<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Findy Agency – Findy Agency Blog</title><link>/blog/</link><description>Recent content in Findy Agency Blog on Findy Agency</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Wed, 23 Aug 2023 00:00:00 +0000</lastBuildDate><atom:link href="/blog/index.xml" rel="self" type="application/rss+xml"/><item><title>Blog: GopherCon UK 2023</title><link>/blog/2023/08/23/gophercon-uk-2023/</link><pubDate>Wed, 23 Aug 2023 00:00:00 +0000</pubDate><guid>/blog/2023/08/23/gophercon-uk-2023/</guid><description>
&lt;p>At the beginning of this year, I set myself a target to speak at a Go programming language conference.
There were several reasons to do so. Go has been one of my favorite tools for years, and I have
longed for an excuse to join a Go event. Giving a speech was perfect for that purpose. Plus, I have
multiple excellent topics to share with the community as we do open-source development in our project,
and I can share our learnings along with our code more freely. Furthermore, I want to do my part
in having more diverse speakers at tech conferences.&lt;/p>
&lt;p>As Go released 1.20, it inspired me to experiment with &lt;a href="https://go.dev/testing/coverage/">the new feature to gather coverage data&lt;/a>
for binaries built with Go tooling. I refactored our application testing pipelines and thought this would
be an excellent topic to share with the community. I was lucky to get my speech accepted at
&lt;a href="https://www.gophercon.co.uk/">GopherCon UK&lt;/a> in London, so it was finally time to join my first Go conference.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 704px">
&lt;img class="card-img-top" src="/blog/2023/08/23/gophercon-uk-2023/cover_hu5906b065d7d590f2e4f28df9d31dde9c_1133672_925x925_fit_q75_catmullrom.jpeg" width="694" height="925">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The Brewery hosted the event. Surprisingly for London, weather was excellent during the whole conference.
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The conference was held in the Brewery, a relaxed event venue in London City. The word on the conference
halls was that the number of event sponsors had decreased from the previous year, and therefore, it
had been challenging to organize the event. Luckily, the organizers were able to pull things still together.&lt;/p>
&lt;p>Apart from the recession, the times are now interesting for Gophers. Many good things are happening
in the Go world. As Cameron Balahan pointed out in his talk &amp;ldquo;State of the Go Nation,&amp;rdquo;
&lt;a href="https://thenewstack.io/developers-most-likely-to-learn-go-and-rust-in-2023-survey-says/">Go is more popular than ever&lt;/a>.
More and more programmers have been adding Go to their tool pack in
recent years, pushing language developers to add new and better features. Moreover, Go is not only
a programming language anymore; it is a whole ecosystem with support for many kinds of tooling.
Newcomers have a way easier job to start with development than, for example, I had seven years ago.
Balahan stated that improving the onboarding of new developers is still one of the Go team&amp;rsquo;s top priorities.
He mentioned that they are working on the libraries, documentation, and error messages to help newcomers
and all Go developers be more productive.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2023/08/23/gophercon-uk-2023/cameron_hu021411883207ecf94c2aa62f7f1fd198_665973_925x925_fit_q75_catmullrom.jpeg" width="925" height="694">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Cameron Balahan is the product lead for Go.
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="automated-testing-and-test-coverage">Automated Testing and Test Coverage&lt;/h2>
&lt;p>The topic of my talk was &lt;a href="/pdf/gophercon-uk.pdf">&amp;ldquo;Boosting Test Coverage for Microservices.&amp;rdquo;&lt;/a>
I described in the presentation
how vital automated testing has become for our small team. Automated testing is usually the part you
skip when time is running out, but I tried to convince the audience that this might not be
the best approach – missing tests may bite you back in the end.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2023/08/23/gophercon-uk-2023/laura_hu61899e5853c80b7b3873aa8248a0051a_653900_925x925_fit_q75_catmullrom.jpeg" width="925" height="638">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>On the stage. Photo by Tapan Avasthi
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Furthermore, I discussed test coverage in the presentation along with how one can measure
test coverage for unit tests and now even - with the Go new tooling – for application tests, i.e.,
tests you run with the compiled application binary instead of unit testing tooling.&lt;/p>
&lt;p>The audience received the talk well, and I got many interesting questions. People are struggling
with similar issues when it comes to testing. It is tough to decide which functionality to simulate
in the CI pipeline. Also, we discussed problems when moving on to automated testing with
a legacy code base. The Go&amp;rsquo;s new coverage feature was unknown to most people, and some were eager
to try it out instantly after my session.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 704px">
&lt;img class="card-img-top" src="/blog/2023/08/23/gophercon-uk-2023/gophers_hu5cc80322cbd7e0327d757070b5193e94_401090_925x925_fit_q75_catmullrom.jpeg" width="694" height="925">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>All participants were given adorable Gopher mascots.
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Unfortunately, when you are a speaker at a conference, you cannot concentrate fully on
the conference program because one needs to prepare for the talk. However, I was lucky enough
to join some other sessions as well. There were mainly three themes that I gained valuable insights from.&lt;/p>
&lt;h2 id="logging-and-tracing">Logging and tracing&lt;/h2>
&lt;p>Generating better logs and traces for applications seems to be a hot topic – and no wonder why.
Services with high loads can generate countless amounts of data, and for the developers to use
the logs for fixing issues efficiently, they must be able to filter and search them.
The ability to debug each request separately is essential.&lt;/p>
&lt;p>Jonathan Amsterdam from Google gave an inspiring presentation on &lt;a href="https://go.dev/blog/slog">the slog package&lt;/a>,
the newest addition
to the standard library regarding logging. Go&amp;rsquo;s default logging capabilities have always lacked
features. The missing log levels have been the greatest pain point in my daily developer life.
More importantly, the ability to send structured data to analysis tools is crucial for
production systems. Until now, teams have had to use different kinds of 3rd party libraries
for this to happen.&lt;/p>
&lt;p>Now, the slog package fixes these shortcomings, with the ability to handle and merge
the data from existing structured logging tools. The presentation revealed how the team refined
the requirements for the new package together with the developer community. Also, it was fascinating
to hear which kind of memory management tricks the team used, as the performance requirements
for logging are demanding.&lt;/p>
&lt;p>Another exciting presentation handled also the capability of solving problems quickly, but instead
of logs, the emphasis was on tracing. Tracing provides a more detailed view of the program&amp;rsquo;s data
flow than logs and is especially useful when detecting performance bottlenecks.
Konstantin Ostrovsky described how their team is using
&lt;a href="https://opentelemetry.io/docs/instrumentation/go/getting-started/">OpenTelemetry&lt;/a>
to add traceability to incoming requests. Using this approach, they do not need
other logs in their codebase (excluding errors).&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2023/08/23/gophercon-uk-2023/konstantin_hudbbd84aab12f2662e3c18ce25d74eddd_498347_925x925_fit_q75_catmullrom.jpeg" width="925" height="694">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Konstantin Ostrovsky presenting OpenTelemetry usage with Go.
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>OpenTelemetry tracing uses &lt;a href="https://opentelemetry.io/docs/concepts/signals/traces/#spans">the concept of spans&lt;/a>
in the code.
One can utilize the spans to store the request data parameters and call relationships. Different
analysis tools can then visualize this data for a single request. According to Konstantin, these
visualizations help developers solve problems faster than searching and filtering ordinary logs.
However, in the presentation Q&amp;amp;A, he reminded us that one should use the spans sparingly
for performance reasons.&lt;/p>
&lt;h2 id="service-weaver">Service Weaver&lt;/h2>
&lt;p>&lt;a href="https://serviceweaver.dev/">Service Weaver&lt;/a> is an open-source project that another Google developer,
Robert Grandl, presented
at the conference. The tool allows one to develop a system as a monolith, as a single binary,
but the underlying framework splits the components into microservices in deployment time.
Therefore, development is easier when you do not have to worry about setting up the full microservices
architecture on your local machine. In addition, the deployment might be more straightforward when
you can work at a higher level.&lt;/p>
&lt;p>I participated in &lt;a href="https://github.com/serviceweaver/workshops">a workshop&lt;/a> that allowed participants
to try the Service Weaver hands-on.
The target was to build a full-blown web application with a web UI and a backend service from
which the UI could request data. Other sections described testing the weaver components, routing
from one service to another, and even calling external 3rd party services.&lt;/p>
&lt;p>The workshop suited me well;
I could learn more than just listening to a presentation. Furthermore, the topic interested me, and
I will dig into it more in the coming days to better understand which kind of projects would benefit
from this kind of development model the most. The workshop organizer promises that Google will not
stop investing in the product. They are searching for collaborators to get more feedback
to develop the product further.&lt;/p>
&lt;h2 id="ui-development-with-go">UI development with Go&lt;/h2>
&lt;p>Another topic that got my interest was a discussion group for UI development with Go.
Andrew Williams hosted this discussion and presented a project called &lt;a href="https://fyne.io/">Fyne&lt;/a> that allows
Gophers to write applications with graphical user interfaces for several platforms. UI development
is not my favorite thing to spend my time on; therefore, I am always curious to find better,
more fun ways to implement the mandatory user-clickable parts. Using Go would undoubtedly click
the fun box. So, I added another technology experiment to my TODO list.&lt;/p>
&lt;p>In addition to these three themes, one session that handled JWT security was also memorable.
Patrycja Wegrzynowicz hacked the audience live with the help of a small sample application
she had built for this purpose. It demonstrated which kind of vulnerabilities we Go developers
might have in our JWT implementations.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2023/08/23/gophercon-uk-2023/patrycja_hu6710682df499a5ad82f5d1d107993531_522066_925x925_fit_q75_catmullrom.jpeg" width="925" height="694">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Patrycja hacking the audience with JWTs.
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The presentation was informative and entertaining with the live hacking, and the audience
understood the problems well due to the hands-on examples. The session proved that no well-known
battle-tested documentation exists on handling the JWTs. We have (too) many different
libraries with different qualities, and it is easy to make mistakes with the token generation
and validation. No wonder the audience asked for a book on the subject from Patrycja – we need
better resources for a topic as important as this.&lt;/p>
&lt;h2 id="see-you-in-florence">See you in Florence&lt;/h2>
&lt;p>Overall, the event was well-organized, had a great atmosphere, and was fun to visit.
Meeting fellow Gophers, especially &lt;a href="https://www.womenwhogo.org/">the Women Who Go&lt;/a> members,
was a unique treat. Let&amp;rsquo;s set up our
chapter in Finland soon. (If you are a Finland-based woman who writes Go code, please reach out!)
I also got to spend some free time in London and share the World Cup final atmosphere
with the English supporters cheering for their team.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2023/08/23/gophercon-uk-2023/football_hu86facfbeb55e321fa28e162ae5d547d7_1211503_925x925_fit_q75_catmullrom.jpeg" width="925" height="694">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Public viewing event for the World Cup final.
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Bye til the next event; I hope we meet in &lt;a href="https://golab.io/">Florence&lt;/a> in November! In the meantime,
check out videos of the GopherCon UK 2023 sessions once they are published - I will do the same for
the ones I missed live!&lt;/p></description></item><item><title>Blog: Beautiful State-Machines - FSM Part II</title><link>/blog/2023/06/22/beautiful-state-machines-fsm-part-ii/</link><pubDate>Thu, 22 Jun 2023 00:00:00 +0000</pubDate><guid>/blog/2023/06/22/beautiful-state-machines-fsm-part-ii/</guid><description>
&lt;p>As I explained in &lt;a href="https://findy-network.github.io/blog/2023/03/13/no-code-ssi-chatbots-part-i/">my previous blog
post&lt;/a>,
the idea of chatbots came quite naturally for our SSI development team. Think
tanks or research labs are outstanding workplaces when you have something to chew.
And how juicy topic the SSI has been, oh boy.&lt;/p>
&lt;p>FSM chatbots started as a thought experiment, but now, when I think of the
invention, it has been quite clever in foreseeing genuine user needs. It has
lead us towards the following layer model.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 2563px">
&lt;img class="card-img-top" src="/blog/2023/06/22/beautiful-state-machines-fsm-part-ii/layers_huc401822c3d0db0f1b03a6299777b88f3_2353012_2553x0_resize_catmullrom_3.png" width="2553" height="1377">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Network Layers For SSI Are Clarifying Themselves&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The preceding drawing presents our ongoing layer architecture. It&amp;rsquo;s (still)
based on DIDComm, but because our protocol engine implements a
technology-agnostic API, we can change the implementation to something better
without disturbing the above layers. The subject of this blog post is &lt;strong>our FSM
engine&amp;rsquo;s&lt;/strong> (&lt;em>3rd layer from bottom&lt;/em>) CSP implementation that offers even more
abstraction and helps the application development with &lt;a href="https://findy-network.github.io/blog/2023/03/13/no-code-ssi-chatbots-part-i/#the-fsm-language">no-code chatbot
language&lt;/a>.&lt;/p>
&lt;h2 id="abstraction-layers">Abstraction Layers&lt;/h2>
&lt;p>Implementing the FSM chatbots with our protocol-agnostic API has been
eye-opening. With our API, we have solved most of the complexity problems and
brought in an elegant communication layer that hides most of the horror of DID
system, which, by to way, is not application development ready.&lt;/p>
&lt;p>The objective of this blog post is to present a comprehensive exploration of my
Go-based finite state-machine implementation that leverages Go&amp;rsquo;s CSP concurrency
mechanism. This post will showcase the practical applications and benefits of
using Go and CSP in building reliable and concurrent state management systems.&lt;/p>
&lt;h2 id="concurrency-ne-parallelism">Concurrency \(\ne\) Parallelism&lt;/h2>
&lt;p>I have been using multithreading programming all my career and closely
monitoring paradigms of multithreading programming since the 90s. When I started
playing with Go’s channels and &lt;a href="https://en.wikipedia.org/wiki/Communicating_sequential_processes">CSP programming
model&lt;/a>, I
learned how easy it was compared to other asynchronous or multithreading
programming models.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 473px">
&lt;img class="card-img-top" src="/blog/2023/06/22/beautiful-state-machines-fsm-part-ii/interrupt_hu136a998f0a715f31af0676e8582771a1_34484_463x0_resize_q75_catmullrom.jpg" width="463" height="410">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Interrupt Based Scheduling -- Mark Siegesmund, in Embedded C Programming, 2014&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>If I look at the phases I have gone thru, they follow these steps harshly:&lt;/p>
&lt;ol>
&lt;li>Using interrupts to achieve concurrency. (&lt;em>MS-DOS drivers and
&lt;a href="https://en.wikipedia.org/wiki/Terminate-and-stay-resident_program">TSRs&lt;/a>,
modem-based distributed systems, games, etc.&lt;/em>)&lt;/li>
&lt;li>Using the event-driven system to achieve concurrency. (&lt;em>Game development, GUI
OS Win&amp;amp;Mac, transport-agnostic, i.e., modems, &lt;a href="https://people.ece.ubc.ca/gillies/pages/9802net.html">proprietary protocols for
interconnection&lt;/a>,
&lt;a href="https://tangentsoft.com/wskfaq/articles/history.html">Winsocks&lt;/a> file
transport framework, etc.&lt;/em>)&lt;/li>
&lt;li>Using OS and HW threads to achieve concurrency. (&lt;em>Unix daemon and Win
NT service programming, C/S transport framework implementations, telehealth
system implementation, etc.&lt;/em>)&lt;/li>
&lt;li>Sharing workloads between CPU and GPU to achieve maximum parallel execution.
(&lt;em>The front/back-buffer synchronization, i.e., &lt;a href="https://algorithm-wiki.csail.mit.edu/wiki/Culling">culling
algorithms&lt;/a> and
&lt;a href="https://en.wikipedia.org/wiki/Level_of_detail_(computer_graphics)">LOD&lt;/a> are
running simultaneously in a CPU during the GPU is rendering the polygons of
the previous frame, etc.&lt;/em>)&lt;/li>
&lt;li>Using libraries and frameworks
(&lt;a href="https://developer.apple.com/documentation/swift/task">tasks&lt;/a>, work queues,
&lt;a href="https://en.wikipedia.org/wiki/Actor_model">actor model&lt;/a>, etc.) to
achieve parallel execution for performance reasons. (&lt;em>Using
&lt;a href="https://learn.microsoft.com/en-us/dotnet/standard/parallel-programming/task-parallel-library-tpl">TPL&lt;/a>
to instantiation (i.e., common transformation matrix) pipeline for tessellated
graphic units, etc.&lt;/em>)&lt;/li>
&lt;li>Using frameworks to bring parallel execution to the application level,
wondering why the industry starts taking steps back and prefers asynchronous
programming models over, for example, worker threads. One answer: keep
everything in the main thread. (&lt;em>iOS [recommended] network programming, Dart
language, node.js, etc.&lt;/em>)&lt;/li>
&lt;li>Using CSP to hide HW details and still achieve a speedup of parallel execution,
but only if it&amp;rsquo;s used correctly. (&lt;em>Example: Input routine -&amp;gt; Processing -&amp;gt; Output
routine -pattern to remove blocking IO waits, etc.&lt;/em>)&lt;/li>
&lt;/ol>
&lt;p>As you can see, distributed computing goes hand in hand with concurrency. And
now distributed systems are more critical than ever.&lt;/p>
&lt;p>And what goes around comes around. Now we&amp;rsquo;re using a &lt;a href="https://github.com/golang/go/issues/51071#issuecomment-1033108591">hybrid
model&lt;/a> where
the scheduler combines OS threads (preemptive multitasking) and cooperative
event handling. But like everything in performance optimization, this model
isn&amp;rsquo;t the fastest or &lt;a href="https://go.dev/blog/waza-talk">doesn&amp;rsquo;t give you the best possible
parallelization&lt;/a> results for every algorithm. But
it seems to provide enough, and it offers a simple and elegant programming model
that almost all developers can reason with.&lt;/p>
&lt;blockquote>
&lt;p>Note. Go offers &lt;a href="https://pkg.go.dev/runtime#LockOSThread">&lt;code>runtime.LockOSThread&lt;/code>
function&lt;/a> if you want to maximize
parallelization by allocating an OS thread for a job.&lt;/p>
&lt;/blockquote>
&lt;h2 id="fsm----state-of-the-art">FSM &amp;ndash; State-Of-The-Art&lt;/h2>
&lt;p>Previous technology spikes have proven that state machines would be the right
way to go, but I would need to try it with, should I say, complete state
machines. And that was our hypothesis: &lt;em>FSM perfectly matches SSI and
DIDComm-based chatbots&lt;/em>.&lt;/p>
&lt;p>One of my design principles has always been that never create a new language,
always use an existing one. So, I tried to search for proper candidates, and I
did find a few.&lt;/p>
&lt;h3 id="scxml">SCXML&lt;/h3>
&lt;p>The most promising and exciting one was
&lt;a href="https://www.w3.org/TR/scxml/">SCXML&lt;/a>, but I didn&amp;rsquo;t find a suitable embedded
engine to run these machines, especially as an open-source. Nevertheless, very
interesting &lt;a href="https://blogs.itemis.com/en/how-to-create-robust-system-models-with-yakindu-statechart-tools-and-verification-tools">commercial high-end
tools&lt;/a>
supported
&lt;a href="https://en.wikipedia.org/wiki/Correctness_(computer_science)">correctness&lt;/a>
verification using &lt;a href="https://en.wikipedia.org/wiki/Proof_theory">proving theorems&lt;/a>.&lt;/p>
&lt;h3 id="lua">Lua&lt;/h3>
&lt;p>During these state-machine language searches, I discovered &lt;a href="https://github.com/Shopify/go-lua">a Go-native
implementation of Lua&lt;/a>, which was
open-source. Naturally, I considered using embedded Lua&amp;rsquo;s model of
states. But I realized that some event engine would be needed, and it
would have brought at least the following challenges:&lt;/p>
&lt;ol>
&lt;li>Whole new API and bridge to Aries protocols would be needed. A simple C/S API
wouldn&amp;rsquo;t be enough, but a notification system would also be required.&lt;/li>
&lt;li>Lua is a Turing-complete language (correctness guarantees, the halting
problem, etc.)&lt;/li>
&lt;li>And final question: what extra would we be brought in when compared to
offering Lua stubs to our current gRPC API, i.e., Lua would be treated the
same as all the other languages that gRPC supports?&lt;/li>
&lt;/ol>
&lt;h3 id="yaml">YAML&lt;/h3>
&lt;p>I soon discovered that YAML might be an excellent language for FSM because it’s
proven to work for &lt;a href="https://en.wikipedia.org/wiki/Declarative_programming">declarative
solutions&lt;/a> like container
orchestration and many cloud frameworks.&lt;/p>
&lt;p>Naturally, I tried to search OSS solution that would be based on YAML and would
offer a way to implement a state-machines event processor. Unfortunately, I
didn’t find a match, so we made our hybrid by offering two languages, YAML and
Lua.&lt;/p>
&lt;p>Lua is now included as an embedded scripting language &lt;em>for
our FSM&lt;/em>. It can be used to &lt;a href="https://findy-network.github.io/blog/2023/03/13/no-code-ssi-chatbots-part-i/#event">implement custom
triggers&lt;/a>
and custom output events.&lt;/p>
&lt;p>You can write Lua directly to YAML files or include a file link and write Lua
scripts to external files. (&lt;em>Depending on the deployment model, that could be
a security problem, but we are in an early stage of the technology. Our
deployment model is closed. The final step to solve all security problems
related to deployment and injection is when we have an integrated correctness
tool.&lt;/em>)&lt;/p>
&lt;h2 id="the-event-processor">The Event Processor&lt;/h2>
&lt;p>Our FSM engine follows the exact same principle as &lt;a href="https://en.wikipedia.org/wiki/SCXML">the SCXML processor&lt;/a> does:&lt;/p>
&lt;blockquote>
&lt;p>An SCXML processor is a pure event processor. The only way to get data into an
SCXML state machine is to send external events to it. The only way to get data
out is to receive events from it.&lt;/p>
&lt;/blockquote>
&lt;p>In the software industry, there are some other similar systems, like, for example,
&lt;a href="https://ebpf.io/">eBPF&lt;/a>, where correctness is provided without formal language.
eBPF automatically &lt;strong>rejects programs without strong exit guarantees&lt;/strong>, i.e.,
for/while loops without exit conditions. That&amp;rsquo;s achieved with static code
analysis, which allows using conventional programming languages.&lt;/p>
&lt;p>Now that &lt;em>we have brought Lua-scripting into our FSMs&lt;/em>, we should also get
&lt;em>code analysis for the exit guarantees&lt;/em>, but let&amp;rsquo;s first figure out how
good a fit it is. My first impressions have been excellent.&lt;/p>
&lt;h2 id="services-and-conversations">Services and Conversations&lt;/h2>
&lt;p>The drawing below includes our multi-tenant model. FSM instances and their
memory containers are on the right-hand side of the diagram. The smaller ones
are conversation instances that hold the state of each pairwise connection
status. The larger one is &lt;em>the service state machine&lt;/em>.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1640px">
&lt;img class="card-img-top" src="/blog/2023/06/22/beautiful-state-machines-fsm-part-ii/cover-logical_hu3cc2cb8ee146ca056e4d93ad4b3d07f3_957927_1630x0_resize_catmullrom_3.png" width="1630" height="1111">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Two Tier Multi-tenancy&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The service FSM is needed if the SSI agent implements a chatbot that needs to keep
track of all of the conversations like polling, voting, &lt;strong>chat rooms&lt;/strong> (used as
an example), etc.&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-plantuml" data-lang="plantuml">title Chat Room Example
actor &amp;#34;Dude&amp;#34; as Dude
participant &amp;#34;Dude&amp;#34; as ChatUI &amp;lt;&amp;lt;chat UI&amp;gt;&amp;gt;
collections &amp;#34;Dudes&amp;#34; as ReadUI &amp;lt;&amp;lt;read UI&amp;gt;&amp;gt;
collections &amp;#34;Conversation Bots&amp;#34; as PWBot &amp;lt;&amp;lt;pairwise FSM&amp;gt;&amp;gt;
control &amp;#34;Chat Room Service Bot&amp;#34; as Backend
== A Dude writes line ==
Dude -&amp;gt; ChatUI: Yo!
ChatUI -&amp;gt; PWBot: BasicMessage{&amp;#34;Yo!&amp;#34;}
|||
== Conversation FSM forwards msg to service FSM ==
PWBot -&amp;gt; Backend: BackendMsg{&amp;#34;Yo!&amp;#34;}
loop conversation count
Backend -&amp;gt; PWBot: BackendMsg{&amp;#34;Yo!&amp;#34;}
== transport message thru pairwise connection ==
PWBot -&amp;gt; ReadUI: BasicMessage{&amp;#34;Yo!&amp;#34;}
end
|||
&lt;/code>&lt;/pre>&lt;p>As the sequence diagram above shows, the service FSM conceptually presents a
chat room and works as a mediator between chat room participants.&lt;/p>
&lt;p>The next Go code block shows how the above FSM instances are declared at the
programming level. Note that &lt;code>ServiceFSM&lt;/code> is optional and seldom needed. The
rest of the data is pretty obvious:&lt;/p>
&lt;ul>
&lt;li>gRPC connection, &lt;code>conn&lt;/code>&lt;/li>
&lt;li>conversation FSM, &lt;code>md&lt;/code>&lt;/li>
&lt;li>and interrupt channel is given as a startup argument, &lt;code>intCh&lt;/code>, because here,
the machine is started from the CLI tool&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">intCh&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#204a87">make&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">chan&lt;/span> &lt;span style="color:#000">os&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Signal&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">signal&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Notify&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">intCh&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">syscall&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SIGTERM&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">syscall&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SIGINT&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">chat&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Bot&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Conn&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">conn&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// gRPC connection including JWT, etc.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">MachineData&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">md&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// primary FSM data, i.e. pairwise lvl
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">ServiceFSM&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">mdService&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// optional backend/service lvl FSM
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">}.&lt;/span>&lt;span style="color:#000">Run&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">intCh&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// let machine to know when it&amp;#39;s time to quit
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>By utilizing the CSP model, we embrace a paradigm that emphasizes the
coordination and communication between independently executing components, known
as goroutines, in a safe and efficient manner. This combination of Go&amp;rsquo;s
built-in concurrency primitives empowers us developers to create highly
concurrent systems while maintaining clarity and simplicity in their code.&lt;/p>
&lt;h2 id="csp--go-code">CSP &amp;amp; Go Code&lt;/h2>
&lt;p>The app logic is in the state machines written in YAML and Lua. But
surprising is how elegant the Go implementation can be when CSP is
used for the state-machine processor. And all of that without a single mutex or
other synchronization object.&lt;/p>
&lt;p>The code block below is the crucial component of the FSM engine solution. It is
presented as it currently is in the code repo, because I want to show honestly
how simple the implementation is. Even the all lines aren&amp;rsquo;t relevant for
this post. They are left for you to study and understand how powerful the CSP
model for concurrency is.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000">Multiplexer&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">info&lt;/span> &lt;span style="color:#000">MultiplexerInfo&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">glog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">V&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">Infoln&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;starting multiplexer&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ConversationMachine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">FType&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">termChan&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#204a87">make&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">fsm&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TerminateChan&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">backendChan&lt;/span> &lt;span style="color:#000">fsm&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BackendInChan&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BackendMachine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">IsValid&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">b&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">newBackendService&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">backendChan&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BackendChan&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">fsm&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewMachine&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BackendMachine&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Initialize&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">InitLua&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">glog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">V&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">Infoln&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;starting and send first step:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BackendMachine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">FType&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">send&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Start&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">fsm&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TerminateOutChan&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TerminateChan&lt;/span>&lt;span style="color:#000;font-weight:bold">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">glog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">V&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">Infoln&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;going to for loop:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BackendMachine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">FType&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">select&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// NOTE. It&amp;#39;s OK to listen nil channel in select.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">bd&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">backendChan&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">backendMachine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">backendReceived&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">bd&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">d&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">ConversationBackendChan&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">alreadyExists&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">conversations&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">d&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ToConnID&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">assert&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">That&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">alreadyExists&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;backend msgs to existing conversations only&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BackendChan&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span> &lt;span style="color:#000">d&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">t&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">Status&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">connID&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">t&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Notification&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ConnectionID&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">alreadyExists&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">conversations&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">connID&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">!&lt;/span>&lt;span style="color:#000">alreadyExists&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">newConversation&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">connID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">termChan&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">StatusChan&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span> &lt;span style="color:#000">t&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">question&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">Question&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">connID&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">question&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Status&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Notification&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ConnectionID&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">alreadyExists&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">conversations&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">connID&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">!&lt;/span>&lt;span style="color:#000">alreadyExists&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">newConversation&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">connID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">termChan&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">QuestionChan&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span> &lt;span style="color:#000">question&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">termChan&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// One machine has reached its terminate state. Let&amp;#39;s signal
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// outside that the whole system is ready to stop.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">InterruptCh&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span> &lt;span style="color:#000">syscall&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SIGTERM&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>It runs in its goroutine and serves all the input and output at the process
level. For those who come from traditional multi-thread programming, this might
look weird. You might ask why a lock doesn&amp;rsquo;t make &lt;code>conversations&lt;/code> map thread-safe.
That&amp;rsquo;s the beauty of the CSP. Only this goroutine modifies &lt;code>conversations&lt;/code>
data—no one else.&lt;/p>
&lt;p>You might ask if there&amp;rsquo;s a performance penalty in this specific solution, but
there is not. The &lt;code>Multiplexer&lt;/code> function doesn&amp;rsquo;t do anything that&amp;rsquo;s
computationally extensive. It listens to several Go channels and delegates the
work to other goroutines.&lt;/p>
&lt;p>This model has proven to be easy to understand and implement.&lt;/p>
&lt;h3 id="discrete-state-transitions">Discrete State Transitions&lt;/h3>
&lt;p>As we saw, the &lt;code>Multiplexer&lt;/code> function calls a function below, &lt;code>backendReceived&lt;/code>,
when &lt;code>data&lt;/code> arrives from &lt;code>backendChan&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">b&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">Backend&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">backendReceived&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">data&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">fsm&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BackendData&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">transition&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TriggersByBackendData&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span> &lt;span style="color:#000">transition&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">send&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">transition&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BuildSendEventsFromBackendData&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Step&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">transition&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Both state-machine types (conversation/service level) follow typical transition
logic:&lt;/p>
&lt;ol>
&lt;li>Do we have a trigger in the current state of the machine?&lt;/li>
&lt;li>If the trigger exists, we&amp;rsquo;ll get a transition object for that.&lt;/li>
&lt;li>Ask the &lt;code>transition&lt;/code> to build all send events according to input data.&lt;/li>
&lt;li>Send all output events.&lt;/li>
&lt;li>If previous steps did succeed, make a state transition step explicit.&lt;/li>
&lt;/ol>
&lt;h3 id="channels-orchestrate-mutexes-serialize">&amp;ldquo;Channels orchestrate; mutexes serialize&amp;rdquo;&lt;/h3>
&lt;p>I&amp;rsquo;m not a massive fan of the &lt;a href="https://dave.cheney.net/2020/02/23/the-zen-of-go">idiomatic
Go&lt;/a> or &lt;a href="https://go-proverbs.github.io/">Go
proverbs&lt;/a>. My point is that you shouldn&amp;rsquo;t
need them. The underlying semantics should be strong enough.&lt;/p>
&lt;p>Luckily the world isn&amp;rsquo;t black and white. So, let&amp;rsquo;s use one proverb to state
something quite obvious.&lt;/p>
&lt;blockquote>
&lt;p>&amp;ldquo;Channels orchestrate; mutexes serialize&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;p>That includes excellent wisdom because it isn&amp;rsquo;t prohibiting you from using the
mutexes. It clearly states that we need both, but they are used differently.
That said, the below code block shows the &lt;em>elegance&lt;/em> you can achieve with Go
channels.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">Conversation&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">Run&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">data&lt;/span> &lt;span style="color:#000">fsm&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">MachineData&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">fsm&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewMachine&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Initialize&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">InitLua&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">send&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">machine&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Start&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">fsm&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TerminateOutChan&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TerminateChan&lt;/span>&lt;span style="color:#000;font-weight:bold">)),&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">select&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">t&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">StatusChan&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">statusReceived&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">t&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">q&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">QuestionChan&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">questionReceived&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">q&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">hookData&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">HookChan&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">hookReceived&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">hookData&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">backendData&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BackendChan&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">c&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">backendReceived&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">backendData&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>If you have never seen a code mess where a programmer has tried to solve a
concurrence task by only having common control flow statements like if-else,
attempt to envision an amateur cook that tries to make at least four dishes
simultaneously with poor multitasking capabilities. He has to follow recipes
literally for every dish from several cookbooks. I think then you get the
picture.&lt;/p>
&lt;h2 id="conclusion">Conclusion&lt;/h2>
&lt;p>I hope I have shown you how well FSM and CSP fit together. Maybe I even
encouraged you to agree that SSI needs &lt;a href="http://findy-network.github.io/blog/2022/03/05/the-missing-network-layer-model/">better abstraction
layers&lt;/a>
before we can start full-scale application development. If you agree we&amp;rsquo;re
on the right path, please join and start coding with us!&lt;/p></description></item><item><title>Blog: The Agency Workshop</title><link>/blog/2023/06/13/the-agency-workshop/</link><pubDate>Tue, 13 Jun 2023 00:00:00 +0000</pubDate><guid>/blog/2023/06/13/the-agency-workshop/</guid><description>
&lt;p>During the Findy Agency project, our development team initially placed greater emphasis on running
and deploying the agency in terms of documentation.
Due to this prioritization, instructions on building agency
clients have gotten less attention. We have now fixed this shortcoming by publishing &lt;a href="https://github.com/findy-network/agency-workshop">the agency workshop&lt;/a>
to educate developers on using, building, and testing agency clients.&lt;/p>
&lt;h2 id="agency-clients">Agency Clients&lt;/h2>
&lt;p>What exactly is an agency client? A client is a piece of software operated by an entity with
an identity (individual, organization, or thing). In the agency context, we have three types of clients:&lt;/p>
&lt;ol>
&lt;li>CLI: a tool for managing the identity agent in the cloud using the command line interface.&lt;/li>
&lt;li>Web Wallet: a web-based user interface for holding and proving credentials through a web browser.&lt;/li>
&lt;li>API client: any application that manages the identity agent with Findy Agency API.&lt;/li>
&lt;/ol>
&lt;p>The workshop shows how to use the ready-built clients (&lt;a href="https://github.com/findy-network/findy-agent-cli">CLI tool&lt;/a>
and &lt;a href="https://github.com/findy-network/findy-wallet-pwa">web wallet&lt;/a>) and start
the development using the API. The workshop participant can choose from two tracks, the CLI track,
which demonstrates the agent operations with the CLI tool, and the code track, which
concentrates on the API calls and testing them with the web wallet. Both workshop branches
teach hands-on how SSI&amp;rsquo;s basic building blocks work. Consequently, the participant learns
how to issue, receive and verify credentials utilizing the Findy Agency platform.&lt;/p>
&lt;p>&lt;img src="https://github.com/findy-network/agency-workshop/raw/master/track2.1-ts/docs/app-overview.png" />&lt;br>&lt;/p>
&lt;p>&lt;em>The code track instructs on building a simple web application that issues and verifies credentials.&lt;/em>&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="/blog/2023/02/06/how-to-equip-your-app-with-vc-superpowers/cover-issue.png"/>
&lt;/figure>
&lt;em>Testing for the code track can be done using the web wallet application.&lt;/em>&lt;/p>
&lt;p>&lt;strong>The workshop material is suitable for self-studying.&lt;/strong> In this case, if the developer
does not have an instance of the agency running in the cloud, using a localhost deployment
with Docker containers is straightforward. The material is available in &lt;a href="https://github.com/findy-network/agency-workshop">a public
GitHub repository&lt;/a>,
containing step-by-step instructions that are easy to follow.
Developers can choose the development environment according to their preferences,
from native localhost setting to VS Code dev container or &lt;a href="https://github.com/findy-network/agency-workshop-codespace">GitHub Codespaces&lt;/a>.&lt;/p>
&lt;h2 id="live-workshops">Live Workshops&lt;/h2>
&lt;p>The Findy Agency team has organized the workshop also in a live setting.
We invited developers from our company interested in future technologies
to technical sessions for learning together. These sessions took place in both Helsinki and Oulu
during Spring 2023.&lt;/p>
&lt;p>The events started with Harri explaining
&lt;a href="/docs/slides/introduction-to-ssi/">the basic SSI principles&lt;/a>
and then Laura presenting &lt;a href="https://www.youtube.com/@optechlab9732/videos">demos of agency client applications&lt;/a>
that the team has built in the past. The introductory presentations generated
many exciting questions and discussions that helped the participants better understand the concept.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 835px">
&lt;img class="card-img-top" src="/blog/2023/06/13/the-agency-workshop/harri_hu20b97f8b579ec42214538420dae58f7c_1929473_825x825_fit_q75_catmullrom.jpeg" width="825" height="619">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Harri introducing SSI principles.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>After the introduction part, the participants could pick the track they were going to work on,
and they had a chance to advance with the tasks at their own pace. The developers could use a
shared agency installation in the cloud, so, in principle, setting up the development environment
was relatively effortless.&lt;/p>
&lt;p>Unfortunately, during the first session, we encountered challenges with the shared cloud agency
and observed a few inconsistencies in the instructions for configuring the development environment.
We addressed these findings before the second session was held, which proved highly successful.
In fact, the second workshop was so seamless that the instructors found it almost uneventful,
as nearly no participants needed assistance.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 835px">
&lt;img class="card-img-top" src="/blog/2023/06/13/the-agency-workshop/cover-workshop_hufffe575bc6bc80784834aaeb7d2cddf8_209278_825x825_fit_q75_catmullrom.jpeg" width="825" height="619">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The happy bunch at Helsinki event.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Both events received good feedback, as working hands-on helped the participants understand
more deeply the idea behind the technology and how one can integrate the tooling into
any application. The participants also thought these workshops were an inspiring way
to learn new things. Future ideas were to organize a hackathon-style event where
the teams could concentrate more on the actual use cases now that they understand the basic tooling.&lt;/p>
&lt;h2 id="are-you-ready-to-take-the-challenge">Are You Ready to Take the Challenge?&lt;/h2>
&lt;p>We recommend the workshop for all developers who are interested in decentralized identity.
The tasks require no special skills and have detailed instructions on how to proceed
to the next step. Even non-technical people have been able to do the workshop successfully.&lt;/p>
&lt;p>We are happy to take any feedback on how to make the material even better!
You can reach us via SoMe channels:&lt;/p>
&lt;div style="display: flex">
&lt;span>
&lt;img src="https://avatars.githubusercontent.com/u/29113682?v=4%22" width="100"/>
&lt;div>Laura&lt;/div>
&lt;div>&lt;a href="https://github.com/lauravuo/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-github ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://www.linkedin.com/in/lauravuorenoja/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-linkedin ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://fosstodon.org/@lauravuo" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-mastodon ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://twitter.com/vuorenoja" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-twitter ml-2 ">&lt;/i>&lt;/a>&lt;/div>
&lt;/span>&lt;span style="padding-left: 2em">
&lt;img src="https://avatars.githubusercontent.com/u/11439212?v=4" width="100">
&lt;div>Harri&lt;/div>
&lt;div>&lt;a href="https://github.com/lainio/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-github ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://www.linkedin.com/in/harrilainio/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-linkedin ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://twitter.com/harrilainio" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-twitter ml-2 ">&lt;/i>&lt;/a>&lt;/div>
&lt;/span>&lt;/div>&lt;br>&lt;br></description></item><item><title>Blog: The Time to Build SSI Capabilities Is Now</title><link>/blog/2023/06/09/the-time-to-build-ssi-capabilities-is-now/</link><pubDate>Fri, 09 Jun 2023 00:00:00 +0000</pubDate><guid>/blog/2023/06/09/the-time-to-build-ssi-capabilities-is-now/</guid><description>
&lt;p>During hallway discussions with various teams and organizations in recent months, I have been
surprised by the emphasis on the underlying technology in SSI implementations. Even non-technical
folks are wondering, e.g., which credential format will overcome them all. Don&amp;rsquo;t get me wrong;
it&amp;rsquo;s not that I don&amp;rsquo;t see the importance of choosing the most interoperable, best performant,
and privacy-preserving cryptography. I am afraid more critical problems keep hiding when
we concentrate only on technical issues.&lt;/p>
&lt;h2 id="focus-on-the-use-cases">Focus on the Use Cases&lt;/h2>
&lt;p>Teams implementing flows utilizing SSI capabilities should focus primarily on the use case and,
more importantly, the user experience. If the flow requires an individual to use a wallet application
and several different web services, many users have a steep learning curve ahead of them.
It can even be too steep. Furthermore, we should also think outside of &amp;ldquo;the individual-user-box.&amp;rdquo;
How can we utilize this technology in a broader range of use cases, for instance,
inter-organizational transactions?&lt;/p>
&lt;p>Therefore, we need more real-world use cases implemented with SSI technology to develop it correctly.
After all, the use cases should ultimately be the source of the requirements, the drivers of how
to bring the technology further. And if use case implementors are waiting for the technology
to become ready, we have a severe chicken-egg problem.&lt;/p>
&lt;p>Instead of overthinking the low-level crypto operations, etc., the teams should concentrate
on the high-level building blocks of SSI. The starting point should clarify
the roles of the issuer, holder, and verifier. What exactly happens when data is
issued and verified? And how can the team apply the verifiable data in the use case
in question: who are the issuer, holder, and verifier? Furthermore, what data does
the issuer sign, and which part is available to the verifier?&lt;/p>
&lt;h2 id="it-is-all-about-communication">It Is All About Communication&lt;/h2>
&lt;p>After figuring out answers to these questions, the selection of the technical stack
becomes more relevant. However, even then, I wouldn&amp;rsquo;t emphasize the credential
format selection. What is even more important is the used credential exchange protocol.&lt;/p>
&lt;p>For instance, if your primary use case is user identification and authentication,
and you wish to create an architecture that suits well and fast in the legacy world,
the most straightforward choice is a protocol offering strict client-server roles
and HTTP-request-response style API. In this style, the issuer, holder, and
verifier roles are hard-coded, and one party cannot simultaneously play multiple roles.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2023/06/09/the-time-to-build-ssi-capabilities-is-now/cover-trust-triangle-protocols_hud4c9f163dd94c7a00cb0385dd911a622_424603_925x925_fit_catmullrom_3.png" width="925" height="485">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>DIDComm and Hyperledger Aries are examples of a symmetric protocols. Findy Agency
supports currently both.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>However, choosing a symmetric protocol may widen the spectrum of your use cases.
Participants can execute different functions during the interaction in a symmetric protocol.
So, for example, in the user authentication scenario, in addition to the service (server)
authenticating the user (client) based on verified data, the individual could
also get a verification from the service-operating organization of its authenticity.&lt;/p>
&lt;p>&lt;em>For more information, I recommend to familiarize with Daniel Hardman&amp;rsquo;s publications,
for example &lt;a href="https://daniel-hardman.medium.com/sentries-confessionals-vaults-and-envelopes-4a58cf4f8a5a">the summary&lt;/a>
about the overlaps of different SSI technologies.&lt;/em>&lt;/p>
&lt;h2 id="integrate-carefully">Integrate Carefully&lt;/h2>
&lt;p>Whichever stack you choose, there are two things to keep in mind&lt;/p>
&lt;ol>
&lt;li>Implement the integration to the library or service providing SSI functionality following
well-known modular principles so that it is easy to replace with a different library or service.&lt;/li>
&lt;li>Do not let the underlying technology details contaminate your application code.
Thus, ensure the SSI tooling you use hides the implementation details related
to credentials formats and protocol messages from your application.
This approach ensures that changes, for example, to the credential data format,
have a manageable effect on your application.&lt;/li>
&lt;/ol>
&lt;p>The importance of layered architecture has been discussed also before &lt;a href="https://findy-network.github.io/blog/2022/03/05/the-missing-network-layer-model/">in our blog&lt;/a>.&lt;/p>
&lt;p>&lt;br>&lt;img src="https://github.com/findy-network/agency-demo/raw/master/client/public/seo-logo.jpg?raw=truef" width="800px" />&lt;br>&lt;/p>
&lt;p>&lt;em>Decentralized Identity Demo is a cool SSI simulation. Its original developer is &lt;a href="https://animo.id/">Animo&lt;/a>,
and the SSI functionality was done using &lt;a href="https://github.com/hyperledger/aries-framework-javascript">aries-framework-javascript&lt;/a>.
As an experiment for SSI technology portability, I took
the open-sourced codes and converted the application to use &lt;a href="https://findy-network.github.io/">Findy Agency&lt;/a>
instead of AFJ. You can find both &lt;a href="https://github.com/animo/animo-demo">the original codes&lt;/a>
and &lt;a href="https://github.com/findy-network/agency-demo">my version&lt;/a> in GitHub.&lt;/em>&lt;/p>
&lt;p>The best option is to pick open-source tooling so that if some functionality is missing,
you can roll up your sleeves and implement it yourself. If this is not an option,
select a product that ensures compatibility with multiple flavors of SSI credentials
and data exchange protocols so that interoperability with other parties is possible.
After all, interoperability is one of the decentralization enablers.&lt;/p>
&lt;h2 id="the-time-is-now">The Time Is Now&lt;/h2>
&lt;p>The recent advancements in LLM technology and ChatGPT offer a glimpse of what&amp;rsquo;s possible
when large audiences can suddenly access new technology that provides them added value.
SSI can potentially revolutionize digital services similarly, and organizations
should prepare for this paradigm shift. Is your organization ready when this transformation takes place?&lt;/p>
&lt;p>In conclusion, now is the time to plan, experiment and build SSI capabilities. Begin
by understanding the high-level building blocks and experimenting with the technology
that best aligns with your use case. Opt for tools that support a layered architecture design,
like Findy Agency. This approach prevents the need for significant alterations
to the application layer as the technology evolves.&lt;/p></description></item><item><title>Blog: Digital Identity Hack Part 3 – Introduction to SSI Presentation</title><link>/blog/2023/05/25/digital-identity-hack-part-3-introduction-to-ssi-presentation/</link><pubDate>Thu, 25 May 2023 00:00:00 +0000</pubDate><guid>/blog/2023/05/25/digital-identity-hack-part-3-introduction-to-ssi-presentation/</guid><description>
&lt;p>The rise of &lt;strong>self-sovereign identity&lt;/strong> (SSI) presents a groundbreaking
opportunity for progress and expansion in the financial sector, with the
capacity to reshape digital financial services, simplify transactions, and
facilitate seamless interactions. To capitalize on this potential, OP Lab and
the EU funded Powered by Blockchain project organized a seminar day and online
hackathon, exploring the innovative power of SSI technologies and institutional
decentralized finance, setting the stage for &lt;strong>a safer, more inclusive, and more
efficient worldwide financial ecosystem.&lt;/strong>&lt;/p>
&lt;p>At the seminar, participants engaged in a panel discussion on blockchain
projects and &lt;strong>a presentation delving into self-sovereign identity&lt;/strong>. The
following section will examine the essential insights and highlights that
emerged from the SSI presentation.&lt;/p>
&lt;h2 id="introduction-to-self-sovereign-identity">Introduction to Self-Sovereign Identity&lt;/h2>
&lt;p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/utNq_IsH_Y4" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;em>Harri Lainio&amp;rsquo;s presentation:
Introduction to Self-Sovereign Identity&lt;/em>&lt;/p>
&lt;p>In the event day presentation on Self-Sovereign Identity, &lt;strong>Harri Lainio from OP
Lab&lt;/strong> introduced SSI, its potential impact on the world, and Findy Agency&amp;rsquo;s
open-source solution for implementing it. The speaker highlighted the power
dynamics of the current digital identity model, which has centralized power in
the hands of a few online platforms. In the next evolution of the internet,
&lt;strong>Web 3 aims to shift power back to individuals&lt;/strong> and things, thus empowering
users to take control of their digital identities.&lt;/p>
&lt;p>Learn more about Findy Agency &lt;a href="https://findy-network.github.io/">here&lt;/a>.&lt;/p>
&lt;h3 id="take-control-of-your-identity">Take Control of Your Identity&lt;/h3>
&lt;p>&lt;strong>SSI offers the promise of an internet where individuals are sovereign,
building their own networks, and serving as the roots of these networks.&lt;/strong> By
examining the incentives for SSI, the speaker noted that humans are cooperative
but inherently distrustful, making the exchange of value challenging.
Institutions like banks and governments have historically reduced uncertainty,
but the speaker questioned whether there are alternative ways to achieve this.
He acknowledged that blockchain technology had solved some issues, such as
double spending, but still has a long way to go.&lt;/p>
&lt;p>The speaker emphasized that SSI is about putting the user at the center of their
digital identity: &lt;em>&lt;strong>&amp;ldquo;I want to be in the center. And that&amp;rsquo;s something that SSI
promises to handle.&amp;rdquo;&lt;/strong>&lt;/em> By empowering individuals to take control of their
digital selves, SSI can reshape the internet and transform how people interact
and exchange value online.&lt;/p>
&lt;h3 id="root-of-trust">Root of Trust&lt;/h3>
&lt;p>As the presentation progressed, the speaker highlighted that new digital
identities could be represented by leveraging real-world entities while
maintaining clarity and trustworthiness. He touched on the idea of using &lt;strong>FIDO2
authenticators as a &amp;ldquo;root of trust&amp;rdquo;&lt;/strong> and the importance of flawless one-on-one
mapping between the digital and real worlds.&lt;/p>
&lt;p>Find more information about the FIDO2 &lt;a href="https://fidoalliance.org/">here&lt;/a>.&lt;/p>
&lt;h3 id="placing-the-user-at-the-heart-of-trust">Placing the User at the Heart of Trust&lt;/h3>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 949px">
&lt;img class="card-img-top" src="/blog/2023/05/25/digital-identity-hack-part-3-introduction-to-ssi-presentation/trust-triangle_hua85a9975a917418fb63cec0ce4cbf277_385020_939x649_fit_catmullrom_3.png" width="939" height="512">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text"> &lt;em>The trust triangle&lt;/em> &lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The speaker introduced the concept of verifiable credentials and decentralized
identifiers based on secure communication protocols, as well as the trust triangle,
which consists of an issuer, holder, and verifier. He explained that the
verifier&amp;rsquo;s trust in the issuer is crucial and that the current technology
should be able to handle it. The presenter mentioned the Findy Agency they have
been working on and encouraged the audience to explore and improve upon their
open-source solutions.&lt;/p>
&lt;p>In a memorable quote from the presentation, Harri said, &lt;em>&lt;strong>&amp;ldquo;And with the help of
cryptography, we can build a better or at least more interesting world, digital
world.&amp;rdquo;&lt;/strong>&lt;/em> By pushing the boundaries of SSI and digital identity, the speaker
envisions a future where individuals have greater control over their digital
selves and the information they share.&lt;/p>
&lt;h2 id="project-and-event-information">Project and Event Information&lt;/h2>
&lt;p>&lt;strong>OP Lab&lt;/strong> arranged the seminar day in Oulu, Finland, and the two-week online
hackathon in collaboration with the Powered by Blockchain project during
February. &lt;strong>Powered by Blockchain&lt;/strong> project is a collaboration project between
University of Vaasa, University of Oulu, University of Lapland and Kajaani
University of Applied Sciences. The project is funded by the European Social
Fund.&lt;/p>
&lt;p>Find more information about the project
&lt;a href="https://www.uwasa.fi/en/tutkimus/hankkeet/tehoa-lohkoketjuista-koulutushanke">here&lt;/a>.&lt;/p></description></item><item><title>Blog: Digital Identity Hack Part 2 – Panel Discussion on Blockchain Projects</title><link>/blog/2023/05/23/digital-identity-hack-part-2-panel-discussion-on-blockchain-projects/</link><pubDate>Tue, 23 May 2023 00:00:00 +0000</pubDate><guid>/blog/2023/05/23/digital-identity-hack-part-2-panel-discussion-on-blockchain-projects/</guid><description>
&lt;p>The emergence of &lt;strong>self-sovereign identity&lt;/strong> (SSI) offers a revolutionary
opportunity for innovation and growth in the financial world, potentially
transforming digital financial services, streamlining transactions, and enabling
seamless interaction. To harness this potential, OP Lab and the EU-funded
Powered by Blockchain project recently held a seminar day and online hackathon
to investigate the disruptive capabilities of SSI technologies and institutional
decentralized finance, paving the way for &lt;strong>a more secure, inclusive, and
efficient global financial ecosystem.&lt;/strong>&lt;/p>
&lt;p>During the seminar, attendees participated in a panel discussion on blockchain
projects and a presentation exploring self-sovereign identity. The following
section will delve into the key insights and highlights from the panel
discussion.&lt;/p>
&lt;h2 id="panel-discussion-on-blockchain-projects">Panel Discussion on Blockchain Projects&lt;/h2>
&lt;p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/nygxmT3dN-g" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;em>Panel discussion on blockchain projects&lt;/em>&lt;/p>
&lt;p>On the event day, a panel of experts, Pekka Kaipio from &lt;a href="https://op-lab.fi/">OP
Lab&lt;/a>, Jani Partanen from &lt;a href="https://joisto.com/">Joisto Oy&lt;/a>,
Sandun Dasanayake from &lt;a href="https://q4us.dev/">Q4US&lt;/a>, and Rainer Koirikivi from
&lt;a href="https://interjektio.fi/">Interjektio&lt;/a>, shared their insights into the world of
blockchain. The panel was moderated by Laura Vuorenoja from OP Lab, and the
discussion centered on the &lt;strong>challenges of blockchain projects&lt;/strong>, the lessons
learned, and the potential of blockchain technology for digital identity.&lt;/p>
&lt;p>Blockchain projects present unique challenges, with the panelists highlighting
issues such as the &lt;strong>complexity of the technology, regulatory hurdles, and the
difficulty of building consortia&lt;/strong>. To overcome these challenges, the experts
emphasized the importance of educating stakeholders about blockchain&amp;rsquo;s potential
beyond cryptocurrencies and selecting the right use cases for blockchain
technology.&lt;/p>
&lt;p>The panelists also touched on their experiences with blockchain projects in
various industries. Topics covered included the &lt;strong>digitization of real estate
trading, the facilitation of parcel information sharing across European
entities, and the secure storage of document integrity and provenance&lt;/strong>. These
examples demonstrated the versatility and growing importance of blockchain
solutions in the modern tech and business landscape.&lt;/p>
&lt;h3 id="exploring-identity-management">Exploring Identity Management&lt;/h3>
&lt;p>One of the focal points of the discussion was digital identity management on
blockchain. The panelists explored the &lt;strong>need for decentralized identity
systems&lt;/strong> to improve the scalability of blockchain networks. However, they noted
that many current projects still rely on centralized identity systems or
traditional public key infrastructure.&lt;/p>
&lt;h3 id="regulatory-challenges-in-the-blockchain-sphere">Regulatory Challenges in the Blockchain Sphere&lt;/h3>
&lt;p>Panelists agreed that the &lt;strong>General Data Protection Regulation (GDPR)&lt;/strong> has been
one of the most significant regulatory challenges they have faced. While the
GDPR aims to protect users&amp;rsquo; privacy, it sometimes limits how blockchain can be
utilized, even necessitating the removal of certain platform functionalities. In
the financial sector, &lt;strong>KYC (Know Your Customer)&lt;/strong> and &lt;strong>AML (Anti Money
Laundering)&lt;/strong> are the most obvious challenges that need to be implemented
properly.&lt;/p>
&lt;h3 id="the-importance-of-open-source">The Importance of Open Source&lt;/h3>
&lt;p>Many blockchain projects are built upon open-source technologies like
Hyperledger Fabric. Panelists highlighted the importance of open-source
contributions in &lt;strong>advancing blockchain technology and fostering a spirit of
collaboration&lt;/strong> within the community. While not all panelists&amp;rsquo; companies have
made code contributions, they have shared knowledge and participated in meetups
and user groups.&lt;/p>
&lt;h3 id="effective-talent-sourcing">Effective Talent Sourcing&lt;/h3>
&lt;p>Sourcing skilled blockchain talent has proven to be complicated. Panelists
revealed that &lt;strong>growing their own talent through training and education has been
the most effective strategy&lt;/strong>. Some have also turned to partnerships with
startups, consultants, or other companies to fill talent gaps.&lt;/p>
&lt;h3 id="future-prospects-of-blockchain-technology">Future Prospects of Blockchain Technology&lt;/h3>
&lt;p>The panelists agreed that &lt;strong>blockchain technology shows promise for the
future&lt;/strong>, as it matures and becomes more widely adopted. Blockchain&amp;rsquo;s potential
as an infrastructure solution for industries like finance and the emerging
metaverse was also noted. However, the panelists acknowledged that regulatory
challenges and the rise of artificial intelligence (AI) could impact the
technology&amp;rsquo;s trajectory.&lt;/p>
&lt;h3 id="one-wish-for-blockchain">One Wish for Blockchain&lt;/h3>
&lt;p>When asked about their one wish for blockchain, panelists expressed a desire for
&lt;strong>more streamlined regulations, increased adoption, and a broader talent pool&lt;/strong>.
They hope these changes will lead to a more decentralized, fair, and
trusted way for people to exchange value and information.&lt;/p>
&lt;p>In conclusion, the panelists emphasized that despite its challenges,
&lt;strong>blockchain has the potential to revolutionize various industries&lt;/strong>, including
finance, real estate, logistics, and digital identity management. By sharing
their experiences and lessons learned, the panelists provided valuable insights
to help others navigate the complex world of blockchain technology.&lt;/p>
&lt;h2 id="project-and-event-information">Project and Event Information&lt;/h2>
&lt;p>&lt;strong>OP Lab&lt;/strong> arranged the seminar day in Oulu, Finland, and the two-week online
hackathon in collaboration with the Powered by Blockchain project during
February. &lt;strong>Powered by Blockchain&lt;/strong> project is a collaboration project between
University of Vaasa, University of Oulu, University of Lapland and Kajaani
University of Applied Sciences. The project is funded by the European Social
Fund.&lt;/p>
&lt;p>Find more information about the project
&lt;a href="https://www.uwasa.fi/en/tutkimus/hankkeet/tehoa-lohkoketjuista-koulutushanke">here&lt;/a>.&lt;/p></description></item><item><title>Blog: Digital Identity Hack – Unlocking the Potential of SSI</title><link>/blog/2023/05/11/digital-identity-hack-unlocking-the-potential-of-ssi/</link><pubDate>Thu, 11 May 2023 00:00:00 +0000</pubDate><guid>/blog/2023/05/11/digital-identity-hack-unlocking-the-potential-of-ssi/</guid><description>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 949px">
&lt;img class="card-img-top" src="/blog/2023/05/11/digital-identity-hack-unlocking-the-potential-of-ssi/cover-identity-hack_hua878d50f8972cd57ad3a871ec33f0efc_718985_939x649_fit_catmullrom_3.png" width="939" height="389">
&lt;/figure>
&lt;p>The emergence of &lt;strong>self-sovereign identity&lt;/strong> (SSI) technologies has the potential to revolutionize the digital landscape of the financial world, presenting unparalleled opportunities for innovation and growth. As SSI gains momentum, it can transform how we interact with digital financial services, streamline transactions, and enable seamless interactions between users and services. By embracing these cutting-edge technologies, we have the unique chance to actively shape the future of the global financial ecosystem, fostering a &lt;strong>more secure, inclusive, and efficient digital environment&lt;/strong> for individuals and businesses alike.&lt;/p>
&lt;p>To seize these opportunities, OP Lab and the EU-funded Powered by Blockchain project organized a &lt;strong>seminar day and an online hackathon&lt;/strong> in collaboration. The aim was to explore the disruptive potential of SSI technologies and institutional decentralized finance.&lt;/p>
&lt;h2 id="kicking-off-the-hackathon-challenge">Kicking Off the Hackathon Challenge&lt;/h2>
&lt;p>The event&amp;rsquo;s main theme was &lt;em>&lt;strong>Digital Identity as an Enabler for Open Decentralized Finance&lt;/strong>&lt;/em>. The emergence of SSI technologies has opened new opportunities by enabling verifiable credentials for identity and data verification. The hackathon and seminar day aimed to educate participants on leveraging these technologies to transform the world of finance. The live event, bringing together tech professionals, students, and companies, was recently held in Oulu, Finland, and streamed online for a broader audience to participate.&lt;/p>
&lt;p>Read the full Digital Identity Hack description &lt;a href="https://new.ultrahack.org/hackathons/digital-identity-hack">here&lt;/a>.&lt;/p>
&lt;h2 id="challenge-objectives-and-key-topics">Challenge Objectives and Key Topics&lt;/h2>
&lt;p>The objective of the hackathon challenge was to &lt;strong>develop financial products and services that are transparent, open, and accessible to anyone on the internet&lt;/strong>. The organizers believed that SSI technologies could offer significant tools for achieving this goal.&lt;/p>
&lt;p>Key topics covered during the challenge presentation included combining verifiable credentials with blockchain technology, checking identity and other data attributes in transactions, controlling transactions automatically through smart contracts based on verifiable data, and creating confidential private transactions while verifying identity data.&lt;/p>
&lt;p>Participants were also presented with example approaches to the challenge, such as how to verify financial compliance like Know Your Customer (KYC) and Anti-Money Laundering (AML), how to check company employee credentials to proceed with company transactions, and how to verify investor accreditation.&lt;/p>
&lt;h2 id="inspirational-case-studies">Inspirational Case Studies&lt;/h2>
&lt;p>During the event, several intriguing proof-of-concept case examples were highlighted, providing valuable insights into the promising potential of this innovative and uncharted domain.&lt;/p>
&lt;h3 id="project-guardian">Project Guardian&lt;/h3>
&lt;p>Onyx by J.P. Morgan explored the use of verifiable credentials and blockchain technology in &lt;strong>foreign exchange transactions&lt;/strong> through Project Guardian. This concept demonstrated that by utilizing tokenized forms of cash and proper authorization, it&amp;rsquo;s possible to create decentralized financial services with the necessary safeguards in place.&lt;/p>
&lt;p>Find more information about the project &lt;a href="https://www.jpmorgan.com/onyx/content-hub/institutional-defi.htm">here&lt;/a>.&lt;/p>
&lt;h3 id="project-jupiter">Project Jupiter&lt;/h3>
&lt;p>An intriguing case from Finland, Project Jupiter, explored &lt;strong>trading non-listed company shares&lt;/strong> with SSI and blockchain technology. The network simplifies the stock ledger, issuance, and trading processes while ensuring seamless information flow between stakeholders. This innovation reduces administrative burdens and enables new financial products and aftermarket services.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 949px">
&lt;img class="card-img-top" src="/blog/2023/05/11/digital-identity-hack-unlocking-the-potential-of-ssi/project-jupiter_hu22859d0fc586727e81dd2fbb86a86392_793356_939x649_fit_catmullrom_3.png" width="939" height="520">
&lt;/figure>
&lt;p>Find more information about the project &lt;a href="https://www.epressi.com/tiedotteet/talous/asiakastieto-nordea-op-privanet-and-tieto-to-digitalize-trading-of-non-listed-company-shares.html">here&lt;/a>.&lt;/p>
&lt;h2 id="submission-evaluation-and-objectives">Submission Evaluation and Objectives&lt;/h2>
&lt;p>The hackathon submissions were expected to be &lt;strong>technical solutions&lt;/strong> rather than just concepts, with must-haves including a five-minute video presentation with a technical demo and shared code. Evaluation criteria were based on &lt;strong>technical implementation, innovativeness, scalability, and commercial potential&lt;/strong>.&lt;/p>
&lt;p>The awards ceremony took place two weeks after the kick-off in a separate online event, where participants had the opportunity to pitch their solutions and winners of the challenge were announced. The hackathon was challenging, as it required participants to implement new technologies and produce innovative solutions for specific business challenges.&lt;/p>
&lt;p>A major focus of the hackathon was the implementation of SSI with the Findy Agency to create a new generation of online solutions. Findy Agency empowers individuals with control over their digital identities, allowing them to share their information securely and selectively.&lt;/p>
&lt;p>Learn more about Findy Agency &lt;a href="https://findy-network.github.io/">here&lt;/a>.&lt;/p>
&lt;h2 id="team-submissions">Team Submissions&lt;/h2>
&lt;p>The team submissions demonstrated a great variety of interesting future solutions. One team of innovators tackled the financial sector&amp;rsquo;s pressing issue of &lt;strong>global online identity verification for salary payments&lt;/strong>. By developing a global digital employee verification solution, they streamlined the process and reinforced compliance, thus easing the challenges faced by institutions in confirming identities across borders.&lt;/p>
&lt;p>Another topic addressed in the team submissions was the urgent need for &lt;strong>innovative solutions to combat climate change&lt;/strong>. One standout concept involved a circular economy for environmental certificates, making it possible to invest in or directly sell forest resources. This model promotes sustainable forest management and encourages participation in green initiatives.&lt;/p>
&lt;p>One of the submissions also displayed a &lt;strong>practical solution for job applications using digital credentials&lt;/strong>, streamlining the process by providing verified information on work experience and education. This approach holds promise for simplifying the hiring process and increasing trust between job seekers and employers.&lt;/p>
&lt;p>All in all, the hackathon demonstrated the incredible potential of self-sovereign identity and verifiable credentials in addressing critical issues faced by society today. As these tools continue to be refined and implemented, we can expect to see a more trusted and efficient digital landscape in the years to come.&lt;/p>
&lt;h2 id="pioneering-the-future-of-technology">Pioneering the Future of Technology&lt;/h2>
&lt;p>Self-sovereign identity and verifiable credentials are powerful tools that can create the much-needed trust in the online space. These tools allow individuals to &lt;strong>own and manage their personal data&lt;/strong> and control how it is shared, making it more secure and reliable. With the rise of digital transformation, these tools are becoming increasingly important in ensuring the security and privacy of individuals and businesses online.&lt;/p>
&lt;p>As the future of decentralized finance continues to unfold, this event offered a glimpse into the innovative ideas and technologies that may shape the industry in the coming years.&lt;/p>
&lt;h2 id="project-and-event-information">Project and event information&lt;/h2>
&lt;p>&lt;strong>OP Lab&lt;/strong> arranged the seminar day in Oulu, Finland, and the two-week online hackathon during February in collaboration with Powered by Blockchain project. &lt;strong>Powered by Blockchain&lt;/strong> project is a collaboration project between University of Vaasa, University of Oulu, University of Lapland and Kajaani University of Applied Sciences. The project is funded by the European Social Fund.&lt;/p>
&lt;p>Find more information about the project &lt;a href="https://www.uwasa.fi/en/tutkimus/hankkeet/tehoa-lohkoketjuista-koulutushanke">here&lt;/a>.&lt;/p></description></item><item><title>Blog: Deploying with CDK Pipeline</title><link>/blog/2023/05/08/deploying-with-cdk-pipeline/</link><pubDate>Mon, 08 May 2023 00:00:00 +0000</pubDate><guid>/blog/2023/05/08/deploying-with-cdk-pipeline/</guid><description>
&lt;p>&lt;a href="/blog/2023/04/25/agencys-iac-journey/">My previous post&lt;/a> described how we have been using
the native AWS IaC tools for defining and updating
our PoC environment infrastructure. The story ended with taking AWS CDK v2 in use and switching the
deployment process on top of CDK pipelines. In this article, I will describe the anatomy of our CDK
pipeline in more detail.&lt;/p>
&lt;p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/Dj_Z5ReqCwc" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;em>Watch my &amp;ldquo;CDK-based Continuous Deployment for OSS&amp;rdquo; talk on AWS Community Day on YouTube.&lt;/em>&lt;/p>
&lt;h2 id="self-mutating-pipelines">Self-Mutating Pipelines&lt;/h2>
&lt;p>&lt;a href="https://docs.aws.amazon.com/cdk/v2/guide/cdk_pipeline.html">CDK Pipeline&lt;/a> offers
a streamlined process for building, testing, and deploying a new version of
CDK applications. It tries to simplify the developer&amp;rsquo;s life by hiding the dirty details of
multiple services needed to build working pipelines in AWS. As usual with CDK tools, it provides
no new AWS services but is a convenient abstraction layer on top of the existing AWS continuous
integration and deployment products.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2023/05/08/deploying-with-cdk-pipeline/cover-stages_hue9fd40faf9482e977e2df5aaad971cca_144291_925x925_fit_catmullrom_3.png" width="925" height="386">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The main idea of the pipeline is that instead of the developer deploying the application from
her local computer, a process implemented through
&lt;a href="https://aws.amazon.com/codepipeline/">AWS CodePipelines&lt;/a> (CDK pipeline) handles the deployment.
Thus, in the agency case, instead of me running the script locally to create all needed
AWS resources for our AWS deployment, I create locally only the CDK pipeline, which, in turn,
handles the resource creation for me.&lt;/p>
&lt;p>The CDK pipeline also handles any subsequent changes to the deployment
(or even in the pipeline process itself). Therefore, developers modify the CDK deployment
only through &lt;em>version control&lt;/em> after the pipeline creation. This feature makes it &lt;em>self-mutating&lt;/em>,
i.e., self-updating, as the pipeline can automatically reconfigure itself.&lt;/p>
&lt;p>This model reduces the need for running the tools from the developer&amp;rsquo;s local machine and enforces
a behavior where all the deployment state information is available in the cloud.
Using CDK pipelines also reduces the need to write custom scripts when setting up the pipeline.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>CDK v1&lt;/th>
&lt;th>CDK v2 Pipelines&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Pipeline creation&lt;/td>
&lt;td>Developer deploys from local&lt;/td>
&lt;td>Developer deploys from local&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Changes to pipeline configuration&lt;/td>
&lt;td>Developer deploys from local&lt;/td>
&lt;td>Developer commits to version control. CDK Pipeline deploys automatically.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Agency creation&lt;/td>
&lt;td>Developer deploys from local&lt;/td>
&lt;td>Developer commits to version control. CDK Pipeline deploys automatically.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Changes to Agency resources&lt;/td>
&lt;td>Developer deploys from local&lt;/td>
&lt;td>Developer commits to version control. CDK Pipeline deploys automatically.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Need for custom scripts&lt;/td>
&lt;td>Storing of Agency deployment secrets and parameters. Pipeline creation with Agency deployment resource references.&lt;/td>
&lt;td>Storing all needed secrets and parameters in pipeline creation phase.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;em>The use of CDK Pipelines converted the Agency deployment model to a direction where the pipeline
does most of the work in the cloud, and the developer only commits the changes to the version control.&lt;/em>&lt;/p>
&lt;h2 id="agency-deployment">Agency Deployment&lt;/h2>
&lt;p>Regarding the agency deployment, we have &lt;a href="https://github.com/findy-network/findy-agent-infra/tree/master/aws-ecs#readme">a single CDK application&lt;/a>
that sets up the whole agency platform to AWS.
A more production-like approach would be to have a dedicated
deployment pipeline for each microservice. However, having the resources in the same application
is handy for the time being as we occasionally need to set the agency fully up and tear it down rapidly.&lt;/p>
&lt;p>If one wishes to deploy the agency to AWS using the CDK application, there are some
&lt;a href="https://github.com/findy-network/findy-agent-infra/tree/master/aws-ecs#prerequisities">prerequisities&lt;/a>:&lt;/p>
&lt;ul>
&lt;li>The needed tools for Typescript CDK applications&lt;/li>
&lt;li>AWS Codestar connection to GitHub via AWS Console&lt;/li>
&lt;li>A hosted zone for Route53 for the desired domain&lt;/li>
&lt;li>Agency configuration as environment variables.&lt;/li>
&lt;/ul>
&lt;p>The setup process itself consists of two phases. Firstly, one must store the required configuration
to parameter store and secrets manager. Secondly, one should deploy the pipeline using CDK tooling.
I have written bash scripts and &lt;a href="https://github.com/findy-network/findy-agent-infra/tree/master/aws-ecs#steps">detailed instructions&lt;/a>
to simplify the job.&lt;/p>
&lt;h2 id="pipeline-stages">Pipeline Stages&lt;/h2>
&lt;p>Each CDK pipeline consists of 5 different stages. It is essential to have a basic understanding
of these stages when figuring out what is happening in the pipeline. CDK pipeline creates
these stages automatically when one deploys the pipeline constructs for the first time.
The developer can modify and add logic to some stages, but mainly the system has
a hard-coded way of defining the pipeline stages. This functionality is also why AWS calls
the CDK pipelines &lt;a href="https://docs.aws.amazon.com/cdk/api/v1/docs/pipelines-readme.html#cdk-pipelines">&amp;ldquo;opinionated.&amp;rdquo;&lt;/a>
Therefore some projects will find the CDK pipeline philosophy for
building and deploying assets unsuitable.&lt;/p>
&lt;h3 id="15-source">1/5 Source&lt;/h3>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 852px">
&lt;img class="card-img-top" src="/blog/2023/05/08/deploying-with-cdk-pipeline/source_hu95baa4c50505e5a1f56db84f360d081a_76333_925x925_fit_catmullrom_3.png" width="842" height="347">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The source stage fetches the code from the source code repositories. In the agency case,
we have five different source repositories in GitHub. Whenever we push something
to the master branch of these repositories, i.e., make a release, our pipeline will run as we have
configured the master branch as the pipeline trigger.&lt;/p>
&lt;p>We don&amp;rsquo;t need the code
for the backend services for anything but triggering the pipeline. We use only the
&lt;a href="https://github.com/findy-network/findy-wallet-pwa">front-end&lt;/a>
and &lt;a href="https://github.com/findy-network/findy-agent-infra">infra&lt;/a>
repositories code to build the static front-end application and update
the CDK application, i.e., the application containing the CDK code for the agency infrastructure
and pipeline. &lt;a href="https://github.com/features/actions">GitHub actions&lt;/a> handle building
the backend Docker containers for us and
the images are stored publicly in &lt;a href="https://github.com/features/packages">GitHub Packages&lt;/a>.&lt;/p>
&lt;h3 id="25-build">2/5 Build&lt;/h3>
&lt;p>The build stage has two roles: it converts the CDK code to CloudFormation templates and builds
any assets that end up in S3 buckets.&lt;/p>
&lt;p>The developer can define this workflow, but the steps must produce
&lt;a href="https://docs.aws.amazon.com/cdk/api/v1/docs/pipelines-readme.html#synth-and-sources">the CDK synthesizing output&lt;/a>
in a dedicated folder. The phase when CDK tooling converts the CDK code to
the CloudFormation templates is called synthesizing.&lt;/p>
&lt;p>With the agency, we have some custom magic in place here as
we are fetching the CDK context from the parameter store for the synthesizing.
The recommendation is to store the context information in the CDK application repository,
but we don&amp;rsquo;t want to do it as it is open-source.&lt;/p>
&lt;p>Pipeline creation in
&lt;a href="https://github.com/findy-network/findy-agent-infra/blob/master/aws-ecs/lib/pipeline-stack.ts#L139">the CDK application code&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ts" data-lang="ts">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">pipeline&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">new&lt;/span> &lt;span style="color:#000">CodePipeline&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">this&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;Pipeline&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">pipelineName&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;FindyAgencyPipeline&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">dockerEnabledForSynth&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">true&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// Override synth step with custom commands
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">synth&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">new&lt;/span> &lt;span style="color:#000">CodeBuildStep&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;SynthStep&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">input&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">infraInput&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">additionalInputs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;../findy-agent&amp;#34;&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">CodePipelineSource&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">connection&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;findy-network/findy-agent&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;master&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">connectionArn&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">ghArn&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// Created using the AWS console
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">installCommands&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;npm install -g aws-cdk&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// Custom steps
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">commands&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;cd aws-ecs&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// Prepare frontend build env
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;cp ./tools/create-set-env.sh ../../findy-wallet-pwa/create-set-env.sh&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// Do cdk synth with context stored in params
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#4e9a06">`echo &amp;#34;$CDK_CONTEXT_JSON&amp;#34; &amp;gt; cdk.context.json`&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;cat cdk.context.json&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;npm ci&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;npm run build&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;npx cdk synth&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;npm run pipeline:context&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// The output of the synthing process
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">primaryOutputDirectory&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;aws-ecs/cdk.out&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">});&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The building of assets happens automatically as part of the synthesizing.
The pipeline orchestrates it based on the instructions that one defines for the deployment assets.&lt;/p>
&lt;h3 id="35-updatepipeline">3/5 UpdatePipeline&lt;/h3>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 855px">
&lt;img class="card-img-top" src="/blog/2023/05/08/deploying-with-cdk-pipeline/update_hub90a33393a48a69bfad632b741084aca_65879_925x925_fit_catmullrom_3.png" width="845" height="365">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>UpdatePipeline makes any changes to the pipeline, i.e., modifies it with new stages and assets
if necessary. The developer cannot alter this stage. One thing to notice is that
the pipeline process is always initially run with the currently saved version.
If a change in the version control introduces changes to the pipeline,
the pipeline execution is canceled in this stage and restarted with the new version.&lt;/p>
&lt;h3 id="45-assets">4/5 Assets&lt;/h3>
&lt;p>In &lt;a href="https://docs.aws.amazon.com/cdk/v2/guide/assets.html">the assets&lt;/a>
stage, the pipeline analyzes the application stack and publishes all files to
S3 and Docker images to ECR that the application needs for deployment. CDK Pipelines stores
these assets using its buckets and ECR registries. By default, they have no lifecycle policies,
so the CDK developer should ensure that the assets will not increase their AWS bill unexpectedly.&lt;/p>
&lt;p>&lt;a href="https://github.com/findy-network/findy-agent-infra/blob/master/aws-ecs/lib/frontend.ts#L47">Assets building&lt;/a>
utilizes &lt;code>aws-s3-deployment&lt;/code> module for the frontend application:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ts" data-lang="ts">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// Source bundle
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">srcBundle&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">s3deploy&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Source&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">asset&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;../../findy-wallet-pwa&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">bundling&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">command&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#39;sh&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;-c&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#39;npm ci &amp;amp;&amp;amp; npm run build &amp;amp;&amp;amp; &amp;#39;&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#39;apk add bash &amp;amp;&amp;amp; &amp;#39;&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">`./create-set-env.sh &amp;#34;./tools/env-docker/set-env.sh&amp;#34; &amp;#34;&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">bucketName&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">&amp;#34; &amp;#34;&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">process&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">env&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">API_SUB_DOMAIN_NAME&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">.&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">process&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">env&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">DOMAIN_NAME&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">&amp;#34; &amp;#34;&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">GRPCPortNumber&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">&amp;#34; &amp;amp;&amp;amp; `&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">+&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#39;cp -R ./build/. /asset-output/&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">image&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">DockerImage.fromRegistry&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;public.ecr.aws/docker/library/node:18.12-alpine3.17&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">environment&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">REACT_APP_GQL_HOST&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">bucketName&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">REACT_APP_AUTH_HOST&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">bucketName&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">REACT_APP_HTTP_SCHEME&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;https&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">REACT_APP_WS_SCHEME&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;wss&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">});&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">new&lt;/span> &lt;span style="color:#000">s3deploy&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BucketDeployment&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">this&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">`&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">-deployment`&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">sources&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">srcBundle&lt;/span>&lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">destinationBucket&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">bucket&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">logRetention&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">RetentionDays.ONE_MONTH&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">});&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="55-deploy">5/5 Deploy&lt;/h3>
&lt;p>Finally, the Deploy stage creates and updates the application infrastructure resources.
There is also a chance to add post steps to this stage, which can run the post-deployment
testing and other needed scripts.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2023/05/08/deploying-with-cdk-pipeline/deploy_hu9a28268de189767b8103db6c169ccba0_99362_925x925_fit_catmullrom_3.png" width="925" height="524">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>For the agency, we are using the post-deployment steps for three purposes:&lt;/p>
&lt;ol>
&lt;li>We have a custom script for updating the ECS service. This script is in place
to tweak some service parameters missing from CDK constructs.&lt;/li>
&lt;li>We do the configuration of the agency administrator account.&lt;/li>
&lt;li>We are running an e2e test round to ensure the deployment was successful.&lt;/li>
&lt;/ol>
&lt;h2 id="conclusions">Conclusions&lt;/h2>
&lt;p>The CDK pipeline is initially a bit complex to get your head around. For simple applications,
the use is easy, and there isn&amp;rsquo;t even a need to deeply understand how it works.
However, when the deployment has multiple moving parts, it is beneficial to understand
the different stages.&lt;/p>
&lt;p>There are still some details that I would like to see improvement in.
The documentation and examples need additions, especially on how to use the assets correctly.
There have been improvements already, but complete example applications would make
the learning curve for the CDK pipelines more gentle. They state that CDK pipelines are
&amp;ldquo;opinionated,&amp;rdquo; but users should know better what that opinion is.&lt;/p>
&lt;p>However, the CDK pipeline model pleases me in many ways. I especially value
the approach that has reduced the steps needed to run in the developer&amp;rsquo;s
local environment compared to how we used the previous versions of AWS IaC tools.
Furthermore, the strategy enables multiple developers working with the same pipeline
as the state needs to be available in the cloud. Finally, I am happy with the current state of our
deployment pipeline, and it works well for our purposes.&lt;/p>
&lt;p>If interested, you can find all our CDK application codes in &lt;a href="https://github.com/findy-network/findy-agent-infra/tree/master/aws-ecs">GitHub&lt;/a>
and even try to deploy the agency yourself!&lt;/p></description></item><item><title>Blog: Agency's IaC Journey</title><link>/blog/2023/04/25/agencys-iac-journey/</link><pubDate>Tue, 25 Apr 2023 00:00:00 +0000</pubDate><guid>/blog/2023/04/25/agencys-iac-journey/</guid><description>
&lt;p>In the early days of Findy Agency&amp;rsquo;s development project, it became evident that we needed
a continuously running environment in the cloud to try out different proofs-of-concept (PoCs)
and demos quickly and easily. As our team is small, we wanted to rely heavily on automation
and avoid wasting time on manual deployments.&lt;/p>
&lt;h2 id="setup-infra-without-a-hassle">Setup Infra without a Hassle&lt;/h2>
&lt;p>At that time, I was interested in improving my AWS skills, so I took the challenge and
started working on a continuous PoC environment for our project. As an innovation unit,
we experiment constantly and want to try different things quickly,
so the PoC environment also needed to accommodate this agility.&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="https://github.com/findy-network/findy-agent-infra/raw/master/aws-ecs/docs/arch.png" width="925"/>
&lt;/figure>
&lt;em>Overview of the AWS deployment for the demo environment&lt;/em>&lt;/p>
&lt;p>From the start, it was clear that I wanted to use IaC (infrastructure as code) tools to define
our infra. My target was to create scripts that anyone could easily take and
set up the agency without a hassle.&lt;/p>
&lt;p>I had been using &lt;a href="https://www.terraform.io/">Terraform&lt;/a> in some of my earlier projects, but using
a third-party tool typically requires compromises, so I wanted to take the native option for
a change with the IaC-tooling as well. The initial target was not to find the ultimate DevOps tools
but more in the experimentation spirit to find tooling and methods suitable for our flexible needs.&lt;/p>
&lt;h2 id="from-manual-yaml-to-cdk">From Manual YAML to CDK&lt;/h2>
&lt;p>Back then, the only AWS-native choice for IaC-tooling was to manually start writing
the CloudFormation templates. &lt;a href="https://aws.amazon.com/cloudformation/">CloudFormation&lt;/a> is
an AWS service that one can use to provision the infrastructure with
JSON- or YAML-formatted templates. CloudFormation stack is an entity that holds
the infrastructure resources. All the resources defined in the stack template are created and
removed together with the stack. One can manage the infrastructure stacks through the AWS CLI or
the CloudFormation UI.&lt;/p>
&lt;p>So the first iteration of the agency&amp;rsquo;s AWS infra code was about writing a lot of YAML definitions,
deploying them from the local laptop using the AWS CLI, fixing errors, and retrying.
The process could have been more efficient and successful in many ways. For example,
there was just not enough time to figure out everything needed and, in many cases,
the desired level of automation required to write countless custom scripts.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 535px">
&lt;img class="card-img-top" src="/blog/2023/04/25/agencys-iac-journey/yaml-example_hu60a7a54e5b215f57e1c6ace31bf7ab89_175789_525x525_fit_catmullrom_3.png" width="525" height="447">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Example of a YAML template&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>After some time of struggling with the YAML, AWS released the &lt;a href="https://aws.amazon.com/cdk/">CDK&lt;/a>
(Cloud Development Kit). The purpose of the CDK is to allow developers to write
the CloudFormation templates using familiar programming languages. CDK tooling converts
the code written by the developer to CloudFormation templates.&lt;/p>
&lt;p>Writing declarative definitions using imperative programming languages felt a bit off for me at first,
but I decided to try it. There were some evident benefits:&lt;/p>
&lt;ul>
&lt;li>CDK offers constructs that combine CloudFormation resources with higher-level abstractions.
There is less need to know the dirty details of each resource.&lt;/li>
&lt;li>Sharing, customizing, and reusing constructs is more straightforward.&lt;/li>
&lt;li>One can use her favorite IDE to write the infra code. Therefore tools like code completion are available.&lt;/li>
&lt;li>Also, there are other language-specific tools. One can apply dependency management, versioning,
and even unit testing to the infra code similarly to other software projects.&lt;/li>
&lt;/ul>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 685px">
&lt;img class="card-img-top" src="/blog/2023/04/25/agencys-iac-journey/cdk-example_hu44f0290caad9bdcd00128acf3a502abc_227494_675x575_fit_catmullrom_3.png" width="675" height="333">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Example of CDK code&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="the-missing-puzzle-piece">The Missing Puzzle Piece&lt;/h2>
&lt;p>Switching to CDK tooling boosted my performance for the infra work significantly.
Also, the manual hassle with the YAML templates is something I have not longed for at all.
Still, it felt like something was missing. I was still running the infra setup scripts
from my laptop. In my ideal world, the pipeline would create the infra, keeping things
more reproducible and less error-prone. Also, defining the build pipeline and the deployment
needed custom steps that made the initial agency setup still complex, which was something that
I wanted to avoid in the first place.&lt;/p>
&lt;p>Well, time went on, and we were happy with the deployment pipeline: regardless of
the setup process, it worked as expected. However, in the spring of 2022, I saw
an &lt;a href="https://op-careers.fi/content/What-is-studying-at-the-Software-Academy-all-about/?locale=en_GB">OP Software Academy&lt;/a>
course about the CDK. The Academy is our internal training organization
that offers courses around several topics. I decided to join the class and learn more about CDK
and get some validation if I had done things correctly.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 635px">
&lt;img class="card-img-top" src="/blog/2023/04/25/agencys-iac-journey/pipeline-example_hue440677f79cc822bad704687c5eb5835_157342_625x625_fit_catmullrom_3.png" width="625" height="342">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Pipeline creation with CDK code&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>In the course, I found the missing piece of my puzzle. As it happened, AWS had just released &lt;a href="https://docs.aws.amazon.com/cdk/v2/guide/migrating-v2.html">CDK v2&lt;/a>,
which introduced a new concept, &lt;a href="https://docs.aws.amazon.com/cdk/v2/guide/cdk_pipeline.html">CDK pipelines&lt;/a>.
CDK pipeline is yet another higher-level abstraction, this time for &lt;em>AWS continuous integration
and deployment tools&lt;/em>. It utilizes AWS CodePipeline to build, test and deploy the application.
The CDK pipeline&amp;rsquo;s beauty lies in its setup: it is deployed only once from the developer&amp;rsquo;s desktop.
After the creation, the pipeline handles the infra-deployment and subsequent changes to
the deployment or the pipeline via version control.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2023/04/25/agencys-iac-journey/cover-iac-journey_hu8ea8cb855c58375c168ced9efb5edf51_74721_925x925_fit_catmullrom_3.png" width="925" height="178">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Evolution of Agency IaC tooling&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>After porting our deployment on top of the CDK pipeline, the setup has finally reached my standards.
However, the future will show us how the Agency deployment will evolve. Perhaps we will introduce
a more platform-agnostic approach and remove AWS native tooling altogether.&lt;/p>
&lt;p>You can do a deep dive into the anatomy of our CDK pipeline in my next blog post.
And as always, you can find the codes on &lt;a href="https://github.com/findy-network/findy-agent-infra/tree/master/aws-ecs#readme">GitHub&lt;/a>!&lt;/p></description></item><item><title>Blog: No-Code SSI Chatbots - FSM Part I</title><link>/blog/2023/03/13/no-code-ssi-chatbots-fsm-part-i/</link><pubDate>Mon, 13 Mar 2023 00:00:00 +0000</pubDate><guid>/blog/2023/03/13/no-code-ssi-chatbots-fsm-part-i/</guid><description>
&lt;p>In this blog post, I&amp;rsquo;ll explain the syntax of our chatbot language. The good
news is that the language is simple, and we already offer some development tools
like UML rendering. There&amp;rsquo;ll be a second post where we&amp;rsquo;ll dive deeply into the
implementation details. Our ultimate goal is to find a proper model checker and
theorem proofer for the correctness of the chatbot applications.&lt;/p>
&lt;p>Our team got the idea of chatbots quite early after we started to play with
verifiable credentials and SSI.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 910px">
&lt;img class="card-img-top" src="/blog/2023/03/13/no-code-ssi-chatbots-fsm-part-i/demo-bot_hu4f38f3f43794e7101495702b2681d19a_613249_900x0_resize_catmullrom_3.png" width="900" height="428">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Zero UI + No-Code => Fast Delivery&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>I think that chatbots and zero UI are some sorts of a lost opportunity for
SSI/DID. The backbone of the DID network is its peer-to-peer communication
protocol. Even though the client/server API model is very convenient to use and
understand, &lt;a href="https://identity.foundation/didcomm-messaging/spec/">DIDComm&lt;/a> based
apps need something different &amp;ndash; more conversational. What would be more
conversational than chatting?&lt;/p>
&lt;p>Anyhow, we have been positively surprised by how far you can get without NLP but
just a strict state machine-guided conversation where each party can
proof facts about themselves when needed. And, of course, you can build perfect
hybrid, where you fix structural parts of the discussion with the FSM and leave
unstructured details for the NLP engine.&lt;/p>
&lt;h2 id="hello-world">Hello World&lt;/h2>
&lt;p>The chatbot state machines are written in YAML (JSON accepted). Currently, a
YAML file includes one state machine at a time.&lt;/p>
&lt;p>As all programming books and manuals start with the hello world app, we do the
same.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">initial&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># (1)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">target&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">INITIAL&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">states&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># (2)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">INITIAL&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># (3)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">transitions&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># (4)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">trigger&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># (5)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">protocol&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">basic_message &lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># (6)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">sends&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># (7)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">data&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Hello! I&amp;#39;m Hello-World bot.&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">protocol&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">basic_message &lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># (8)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">target&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">INITIAL &lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># (9)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The previous machine is as simple as it can be in that it does something.
Let&amp;rsquo;s see what the lines are for:&lt;/p>
&lt;ol>
&lt;li>&lt;strong>Initial state transition&lt;/strong> is mandatory. It&amp;rsquo;s executed when the machine is
started. It&amp;rsquo;s the same as all the state transitions in our syntax but doesn&amp;rsquo;t
have a transition trigger.&lt;/li>
&lt;li>&lt;strong>States&lt;/strong> are listed next. There are no limits to how many states the machine
holds.&lt;/li>
&lt;li>This machine has only one &lt;strong>state&lt;/strong> named &lt;code>INITIAL&lt;/code>. Each state must
have a unique name.&lt;/li>
&lt;li>States include &lt;strong>transitions&lt;/strong> to the next states (&lt;code>target&lt;/code>). We have one in
this machine, but no limit exists to how many transitions a state can have.&lt;/li>
&lt;li>Each transition has &lt;strong>a trigger event&lt;/strong>.&lt;/li>
&lt;li>Triggers have &lt;a href="#protocol">&lt;strong>protocol&lt;/strong>&lt;/a> that is in this case &lt;code>basic_message&lt;/code>.&lt;/li>
&lt;li>We can &lt;strong>send&lt;/strong> limitless a mount of &lt;code>events&lt;/code> during the state transition.&lt;/li>
&lt;li>In this machine, we send a &lt;code>basic_message&lt;/code> where the &lt;code>data&lt;/code> is &lt;code>Hello! I'm Hello-World bot.&lt;/code>&lt;/li>
&lt;li>Our &lt;code>transition&lt;/code> &lt;code>target&lt;/code> is the &lt;code>INITIAL&lt;/code> state. It could be whatever state
exists in the machine.&lt;/li>
&lt;/ol>
&lt;p>Did you get what the machine does? You can try it by following the instructions
in &lt;a href="https://github.com/findy-agent-cli/README.md">Findy CLI&amp;rsquo;s readme&lt;/a> to setup
your playground/run environment. After you have set up a pairwise connection
between two agents, and needed environment variables set like &lt;code>FCLI_CONNN_ID&lt;/code>,
execute this to the first agent&amp;rsquo;s terminal:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-style:italic">findy-agent-cli bot start &amp;lt;Hello-World.yaml&amp;gt; # or whatever name you saved the script above
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>For the second agent, use two terminals and give these commands to them:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902">#&lt;/span> terminal &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-style:italic">findy-agent-cli bot read # listens and shows other end&amp;#39;s messages
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902">#&lt;/span> terminal &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-style:italic">findy-agent-cli bot chat # sends basic_message&amp;#39;s to another end thru the pairwise
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>And when you want to render your state machine in UML, give this command:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-console" data-lang="console">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-style:italic">findy-agent-cli bot uml &amp;lt;Hello-World.yaml&amp;gt; # name of your FSM
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The result looks like this:&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="/blog/2023/03/13/no-code-ssi-chatbots-fsm-part-i/hello1.svg"/>
&lt;/figure>
&lt;em>Hello World Chat Bot FSM&lt;/em>&lt;/p>
&lt;p>The UML rendering may help with understanding. It&amp;rsquo;s also an excellent tool for
manual verification. Automatic model checking is something we are studying in
the future.&lt;/p>
&lt;h2 id="the-fsm-language">The FSM Language&lt;/h2>
&lt;p>The YAML-based state machine definition language is currently as simple as
possible.&lt;/p>
&lt;h3 id="state-machine">State Machine&lt;/h3>
&lt;p>The first level is the &lt;strong>states&lt;/strong>, which are the primary building blocks
of the machine. A machine has one or more states. During the execution, the
machine can be in only one state at a time. Sub- or embedded states aren&amp;rsquo;t
supported because they are only convenient, not mandatory. Also, parallel states
are out-scoped.&lt;/p>
&lt;p>&lt;strong>One of the states must be marketed as &lt;code>initial&lt;/code>&lt;/strong>. Every chatbot conversation
runs its own state machine instance, and the current implementation of machine
termination &lt;em>terminates all running instances&lt;/em> of the machine. &lt;strong>The state
machine can have multiple termination states.&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Note&lt;/strong>, because the final multi-tenant deployment model is still open, and
we have yet to decide on the persistence model, we recommend being extra careful
with the state machine termination. Even though the ending is especially
convenient for the &lt;a href="#issuing-example">&lt;em>one-time scripts&lt;/em>&lt;/a>.&lt;/p>
&lt;/blockquote>
&lt;p>Each state can include relations to other states, including itself. These
relations are &lt;strong>state-transitions&lt;/strong> which include:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>a trigger event&lt;/strong>&lt;/li>
&lt;li>&lt;strong>send events&lt;/strong>&lt;/li>
&lt;li>&lt;strong>a target state&lt;/strong>&lt;/li>
&lt;/ul>
&lt;h3 id="memory">Memory&lt;/h3>
&lt;p>Each state machine instance has one memory register/dictionary/map. All of the
memory access (read/write) are integrated state-transitions, and their
&lt;a href="#rule">rules&lt;/a>. If we bring some scripting language onboard, the memory model
integration is the first thing to solve. Also current memory model isn&amp;rsquo;t
production ready for large-scale service agents because there isn&amp;rsquo;t any
discarding mechanism. However, this will be fixed in the next minor release,
where a transition to the &lt;code>initial&lt;/code> state frees the state machine instance&amp;rsquo;s
memory register. &lt;em>Edit:&lt;/em> memory cleanup is implemented, and Lua is onboard.&lt;/p>
&lt;h3 id="meta-model">Meta-Model&lt;/h3>
&lt;p>Information about the meta-model behind each state machine can be found in
the following diagram. As you can see, the &lt;strong>Machine&lt;/strong> receives and sends
&lt;strong>Events&lt;/strong>. And &lt;strong>States&lt;/strong> controls which inputs, i.e., &lt;strong>triggers&lt;/strong> are &lt;em>valid,
when and how.&lt;/em>&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="/blog/2023/03/13/no-code-ssi-chatbots-fsm-part-i/Main.svg"/>
&lt;/figure>
&lt;em>Conceptual Meta-Model&lt;/em>&lt;/p>
&lt;p>Next, we will see how the &lt;em>Event&lt;/em> is used to run the state machine. After the
next chapter, we should learn to declare all supported types of input and output
events.&lt;/p>
&lt;h2 id="event">Event&lt;/h2>
&lt;p>As we previously defined, state transitions are input/output entities. Both
input and output are also event-based. An input event is called &lt;code>trigger:&lt;/code> and
outcomes are &lt;code>sends:&lt;/code>.&lt;/p>
&lt;p>The event has necessary fields, which we describe next in more detail.&lt;/p>
&lt;ul>
&lt;li>&lt;code>rule:&lt;/code> Defines an operation to be performed when sending an event or what
should happen when inputting an event.&lt;/li>
&lt;li>&lt;code>protocol:&lt;/code> Defines a protocol to be executed when sending or a protocol event
that triggers a state transition.&lt;/li>
&lt;li>&lt;code>data:&lt;/code> Defines additional data related to the event in a &lt;code>string&lt;/code> format.&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">...&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">trigger&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># 1&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">data&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">stop &lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># 2&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">protocol&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">basic_message &lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># 3&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">rule&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">INPUT_EQUAL &lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic"># 4&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol>
&lt;li>Simple example of the &lt;em>trigger event&lt;/em>.&lt;/li>
&lt;li>&lt;code>stop&lt;/code> is a &lt;em>keyword&lt;/em> in this trigger because of the rule (see # 4).&lt;/li>
&lt;li>The keyword is received thru the &lt;code>basic_message&lt;/code> Aries DIDComm protocol.&lt;/li>
&lt;li>&lt;code>INPUT_EQUAL&lt;/code> means that if incoming data equals the &lt;code>data:&lt;/code> field, the
event is accepted, and a state transition is triggered.&lt;/li>
&lt;/ol>
&lt;h3 id="rule">Rule&lt;/h3>
&lt;p>The following table includes all the accepted rules and their meaning for the
event.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Rule&lt;/th>
&lt;th>Meaning&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>OUR_STATUS&lt;/td>
&lt;td>Currently used with &lt;code>issue_cred&lt;/code> protocol to build &lt;em>triggers&lt;/em> to know when issuing is ended successfully.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>INPUT&lt;/td>
&lt;td>Copies input event data to output event data. Rarely needed, more for tests.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>INPUT_SAVE&lt;/td>
&lt;td>Saves input data to a named register. The&lt;code>data:&lt;/code> defines the name of the register.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>FORMAT&lt;/td>
&lt;td>Calls &lt;code>printf&lt;/code> type formatter for send events where the format string is in &lt;code>data:&lt;/code> and value is input &lt;code>data:&lt;/code> field.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>FORMAT_MEM&lt;/td>
&lt;td>Calls &lt;code>Go template&lt;/code> type formatter for send events where the format string is in the &lt;code>data:&lt;/code> field, and named values are in the memory register.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>GEN_PIN&lt;/td>
&lt;td>A new random 6-digit number is generated and stored in the PIN-named register, and FORMAT_MEM is executed according to the &lt;code>data:&lt;/code> field.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>INPUT_VALIDATE_EQUAL&lt;/td>
&lt;td>Validates that received input is equal to the register value. The variable name is in the &lt;code>data:&lt;/code> field.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>INPUT_VALIDATE_NOT_EQUAL&lt;/td>
&lt;td>Negative of previous, e.g., allows us to trigger transition if the input doesn&amp;rsquo;t match.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>INPUT_EQUAL&lt;/td>
&lt;td>Validates that the coming input data is the same in the &lt;code>data:&lt;/code> field. For these, you can implement command keywords that don&amp;rsquo;t take arguments.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ACCEPT_AND_INPUT_VALUES&lt;/td>
&lt;td>Accepts and stores a proof presentation and its values. Values are stored as key/value pairs in the memory register.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>NOT_ACCEPT_VALUES&lt;/td>
&lt;td>Declines a proof presentation.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="protocol">Protocol&lt;/h3>
&lt;p>The following table includes all the accepted Aries protocols and their
properties.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Protocol&lt;/th>
&lt;th>In/Out&lt;/th>
&lt;th>RFC&lt;/th>
&lt;th>Meaning&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>basic_message&lt;/code>&lt;/td>
&lt;td>Both&lt;/td>
&lt;td>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0095-basic-message/README.md">0095&lt;/a>&lt;/td>
&lt;td>Send or receive a messaging protocol (text)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>trust_ping&lt;/code>&lt;/td>
&lt;td>Both&lt;/td>
&lt;td>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0048-trust-ping/README.md">0048&lt;/a>&lt;/td>
&lt;td>A ping protocol for a DIDComm connection&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>issue_cred&lt;/code>&lt;/td>
&lt;td>Out&lt;/td>
&lt;td>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0036-issue-credential/README.md">0036&lt;/a>&lt;/td>
&lt;td>Issue a verifiable credential thru DIDComm&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>present_proof&lt;/code>&lt;/td>
&lt;td>Out&lt;/td>
&lt;td>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0037-present-proof/README.md">0037&lt;/a>&lt;/td>
&lt;td>Request a proof presentation thru DIDComm&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>connection&lt;/code>&lt;/td>
&lt;td>In&lt;/td>
&lt;td>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0023-did-exchange/README.md">0023&lt;/a>&lt;/td>
&lt;td>A new pairwise connection (DID exchange) is finished for the agent&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>The following table includes currently &lt;em>recognized&lt;/em> general protocols and their
properties. Recognized protocols aren&amp;rsquo;t yet thoroughly tested or implemented,
only keywords are reserved and properties listed.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Protocol&lt;/th>
&lt;th>In/Out&lt;/th>
&lt;th>Spec&lt;/th>
&lt;th>Meaning&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>email&lt;/code>&lt;/td>
&lt;td>Both&lt;/td>
&lt;td>JSON&lt;/td>
&lt;td>Send or receive an &lt;a href="#omni-channel-chatbot">email message&lt;/a> (text)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>hook&lt;/code>&lt;/td>
&lt;td>Both&lt;/td>
&lt;td>Internal&lt;/td>
&lt;td>Currently reserved only for internal use&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>On the design table, we have ideas like REST endpoints, embedded scripting
language (Lua, now implemented), file system access, etc.&lt;/p>
&lt;h3 id="data">Data&lt;/h3>
&lt;p>The &lt;code>data&lt;/code> field is used to transport the event&amp;rsquo;s data. Its function is determined by
both &lt;code>rule&lt;/code> and &lt;code>protocol&lt;/code>. Please see the next chapter, &lt;strong>Event Data&lt;/strong>.&lt;/p>
&lt;h3 id="event-data">Event Data&lt;/h3>
&lt;p>The &lt;code>event_data&lt;/code> field transports the event&amp;rsquo;s type-checked data. Its &lt;strong>type&lt;/strong>
is determined by both &lt;code>rule&lt;/code> and &lt;code>protocol&lt;/code>. Currently, it&amp;rsquo;s explicitly used
only in the &lt;code>issue_cred&lt;/code> protocol:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-YAML" data-lang="YAML">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">...&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">data&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">event_data&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">issuing&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">AttrsJSON&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#4e9a06">&amp;#39;[{&amp;#34;name&amp;#34;:&amp;#34;foo&amp;#34;,&amp;#34;value&amp;#34;:&amp;#34;bar&amp;#34;}]&amp;#39;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">CredDefID&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">&amp;lt;CRED_DEF_ID&amp;gt;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">protocol&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">issue_cred&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>We are still &lt;em>work-in-progress&lt;/em> to determine what will be the final role of &lt;code>data&lt;/code>
and &lt;code>event_data&lt;/code>. Are we going to have them both or something else? That will be
decided according to the feedback from the FSM chatbot feature.&lt;/p>
&lt;h2 id="issuing-example">Issuing Example&lt;/h2>
&lt;p>The following chatbot is an illustration of our chatbot from our
&lt;a href="https://github.com/findy-network/identity-hackathon-2023/blob/master/cli/issue-bot.template.yaml">Identity Hackathon 2023 repository.&lt;/a>
It&amp;rsquo;s proven extremely handy to kick these chatbots up during the demo
or development without forgetting the production in the future.&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="/blog/2023/03/13/no-code-ssi-chatbots-fsm-part-i/issue-one.svg"/>
&lt;/figure>
&lt;em>Run once - Issuing Chat Bot&lt;/em>&lt;/p>
&lt;h3 id="omni-channel-chatbot">Omni-Channel Chatbot&lt;/h3>
&lt;p>The diagram below presents another example of the &lt;a href="https://github.com/findy-network/findy-agent-cli/blob/master/scripts/test/sa/email-issuer-bot.yaml">automatic issuing
chatbot&lt;/a>
for verifying an email address. Please read the state transition arrows
carefully. They define triggers and events to send. There is a transition that
sends an Aries &lt;code>basic_message&lt;/code> and an &lt;code>email&lt;/code> in the same transition. The email
message built by the machine includes a random PIN code. As you can see, the
state machine can adequately verify the PIN code.&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="/blog/2023/03/13/no-code-ssi-chatbots-fsm-part-i/issue.svg"/>
&lt;/figure>
&lt;em>Automatic Email Credential Chat Bot&lt;/em>&lt;/p>
&lt;p>It&amp;rsquo;s been rewarding to notice how well chatting and using verifiable credentials
fit together. As an end-user, you won&amp;rsquo;t face annoying context switches, but
everything happens in the same logical conversation.&lt;/p>
&lt;h2 id="future-features">Future Features&lt;/h2>
&lt;p>The most critical task in the future will be documentation. Hopefully, this
blog post helps us to get it going.&lt;/p>
&lt;p>Something we have thought about during the development:&lt;/p>
&lt;ul>
&lt;li>transition triggers are currently SSI-only which can be changed in the
future
&lt;ul>
&lt;li>transient states&lt;/li>
&lt;li>&lt;em>Edit&lt;/em>: Now embedded Lua that solves limitless trigger types and make need
for transient states obsolete&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>straightforward memory model
&lt;ul>
&lt;li>no persistence model&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>verification/simulation tools: a model checker&lt;/li>
&lt;li>simple scripting language inside the state machine, &lt;em>Edit:&lt;/em> Lua is now
implemented&lt;/li>
&lt;li>deployment model: cloud, end-user support&lt;/li>
&lt;li>end-user level tools&lt;/li>
&lt;/ul>
&lt;p>Please take it for a test drive and let us know your thoughts. Until the
next time, see you!&lt;/p></description></item><item><title>Blog: How to Equip Your App with VC Superpowers</title><link>/blog/2023/02/06/how-to-equip-your-app-with-vc-superpowers/</link><pubDate>Mon, 06 Feb 2023 00:00:00 +0000</pubDate><guid>/blog/2023/02/06/how-to-equip-your-app-with-vc-superpowers/</guid><description>
&lt;p>&lt;a href="/blog/2023/01/30/getting-started-with-ssi-service-agent-development/">My previous blog post&lt;/a>
explained how to get started with SSI service agents using our CLI tool.
But what about the next step, the integration into your application?&lt;/p>
&lt;p>As I have previously described &lt;a href="https://findy-network.github.io/blog/2022/08/29/the-findy-agency-api/">in my earlier blog post&lt;/a>,
Findy Agency API is the interface to
Findy Agency for clients that wish to use the agency services programmatically. You can compile the
gRPC API for &lt;a href="https://grpc.io/docs/languages/">multiple languages&lt;/a>.
However, the most straightforward is to start with the ones for which we provide some additional tooling:
&lt;strong>Go&lt;/strong>, &lt;strong>Typescript&lt;/strong> (JavaScript), or &lt;strong>Kotlin&lt;/strong>.&lt;/p>
&lt;h2 id="the-server-samples">The Server Samples&lt;/h2>
&lt;p>&lt;a href="https://github.com/findy-network/identity-hackathon-2023">The sample repository&lt;/a> has an example
server for each of the three languages. You can run the samples
by cloning the repository and following
the instructions in the README.&lt;/p>
&lt;p>The sample servers demonstrate a similar issuing and verifying example as the CLI script in the previous post.
The server has two endpoints, &lt;code>/issue&lt;/code> and &lt;code>/verify&lt;/code>.
Both endpoints display QR codes for connection invitations.
The server starts a listener who gets notified when a new connection is established
(the holder has read the invitation).
The notification triggers either the credential issuance or verification,
depending on the endpoint that displayed the invitation.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 835px">
&lt;img class="card-img-top" src="/blog/2023/02/06/how-to-equip-your-app-with-vc-superpowers/cover-issue_hu1186a2ecfb762399517a72c1f28aa084_224211_825x825_fit_catmullrom_3.png" width="825" height="603">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Reading the QR code from the issue page triggers a credential offer.
The Web Wallet is displayed on the right side with its chat UI.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 835px">
&lt;img class="card-img-top" src="/blog/2023/02/06/how-to-equip-your-app-with-vc-superpowers/verify_hu76fd486adc4246f4b95e4b1f8edf031d_241335_825x825_fit_catmullrom_3.png" width="825" height="605">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The connection created from the verify page triggers a proof request.
The sample creates dedicated connections for both issue and verify operations,
but it would be possible to use the same connection as well. &lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="the-server-code">The Server Code&lt;/h2>
&lt;p>I have gathered snippets to which you should pay close attention when checking the sample code.
The snippets chosen here are from &lt;a href="https://github.com/findy-network/identity-hackathon-2023/tree/master/go">the Go sample&lt;/a>,
but each server contains similar functionality.&lt;/p>
&lt;h3 id="client-registration-and-authentication">Client Registration and Authentication&lt;/h3>
&lt;p>The agency API clients use &lt;a href="/blog/2021/11/09/anchoring-chains-of-trust/#headless-fido2webauthn-authenticator">headless FIDO2 authentication&lt;/a>.
Before the client
can make any API requests, it must authenticate and acquire a JWT token using the FIDO2 protocol.
This Go example uses the authenticator functionality from
the &lt;em>&lt;a href="https://github.com/findy-network/findy-agent-auth">github.com/findy-network/findy-agent-auth&lt;/a>&lt;/em> package.
Other implementations (Typescript, Kotlin)
currently utilize the &lt;a href="https://github.com/findy-network/findy-agent-cli">findy-agent-cli&lt;/a>
binary for headless authentication.&lt;/p>
&lt;p>&lt;a href="https://github.com/findy-network/identity-hackathon-2023/blob/b6462464dca79415271a7c179e0c5f8b1373b280/go/agent/agent.go#L186">The sample code&lt;/a>
tries to authenticate first, and only if the authentication fails
will it try the client registration. The registration binds the client key to the client account,
and after a successful registration, the client can log in and receive the JWT token needed
for the API calls.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;github.com/findy-network/findy-agent-auth/acator/authn&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// use command from the headless authenticator package
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">authnCmd&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">authn&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Cmd&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">SubCmd&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">UserName&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">os&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Getenv&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;FCLI_USER&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>&lt;span style="color:#8f5902;font-style:italic">// client username
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">Url&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">os&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Getenv&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;FCLI_URL&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// FIDO2 server URL
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">AAGUID&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;12c85a48-4baf-47bd-b51f-f192871a1511&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Key&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">os&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Getenv&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;FCLI_KEY&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// authenticator key
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">Counter&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Token&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Origin&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">os&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Getenv&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;FCLI_ORIGIN&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">a&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">Agent&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">register&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">err&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">defer&lt;/span> &lt;span style="color:#000">err2&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Handle&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">myCmd&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">authnCmd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">myCmd&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SubCmd&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;register&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">myCmd&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Validate&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To1&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">myCmd&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Exec&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">os&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Stdout&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">a&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">Agent&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">login&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">err&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">defer&lt;/span> &lt;span style="color:#000">err2&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Handle&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">myCmd&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">authnCmd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">myCmd&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SubCmd&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;login&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">myCmd&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Validate&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">r&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To1&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">myCmd&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Exec&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">os&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Stdout&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// store token for successful authentication
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">a&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">JWT&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Token&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>With a valid JWT, the client can create the gRPC API connection and the real fun can begin!&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;github.com/findy-network/findy-common-go/agency/client&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">agency&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;github.com/findy-network/findy-common-go/grpc/agency/v1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#34;google.golang.org/grpc&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// set up API connection
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">conf&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BuildClientConnBase&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">os&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Getenv&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;FCLI_TLS_PATH&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">agent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">AgencyHost&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">agent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">AgencyPort&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">[]&lt;/span>&lt;span style="color:#000">grpc&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">DialOption&lt;/span>&lt;span style="color:#000;font-weight:bold">{},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">conn&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TryAuthOpen&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">agent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">JWT&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">conf&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">agent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Client&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">AgencyClient&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Conn&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">conn&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">AgentClient&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewAgentServiceClient&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">conn&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">ProtocolClient&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewProtocolServiceClient&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">conn&lt;/span>&lt;span style="color:#000;font-weight:bold">),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="schema-and-credential-definition-creation">Schema and Credential Definition Creation&lt;/h3>
&lt;p>When the server starts for the first time, it creates a schema and a credential definition.
The issuer always needs a credential definition to issue credentials.
For the verifier, it is enough to know the credential definition id.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// use the agent API to create schema and credential definition
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">schemaRes&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To1&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">a&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">AgentClient&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">CreateSchema&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TODO&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SchemaCreate&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">schema&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Name&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Version&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;1.0&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Attributes&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">schema&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Attributes&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// tag the credential definition with our client username
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">res&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To1&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">a&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">AgentClient&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">CreateCredDef&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TODO&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">CredDefCreate&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">SchemaID&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">schemaRes&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Tag&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">authnCmd&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">UserName&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">credDefID&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">res&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GetID&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The app stores the created credential definition ID in a text file. The app will skip
the credential definition creation step if this text file exists on the server bootup.&lt;/p>
&lt;p>The credential definition ID is essential.
You should share it with whoever needs to verify the credentials issued by your issuer.&lt;/p>
&lt;h3 id="creating-the-invitation">Creating the Invitation&lt;/h3>
&lt;p>After the start routines, the server endpoints are ready to display the pairwise connection invitations.
The holder agent can establish a secure pairwise connection with the information in the invitation.&lt;/p>
&lt;p>The client uses CreateInvitation-API to generate the invitation:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">res&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To1&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ourAgent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">AgentClient&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">CreateInvitation&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TODO&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">InvitationBase&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#000">Label&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">ourAgent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">UserName&lt;/span>&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The endpoint returns HTML that renders the invitation as QR code.&lt;/p>
&lt;p>When using a mobile device, the invitation can be read with the web wallet camera or desktop browser,
copy-pasting the invitation URL to the Add connection -dialog.&lt;/p>
&lt;h3 id="listening-to-notifications">Listening to Notifications&lt;/h3>
&lt;p>Another core concept in the client implementation is listening to the agent notifications.
The client opens a gRPC stream to the server and receives notifications of the agent
events through the stream.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// pick notifications from stream channel
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">ch&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To1&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">agent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Conn&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ListenStatus&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TODO&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ClientID&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">agent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ClientID&lt;/span>&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// start go routine for the channel listener
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">go&lt;/span> &lt;span style="color:#204a87;font-weight:bold">func&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">chRes&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">ch&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">!&lt;/span>&lt;span style="color:#000">ok&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87">panic&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;Listening failed&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">notification&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">chRes&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GetNotification&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">log&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Printf&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;Received agent notification %v\n&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">notification&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">switch&lt;/span> &lt;span style="color:#000">notification&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GetTypeID&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Notification_STATUS_UPDATE&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">switch&lt;/span> &lt;span style="color:#000">notification&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GetProtocolType&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Protocol_DIDEXCHANGE&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">agent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Listener&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">HandleNewConnection&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">status&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">GetDIDExchange&lt;/span>&lt;span style="color:#000;font-weight:bold">().&lt;/span>&lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>For instance, when the server creates a pairwise connection so that the holder can connect to
the issuer, the notification of the new connection is sent through the stream.&lt;/p>
&lt;div class="mermaid">sequenceDiagram
autonumber
participant Server
participant Agency
participant Web Wallet
Server->>Agency: Start listening
Server-->>Web Wallet: Show QR code
Web Wallet->>Agency: Read QR code
Agency->>Server: Connection created!
Note right of Server: Conn ID for issue
Server->>Agency: Send credential offer
Agency->>Web Wallet: Cred offer received!
Web Wallet->>Agency: Accept offer
Agency->>Server: Issue ok!
&lt;/div>
&lt;p>In the sequence above, steps &lt;strong>4&lt;/strong> and &lt;strong>8&lt;/strong> are notifications sent through the listener stream.&lt;/p>
&lt;p>The client can then
react to the event accordingly. For example,
when a new connection is established from the issue endpoint, the client sends a credential offer:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">a&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">AgentListener&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">HandleNewConnection&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// pairwise based on the connection id
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">pw&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewPairwise&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ourAgent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Client&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Conn&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">id&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// credential values
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">attributes&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#204a87">make&lt;/span>&lt;span style="color:#000;font-weight:bold">([]&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Protocol_IssuingAttributes_Attribute&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">attributes&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Protocol_IssuingAttributes_Attribute&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;foo&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Value&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;bar&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// send the offer
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">res&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To1&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">pw&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">IssueWithAttrs&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">context&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TODO&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">ourAgent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">CredDefID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Protocol_IssuingAttributes&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Attributes&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">attributes&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>A similar flow happens when the proof is verified. The exception with the proof is that there is
an additional step where the client
can reject the proof
if the proof values are not valid according to the business logic
(even though the proof would be cryptographically valid).&lt;/p>
&lt;h2 id="start-with-your-use-case">Start with Your Use Case&lt;/h2>
&lt;p>Now you should have the technical setup ready to start implementing your use case.
But as with always in software development, we need more than technical capabilities.
Before starting the implementation, try to figure out the roles and duties of your process participants:&lt;/p>
&lt;p>&lt;strong>Define the credential(s) content.&lt;/strong>
Think about which data attributes you need. The sample issues the type “foobar” credentials
with a single attribute “foo.” Foobar data is probably not the type you wish to issue and utilize.&lt;/p>
&lt;p>&lt;strong>Define the data flow participants.&lt;/strong>
Draft your data flow and resolve which parties are the issuer, verifier, and holder or
are some parties even in multiple roles. In the sample, a single service agent handles both issuing
and verifying. That is not a probable scenario in a real-world use case, as the whole point of SSI
and verified data use is to verify credentials that other parties have issued.&lt;/p>
&lt;p>&lt;strong>Define how you operate each verified data flow participant.&lt;/strong>
The sample had a CLI tool or API client as the issuer and verifier and a web wallet user
as the holder. Depending on the use case, you might have a similar setup or, for example,
another service agent as the holder in a service-to-service scenario. Or you would like
to integrate the holder capabilities into your end-user application instead of using
the agency web wallet.&lt;/p>
&lt;p>Of course, in cases where we have multiple real-world parties
involved, the detailed design is done together with the other participants.&lt;/p>
&lt;h2 id="feedback">Feedback&lt;/h2>
&lt;p>Let us know if you have any feedback regarding
the Findy Agency functionality or documentation. It would also be cool &lt;a href="https://github.com/findy-network/findy-agent/discussions/new?category=show-and-tell">to hear about
the PoCs, demos and applications you have built&lt;/a>
using the agency.&lt;/p>
&lt;p>You can also reach us via SoMe channels:&lt;/p>
&lt;div style="display: flex">
&lt;span>
&lt;img src="https://avatars.githubusercontent.com/u/29113682?v=4%22" width="100"/>
&lt;div>Laura&lt;/div>
&lt;div>&lt;a href="https://github.com/lauravuo/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-github ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://www.linkedin.com/in/lauravuorenoja/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-linkedin ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://fosstodon.org/@lauravuo" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-mastodon ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://twitter.com/vuorenoja" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-twitter ml-2 ">&lt;/i>&lt;/a>&lt;/div>
&lt;/span>&lt;span style="padding-left: 2em">
&lt;img src="https://avatars.githubusercontent.com/u/11439212?v=4" width="100">
&lt;div>Harri&lt;/div>
&lt;div>&lt;a href="https://github.com/lainio/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-github ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://www.linkedin.com/in/harrilainio/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-linkedin ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://twitter.com/harrilainio" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-twitter ml-2 ">&lt;/i>&lt;/a>&lt;/div>
&lt;/span>&lt;/div>&lt;br>&lt;br></description></item><item><title>Blog: Getting Started with SSI Service Agent Development</title><link>/blog/2023/01/30/getting-started-with-ssi-service-agent-development/</link><pubDate>Mon, 30 Jan 2023 00:00:00 +0000</pubDate><guid>/blog/2023/01/30/getting-started-with-ssi-service-agent-development/</guid><description>
&lt;p>In the new SSI world, we craft digital services according to the self-sovereign identity model.
We will have applications that issue credentials for the data they possess and applications
that can verify these credentials. The central entity is the digital wallet owner
that can hold these credentials and present them when needed.&lt;/p>
&lt;p>&lt;em>&amp;ldquo;Ok, sounds great!&amp;rdquo;&lt;/em> you may think.
&lt;em>&amp;ldquo;I want to utilize credentials also in my web application. But where to start?&amp;rdquo;&lt;/em>&lt;/p>
&lt;p>Developing decentralized applications is tricky as it usually requires setting up
multiple applications on your local computer or acquiring access to services set up by others.
Using Findy Agency tackles this hurdle. It is an SSI solution that offers
a complete set of tools for managing your digital wallet and agent via a user interface or an API.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 835px">
&lt;img class="card-img-top" src="/blog/2023/01/30/getting-started-with-ssi-service-agent-development/cover-trust-triangle_hu6055598bbc117b5746e17689e6901128_77425_825x825_fit_catmullrom_3.png" width="825" height="464">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Findy Agency provides tools for playing each role in the trust triangle: CLI and API clients
have the complete tool pack, and the web wallet user can currently hold and prove credentials.
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The Agency tooling provides you with &lt;a href="https://github.com/findy-network/findy-wallet-pwa">a web wallet&lt;/a>
and a CLI tool that you can use to test
your service&amp;rsquo;s issuing and verifying features. You can easily setup the whole Findy Agency
software to your local computer &lt;a href="https://github.com/findy-network/findy-wallet-pwa/tree/dev/tools/env#agency-setup-for-local-development">using Docker containers and a simulated ledger&lt;/a>.
Or, if you have an agency cloud installation available, you can utilize it for your
service agent development without using any extra proxies or network tools.&lt;/p>
&lt;p>&lt;em>&amp;ldquo;So, I have the agency up and running. What next?&amp;rdquo;&lt;/em>&lt;/p>
&lt;p>&lt;strong>TL;DR&lt;/strong> Take a look at the examples found in &lt;a href="https://github.com/findy-network/identity-hackathon-2023">the sample repository&lt;/a>!&lt;/p>
&lt;p>The sample repository provides simple yet comprehensive examples to start issuing and verifying
using the CLI tool or with the agency API. The easiest path is to start with the CLI.&lt;/p>
&lt;h2 id="run-the-cli">Run the CLI&lt;/h2>
&lt;p>&lt;a href="https://github.com/findy-network/findy-agent-cli">&amp;ldquo;findy-agent-cli&amp;rdquo;&lt;/a>
is a command-line tool that provides all the required
agent manipulation functionality. It provides means to quickly test out
the issuing and verifying &lt;em>before writing any code&lt;/em>.&lt;/p>
&lt;p>&lt;a href="https://github.com/findy-network/identity-hackathon-2023/tree/master/cli#cli-example">The sample script&lt;/a>
is a good starting point. It shows how to allocate an agent in the cloud
and issue and verify credentials using a simple chatbot. You can run it by cloning &lt;a href="https://github.com/findy-network/identity-hackathon-2023">the repository&lt;/a>
and following the instructions in the README.&lt;/p>
&lt;h3 id="cli-script-initialization-phase">CLI Script Initialization Phase&lt;/h3>
&lt;p>The sample script initialization phase allocates a new agent from the agency (&lt;strong>1&lt;/strong>)
and authenticates the CLI user (&lt;strong>2-3&lt;/strong>). The authentication returns a JWT token
exposed to the script environment so that further CLI calls can utilize it
automatically.&lt;/p>
&lt;p>For the agent to issue credentials, an applicable schema needs to exist.
The schema describes the contents of a credential, i.e., which attributes the credential contains.
The sample script creates a schema &amp;ldquo;foobar&amp;rdquo; with a single attribute &amp;ldquo;foo&amp;rdquo; (&lt;strong>4-5&lt;/strong>).&lt;/p>
&lt;p>There needs to be more than the mere schema for the issuing process; the agent needs also to create
and publish its credential definition (&lt;strong>6-7&lt;/strong>) attached to the created schema so that it can issue
credentials and verifiers can verify the proof presentations against the published credential definition.&lt;/p>
&lt;p>We assume that the holder operates a web wallet and &lt;a href="https://github.com/findy-network/findy-wallet-pwa#registerlogin">has taken it into use&lt;/a>.
Note that you can play the holder role also with the CLI tool.&lt;/p>
&lt;div class="mermaid">sequenceDiagram
autonumber
participant CLI
participant Agency
participant Web Wallet
CLI->>Agency: Register
CLI->>Agency: Login
Agency-->>CLI: JWT token
CLI->>Agency: Create schema
Agency-->>CLI: Schema ID
CLI->>Agency: Create cred def
Agency-->>CLI: Cred def ID
&lt;/div>
&lt;h3 id="cli-script-issuing-credential">CLI Script Issuing Credential&lt;/h3>
&lt;p>The next task is to create a pairwise connection between the agent operated by the CLI user
and the web wallet user. The pairwise connection is an encrypted pipe between the two
agents that they can use to exchange data securely. The CLI script creates an invitation (&lt;strong>1-2&lt;/strong>)
and prints it out (&lt;strong>3&lt;/strong>) as a QR code that the web wallet user can read (&lt;strong>5&lt;/strong>).&lt;/p>
&lt;p>Once the new connection ID is known, the CLI script starts a chatbot (&lt;strong>4&lt;/strong>) for the new connection.
The bot logic follows the rules for changing the bot states in the YAML file. Therefore,
the bot handles the rest of the issuing process (&lt;strong>6-7&lt;/strong>).&lt;/p>
&lt;p>Once the issuer bot notices that credential issuing succeeded, it stops the bot (&lt;strong>10-11&lt;/strong>), and
the sample script moves on to verifying the same credential.&lt;/p>
&lt;div class="mermaid">sequenceDiagram
autonumber
participant CLI
participant Issue Bot
participant Agency
participant Web Wallet
CLI->>Agency: Create invitation
Agency-->>CLI: Invitation URL
CLI-->>Web Wallet: &lt;&lt;show QR code>
CLI->>Issue Bot: Start
Web Wallet->>Agency: Read QR code
Agency-->>Issue Bot: Connection ready!
Issue Bot->>Agency: Issue credential
Agency-->>Web Wallet: Accept offer?
Web Wallet->>Agency: Accept
Agency-->>Issue Bot: Issue ready!
Issue Bot->>Issue Bot: Terminate
&lt;/div>
&lt;h3 id="cli-script-verifying-credential">CLI Script Verifying Credential&lt;/h3>
&lt;p>Steps &lt;strong>1-6&lt;/strong> proceed similarly to the issuing: first, the agents form a new pairwise connection.
However, the process continues with a proof request sent by the verifier bot (&lt;strong>7&lt;/strong>). The proof request
contains the attributes the bot wishes the holder to present. The web wallet user sees
the requested data once they receive the message (&lt;strong>8&lt;/strong>), and they can either accept or reject the request.&lt;/p>
&lt;p>After the proof is accepted (&lt;strong>9&lt;/strong>), the agency verifies it cryptographically.
If the verification succeeds, the agency notifies the verifier bot with the proof values (&lt;strong>10&lt;/strong>).
It can reject the proof if the values are not acceptable by the business logic.
The sample bot accepts all attribute values, so the verifying process is continued
without extra validation (&lt;strong>11&lt;/strong>).
The bot exits when the proof is completed (&lt;strong>12-13&lt;/strong>).&lt;/p>
&lt;div class="mermaid">sequenceDiagram
autonumber
participant CLI
participant Verify Bot
participant Agency
participant Web Wallet
CLI->>Agency: Create invitation
Agency-->>CLI: Invitation URL
CLI-->>Web Wallet: &lt;&lt;show QR code>
CLI->>Verify Bot: Start
Web Wallet->>Agency: Read QR code
Agency-->>Verify Bot: Connection ready!
Verify Bot->>Agency: Proof request
Agency-->>Web Wallet: Accept request?
Web Wallet->>Agency: Accept
Agency-->>Verify Bot: Proof paused
Verify Bot->>Agency: Resume proof
Agency-->>Verify Bot: Proof ready!
Verify Bot->>Verify Bot: Terminate
&lt;/div>
&lt;h3 id="cli-as-a-test-tool">CLI as a Test Tool&lt;/h3>
&lt;p>Note that you can also utilize the CLI for testing.
It is an excellent tool to simulate the functionality on the other end.&lt;/p>
&lt;p>For instance, let’s say you are developing an issuer service.
You can use the CLI tool to act as the holder client and to receive the credential.
Or you can use the web wallet to hold the credential
and create another client with the CLI tool to verify the issued data.&lt;/p>
&lt;h2 id="feedback">Feedback&lt;/h2>
&lt;p>The CLI sample script presented above demonstrates all the core features of verified data flow.
It should make you well-equipped to play around with the CLI tool yourself!&lt;/p>
&lt;p>Your tool pack will extend even more with our next blog posts.
They will describe how to use the agency API programmatically
and dive deep into crafting verified data supporting chatbot state machines.&lt;/p>
&lt;p>Let us know if you have any feedback regarding
the Findy Agency functionality or documentation.
You can reach us, for example &lt;a href="https://github.com/findy-network/findy-agent/issues">creating an issue&lt;/a>
or &lt;a href="https://github.com/findy-network/findy-agent/discussions">starting a discussion&lt;/a> in GitHub.&lt;/p>
&lt;p>You can also reach us via SoMe channels:&lt;/p>
&lt;div style="display: flex">
&lt;span>
&lt;img src="https://avatars.githubusercontent.com/u/29113682?v=4%22" width="100"/>
&lt;div>Laura&lt;/div>
&lt;div>&lt;a href="https://github.com/lauravuo/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-github ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://www.linkedin.com/in/lauravuorenoja/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-linkedin ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://fosstodon.org/@lauravuo" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-mastodon ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://twitter.com/vuorenoja" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-twitter ml-2 ">&lt;/i>&lt;/a>&lt;/div>
&lt;/span>&lt;span style="padding-left: 2em">
&lt;img src="https://avatars.githubusercontent.com/u/11439212?v=4" width="100">
&lt;div>Harri&lt;/div>
&lt;div>&lt;a href="https://github.com/lainio/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-github ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://www.linkedin.com/in/harrilainio/" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-linkedin ml-2 ">&lt;/i>&lt;/a>
&lt;a href="https://twitter.com/harrilainio" target="_blank" rel="noopener noreferer">&lt;i class="fab fa-twitter ml-2 ">&lt;/i>&lt;/a>&lt;/div>
&lt;/span>&lt;/div>&lt;br>&lt;br>
&lt;p>&lt;em>Good luck on your journey into the SSI world!&lt;/em>&lt;/p></description></item><item><title>Blog: Ledger Multiplexer</title><link>/blog/2022/09/30/ledger-multiplexer/</link><pubDate>Fri, 30 Sep 2022 00:00:00 +0000</pubDate><guid>/blog/2022/09/30/ledger-multiplexer/</guid><description>
&lt;p>In this technical blog post, I&amp;rsquo;ll explain how I implemented a plugin system into
our &lt;a href="https://github.com/hyperledger/indy-sdk">Indy SDK&lt;/a>
&lt;a href="https://github.com/findy-network/findy-wrapper-go">Go wrapper&lt;/a> and then
extended it to work as a multiplexer. The plugin system allows us to use a
key/value-based storage system instead of the normal Indy ledger. And
multiplexing extended the functionality to use multiple data sources
simultaneously and asynchronously. For instance, we can add a memory cache to
help Indy ledger, which has been proving to make a considerable difference in a
multi-tenant agency that can serve thousands of different wallet users
simultaneously.&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="/blog/2022/09/30/ledger-multiplexer/Plugin.svg"/>
&lt;/figure>
&lt;em>Package And Interface Structure&lt;/em>&lt;/p>
&lt;p>As you can see in the picture above &lt;code>plugin&lt;/code> package defines just needed types
and interfaces that the &lt;code>addons&lt;/code> package&amp;rsquo;s plugins implement. The &lt;code>FINDY_LEDGER&lt;/code>
plugin routes transactions to the authentic Indy ledger. We will show in this
post how it&amp;rsquo;s implemented and used.&lt;/p>
&lt;h2 id="reduce-setup-complexity">Reduce Setup Complexity&lt;/h2>
&lt;p>Indy ledger has been bugging me since we met each other:&lt;/p>
&lt;ul>
&lt;li>Why was it written in Python when everybody had to know that it would be
a performance-critical part of the system?&lt;/li>
&lt;li>Why it was implemented with ZeroMQ when it used so simple TCP/IP communication? (Was it
because of Python?) Anyway, every dependency is a dependency to handle.&lt;/li>
&lt;li>Why didn&amp;rsquo;t it offer a development run mode from the beginning? For instance, a
pseudo node would offer local development and test environment?&lt;/li>
&lt;li>Why it didn&amp;rsquo;t offer a straightforward own separated API? With Indy SDK, you had to build
each transaction with three separate functions that weren&amp;rsquo;t general but
entity-specific, like &lt;code>indy_build_cred_def_request()&lt;/code>.&lt;/li>
&lt;li>Why the transaction model was so unclear and &amp;lsquo;hid&amp;rsquo; from the rest of the
Indy SDK functions? (See previous one.)&lt;/li>
&lt;li>Why could Indy nodes not idle? When no one was connected to the ledger, it still
used a shit load of CPU time per node, and there was a four (4) node minimum in
the local setup.&lt;/li>
&lt;/ul>
&lt;p>For the record, first, it&amp;rsquo;s too easy to write the previous list when someone has
done everything ready; second, I appreciate all the work Hyperledger Indy has
done.&lt;/p>
&lt;p>So why bother nagging? To learn and share that learning. If our team or I will
ever build anything where we would use a distributed ledger from scratch, we
would follow these guidelines:&lt;/p>
&lt;ul>
&lt;li>Give a straightforward and separated API for ledger access.&lt;/li>
&lt;li>Implement some out-of-the-box mocking for development, e.g., use a memory
database.&lt;/li>
&lt;li>Offer a way to set up a production system without an actual consensus protocol and
DLT but offer a single database and tools to migrate that to real DLT when
the time comes.&lt;/li>
&lt;/ul>
&lt;h2 id="support-tdd-test-driven-development">Support TDD (Test-Driven Development)&lt;/h2>
&lt;p>I have noticed that we programmers far too easily avoid automating or
documenting our work. Luckily, Go as a language selection supports that very
well. Fortunately, our two-person team focused on how we should rely on
code-centric automated testing in everything from the beginning.&lt;/p>
&lt;p>I wanted to support both unit and integration tests without the mock framework&amp;rsquo;s
help and the need to set up a complex environment just for simple testing. My
choice was to have a memory ledger. That would also help with instrumentation
and debugging of our code.&lt;/p>
&lt;p>Soon I noticed that the memory ledger was insufficient to support fast phase
development, but we would need some persistence. A JSON file, aka file ledger,
seemed an excellent way to start. The JSON would support tracing and offer
another interface for us humans.&lt;/p>
&lt;p>When putting these two together, I ended up building our first plugin system for
VDR.&lt;/p>
&lt;p>We were so happy &lt;em>without&lt;/em> the bloated ledger that we all started to think about
how we could remove the whole ledger out of the picture permanently, but that&amp;rsquo;s
it is own story to tell.&lt;/p>
&lt;h2 id="reverse-engineering-indy-sdk">Reverse-engineering Indy SDK&lt;/h2>
&lt;p>Before I could safely relay that my solution won&amp;rsquo;t hit my face later, I had to
check what Indy functions don&amp;rsquo;t separate wallet and ledger access, i.e., they
take both wallet handle and ledger connection handle as their argument. I found
two that kinds of functions that we were using at that time:&lt;/p>
&lt;ol>
&lt;li>&lt;code>indy_key_for_did()&lt;/code>&lt;/li>
&lt;li>&lt;code>indy_get_endpoint_for_did()&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>Both functions check if they can find information from the wallet, and the
ledger is the backup. &lt;em>For those listening to our presentation on Hyperledger
Global Forum, I mistakenly said that I used -1 for the wallet handle, which is
incorrect. Sorry about that. (1-0, once again, for documentation.)&lt;/em>&lt;/p>
&lt;p>I discovered that I could enumerate our ledger connection handles
starting from -1 and going down like -1, -2, and so forth. So I didn&amp;rsquo;t need any extra
maps to convert connection handles, which would add complexity and affect
performance. I could give connection handles with negative values to
the above functions, and &lt;code>libindy&lt;/code> accepted that.&lt;/p>
&lt;p>Here you can see what the first function (&lt;code>indy_key_for_did()&lt;/code>) looks like in
our wrapper&amp;rsquo;s API. And I can assure you that &lt;code>c2go.KeyForDid&lt;/code> internal
implementation wrapper for Go&amp;rsquo;s CGO, which is a C-API bridge, doesn&amp;rsquo;t treat
&lt;code>pool&lt;/code> and &lt;code>wallet&lt;/code> handles differently before passing them to Indy SDK&amp;rsquo;s Rust
code. The pool handle can be -1, -2, etc.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// Key returns DIDs key from wallet. Indy&amp;#39;s internal version tries to get the
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// key from the ledger if it cannot get from wallet. NOTE! Because we have our
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// Ledger Plugin system at the top of the wrappers we cannot guarantee that
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// ledger fetch will work. Make sure that the key is stored to the wallet.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000">Key&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">pool&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">wallet&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">didName&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">ctx&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Channel&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">c2go&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">KeyForDid&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">pool&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">wallet&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">didName&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Some versions of &lt;code>libindy&lt;/code> worked so well that if the connection handle wasn&amp;rsquo;t
valid, it didn&amp;rsquo;t crash but just returned that it could not fetch the key. Of course,
that helped my job.&lt;/p>
&lt;h2 id="the-plugin-interface">The Plugin Interface&lt;/h2>
&lt;p>I started with a straightforward key/value interface first. But when we decided to
promote Indy ledger to one of the plugins, which it wasn&amp;rsquo;t before multiplexing,
we brought transaction information to a still simple interface. It has only
&lt;code>Write&lt;/code> and &lt;code>Read&lt;/code> functions.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// Mapper is an property getter/setter interface for addon ledger
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// implementations.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000">Mapper&lt;/span> &lt;span style="color:#204a87;font-weight:bold">interface&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Write&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">tx&lt;/span> &lt;span style="color:#000">TxInfo&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">data&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// Read follows ErrNotExist semantics
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000">Read&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">tx&lt;/span> &lt;span style="color:#000">TxInfo&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Naturally, the plugin system has an interface &lt;code>Plugin&lt;/code>, but it&amp;rsquo;s even more
straightforward, and it does not interest us now, but you see it in the UML
picture above.&lt;/p>
&lt;p>The following code block shows how transaction information is used to keep
the public interface simple and generic.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ao&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">Indy&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">Write&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">tx&lt;/span> &lt;span style="color:#000">plugin&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TxInfo&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">data&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">switch&lt;/span> &lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TxType&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">plugin&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TxTypeDID&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">ao&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">writeDID&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">plugin&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TxTypeSchema&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">ao&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">writeSchema&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">plugin&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TxTypeCredDef&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">ao&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">writeCredDef&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The following code block is an example of how the Indy ledger plugin implements
&lt;em>schema&lt;/em> writing transaction with &lt;code>libindy&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ao&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">*&lt;/span>&lt;span style="color:#000">Indy&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000">writeSchema&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">tx&lt;/span> &lt;span style="color:#000">plugin&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TxInfo&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">ID&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">data&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">err&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">defer&lt;/span> &lt;span style="color:#000">err2&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Return&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">glog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">V&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">Infoln&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;submitter:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SubmitterDID&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">r&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">ledger&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">BuildSchemaRequest&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SubmitterDID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">data&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Err&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">srq&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Str1&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">r&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">ledger&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SignAndSubmitRequest&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ao&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">handle&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Wallet&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SubmitterDID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">srq&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Err&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">checkWriteResponse&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Str1&lt;/span>&lt;span style="color:#000;font-weight:bold">()))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>readFrom2&lt;/code> is the heart of the cache system of our multiplexer. As you can
see, it&amp;rsquo;s not a fully dynamic multiplexer with &lt;em>n&lt;/em> data sources. It&amp;rsquo;s made for
just two, which is enough for all our use cases. It also depends on the
actuality that the Indy ledger plugin is the first, and the cache plugin is the
next. Please note that cache can still be whatever type of the plugins, even
&lt;code>immuDB&lt;/code>.&lt;/p>
&lt;p>Thanks to Go&amp;rsquo;s powerful channel system, goroutines, and an essential control
structure for concurrent programming with channels, the &lt;code>select&lt;/code> -statement, the
algorithm is quite simple, short, and elegant. Faster wins the reading contest,
and if the Indy ledger wins, we can assume that the queried data is only in the
Indy ledger. Like the case where other DID agents use the same Indy ledger, we
are using DLT for interoperability.&lt;/p>
&lt;p>And yes, you noticed, we think that the ledger is always the slower one, and if
it&amp;rsquo;s not, it doesn&amp;rsquo;t matter that we tried to write it to cache a second time. No
errors and no one waits for us because writing is async.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">func&lt;/span> &lt;span style="color:#000">readFrom2&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">tx&lt;/span> &lt;span style="color:#000">plugin&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">TxInfo&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">id&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">val&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#204a87;font-weight:bold">error&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">defer&lt;/span> &lt;span style="color:#000">err2&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Annotate&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;reading cached ledger&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">indyLedger&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">cacheLedger&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">-&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">result&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">readCount&lt;/span> &lt;span style="color:#204a87;font-weight:bold">int&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">ch1&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">asyncRead&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">indyLedger&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">ch2&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">asyncRead&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">cacheLedger&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">loop&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">for&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">select&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">r1&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">ch1&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">exist&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000;font-weight:bold">!&lt;/span>&lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Is&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r1&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">plugin&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ErrNotExist&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">readCount&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">++&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">glog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">V&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">Infof&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;---- %d. winner -1 (exist=%v) ----&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">readCount&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">exist&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">result&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">r1&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">result&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// Currently first plugin is the Indy ledger, if we are
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// here, we must write data to cache ledger
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">readCount&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#000">exist&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">glog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">V&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">Infoln&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;--- update cache plugin:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r1&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">id&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r1&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">result&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">tmpTx&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">tx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">tx&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Update&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">openPlugins&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">cacheLedger&lt;/span>&lt;span style="color:#000;font-weight:bold">].&lt;/span>&lt;span style="color:#000">Write&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">tmpTx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r1&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">result&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">err&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">!=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">glog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Errorln&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;error cache update&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">break&lt;/span> &lt;span style="color:#000">loop&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">case&lt;/span> &lt;span style="color:#000">r2&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">ch2&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">notExist&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Is&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r2&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">err&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">plugin&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ErrNotExist&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">readCount&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">++&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">glog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">V&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">Infof&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;---- %d. winner -2 (notExist=%v, result=%s) ----&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">readCount&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">notExist&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">r2&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">result&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">result&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">r2&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">result&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000">notExist&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">glog&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">V&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#000;font-weight:bold">).&lt;/span>&lt;span style="color:#000">Infoln&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;--- NO CACHE HIT:&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">readCount&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">continue&lt;/span> &lt;span style="color:#000">loop&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">break&lt;/span> &lt;span style="color:#000">loop&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">result&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#204a87;font-weight:bold">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>I hope you at least tried to read the previous function even when you aren&amp;rsquo;t
familiar with Go because that might be the needed trigger point to start to understand
&lt;strong>why Go is such a powerful tool for distributed programming.&lt;/strong> I, who have written
these kinds of algorithms with almost everything which existed before Go, even to
OS, which didn&amp;rsquo;t have threads but only interrupts, has been so happy. Those who
are interested in computer science, please read them
&lt;a href="https://dl.acm.org/doi/10.1145/359576.359585">Hoare&amp;rsquo;s paper of CSP&lt;/a>. Of course,
Go inventors aren&amp;rsquo;t the only ones using the paper since 1978.&lt;/p>
&lt;h2 id="putting-all-together">Putting All Together&lt;/h2>
&lt;p>At the beginning of the document, I had a relatively long list of what&amp;rsquo;s not so
good in Indy SDK, and that was even all. I tried to leave out those things
caused because C-API has put together quite fast, I think. The &lt;code>libindy&lt;/code> is
written in Rust.&lt;/p>
&lt;p>But still, the C-API has hints of namespacing, and luckily I have been following
the namespace structure in our Go wrapper&amp;rsquo;s package structure by the book. So,
we have these Go packages:&lt;/p>
&lt;ul>
&lt;li>&lt;code>did&lt;/code>&lt;/li>
&lt;li>&lt;code>wallet&lt;/code>&lt;/li>
&lt;li>&lt;code>pairwise&lt;/code>&lt;/li>
&lt;li>&lt;code>crypto&lt;/code>&lt;/li>
&lt;li>&lt;code>ledger&lt;/code>&lt;/li>
&lt;li>&lt;code>pool&lt;/code>, this was very important, because it gave as the entry point to
above layer. The layer was using our Go wrapper.&lt;/li>
&lt;/ul>
&lt;p>The following picture illustrates the whole system where the ledger connection &lt;em>pool&lt;/em> is replaced
with our own &lt;code>pool&lt;/code> package.&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="/blog/2022/09/30/ledger-multiplexer/Main.svg"/>
&lt;/figure>
&lt;em>Connection Pool&amp;rsquo;s Relation To Ledger Multiplexer&lt;/em>&lt;/p>
&lt;p>The code using our Go wrapper looks like &lt;strong>the same as it has been
since the beginning.&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// open real Indy ledger named &amp;#34;iop&amp;#34; and also use Memory Cache
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000">r&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;-&lt;/span>&lt;span style="color:#000">pool&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">OpenLedger&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;FINDY_LEDGER,iop,FINDY_MEM_LEDGER,cache&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Err&lt;/span>&lt;span style="color:#000;font-weight:bold">())&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ledger&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WriteSchema&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">pool&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">w1&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">stewardDID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">scJSON&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">sid&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">scJSON&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To2&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ledger&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ReadSchema&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">pool&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">stewardDID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">sid&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>All of this just by following sound software engineering practices like:&lt;/p>
&lt;ul>
&lt;li>abstraction hiding&lt;/li>
&lt;li>polymorphism&lt;/li>
&lt;li>modular structures&lt;/li>
&lt;/ul>
&lt;p>I hope this was helpful. Until the next time, see you!&lt;/p></description></item><item><title>Blog: The Hyperledger Global Forum Experience</title><link>/blog/2022/09/27/the-hyperledger-global-forum-experience/</link><pubDate>Tue, 27 Sep 2022 00:00:00 +0000</pubDate><guid>/blog/2022/09/27/the-hyperledger-global-forum-experience/</guid><description>
&lt;p>Our team started utilizing Hyperledger technologies in 2019 when we began the experimentation with
decentralized identity. Since then, we have implemented &lt;a href="https://findy-network.github.io/">our identity agency&lt;/a>
with the help of two &lt;a href="https://www.hyperledger.org/">Hyperledger Foundation&lt;/a> projects:
Hyperledger Indy for implementing the low-level credential
handling and Hyperledger Aries for the agent communication protocols specification.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 704px">
&lt;img class="card-img-top" src="/blog/2022/09/27/the-hyperledger-global-forum-experience/cover-venue_hu1081c9d54cfbf568dde7ee06be338042_1479096_925x925_fit_q75_catmullrom.jpg" width="694" height="925">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The Dublin Convention Centre hosted the Global Forum. At the same time,
the Open Source summit also took place at the same venue.
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>We released our work as open-source in 2021. When the pandemic restrictions finally eased in 2022,
we thought the Hyperledger Forum would be an excellent chance to meet fellow agent authors and
present our work to an interested audience. Luckily, the program committee chose &lt;a href="https://hgf22.sched.com/event/14H5g/findy-agency-highway-to-verified-data-networks-laura-vuorenoja-harri-lainio-op-financial-group">our presentation&lt;/a>
among many candidates, so it was time to head for Ireland.&lt;/p>
&lt;p>The three-day event consisted of two days of presentations and demos and one workshop day where
the participants had a chance to get their hands dirty with the actual technologies.
When over 600 participants and 100 speakers gather together, there is also an excellent
chance to meet old friends and make new ones.&lt;/p>
&lt;h2 id="presenting-findy-agency">Presenting Findy Agency&lt;/h2>
&lt;p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/dlWWMeiSUfE" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;em>Our presentation is available on YouTube.&lt;/em>&lt;/p>
&lt;p>We had the opportunity to present our project’s achievements on the second day of the conference,
Tuesday, 13th September. Our overall Hyperleger-timing was perfect because the other SSI agent
builders had comforted the issues we had already solved. And for that reason, for example,
our ledger-less running mode got lots of attention.&lt;/p>
&lt;p>We had a little luck that the feature stayed in the slides. Previous conversations with Hyperledger
Aries&amp;rsquo;s core team had not raised any interest in the subject. Now they had an idea that &lt;a href="https://anoncreds-wg.github.io/anoncreds-spec/">AnonCreds&lt;/a>
(Hyperledger Indy verified credentials) could stay in version 1.0 format, but VDR
(&lt;a href="https://www.w3.org/TR/did-core/#dfn-verifiable-data-registry">verified data registry&lt;/a>,
ledger in most of the DID methods) could be something else in &lt;a href="https://github.com/hyperledger/indy-sdk">Indy SDK&lt;/a>.&lt;/p>
&lt;p>Our ledger multiplexer solves the same issue. It makes it possible to use Indy SDK with whatever
VDR, or even multiple VDRs if necessary, for example, the second one as a cache.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2022/09/27/the-hyperledger-global-forum-experience/presentation_hu26f4f2d0818e044d35ce2229286cef7b_1058067_925x925_fit_q75_catmullrom.jpg" width="925" height="617">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>We had lots of questions in the Q&amp;A section. (Photo by the Linux Foundation)&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Summary of the rest of the QA section of the talk:&lt;/p>
&lt;ul>
&lt;li>There was a question about the business cases we have thought about or are keeping potential.
Everybody seemed eager to find good use cases that could be referenced for their own use.
Many sources confirmed that we should first solve something internal. Something that we can decide
everything by ourselves. As a large enterprise, that would still give us
a tremendous competitive advantage.&lt;/li>
&lt;li>Questions about how our solution differs from systems based on DIDComm routing, i.e., you must
have multiple agents like a relay, a mediator (cloud agent), and an edge agent.
We explained that you wouldn’t lose anything but get a much simpler system.
There were questions about wallet export and import, which both we have implemented and tested.&lt;/li>
&lt;li>There were multiple reasonable questions about where DIDComm starts in our solution and where
it’s used. Because our wallet app doesn’t use (anymore) DIDComm, e.g., for edge agent onboarding,
it wasn’t easy to get your head around the idea that we integrated all the agent types into one
identity domain agent (the term we used in the talk). Our web wallet was a UI extension of it.&lt;/li>
&lt;li>Luckily, we had some extra time because there was a break after our talk.
We could answer all the questions. We can say that we had an excellent discussion
at the end of the presentation.&lt;/li>
&lt;/ul>
&lt;p>The organizer recorded our talk and it is published on &lt;a href="https://www.youtube.com/watch?v=dlWWMeiSUfE">YouTube&lt;/a>.&lt;/p>
&lt;blockquote class="twitter-tweet">&lt;p lang="en" dir="ltr">As shown in the Findy Agency demo at &lt;a href="https://twitter.com/hashtag/HyperledgerForum?src=hash&amp;amp;ref_src=twsrc%5Etfw">#HyperledgerForum&lt;/a>, using FIDO2 to authenticate to a web wallet is a great way to keep access to an online web wallet passwordless. &lt;a href="https://t.co/GGuHnecnI7">pic.twitter.com/GGuHnecnI7&lt;/a>&lt;/p>&amp;mdash; Animo (@AnimoSolutions) &lt;a href="https://twitter.com/AnimoSolutions/status/1569648888415670275?ref_src=twsrc%5Etfw">September 13, 2022&lt;/a>&lt;/blockquote> &lt;script async src="https://platform.twitter.com/widgets.js" charset="utf-8">&lt;/script>
&lt;h2 id="the-technical-demos">The Technical Demos&lt;/h2>
&lt;p>In addition to keeping our presentation, our goal was to participate in the sessions handling
self-sovereign identity and verifiable data. There would have been exciting sessions covering,
e.g., the Hyperledger Fabric project. However, unfortunately, many of the sessions were overlapping,
so one needed to cherry-pick the most interesting ones, naturally keeping our
focus on the technical track.&lt;/p>
&lt;p>&lt;a href="https://github.com/hyperledger/aries-mobile-agent-react-native">Aries Bifold&lt;/a> project is
a relatively new acquaintance in the Aries community. It is a long-awaited open-source mobile
agent application built on react-native. The community was long missing an open-source solution
for edge agents running on mobile devices, and they had to use proprietary solutions for this purpose.
Aries Bifold tries to fill this gap and provide an easily customizable, production-ready wallet application.&lt;/p>
&lt;p>In the Aries Bifold demo, we saw two wallet applications receiving and proving credentials,
one being the basic version of the app and another with customization, &lt;a href="https://www2.gov.bc.ca/gov/content/governments/government-id/bc-wallet">the BC Wallet application&lt;/a>.
The BC Wallet is a digital wallet application developed by the Government of British Columbia
in Canada and is even publicly available in application stores.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 540px">
&lt;img class="card-img-top" src="/blog/2022/09/27/the-hyperledger-global-forum-experience/bc-wallet_hu09865812cc8c5b1905185ca687285979_95917_925x925_fit_q75_catmullrom.jpg" width="530" height="925">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The BC Wallet application is available in the application stores.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Another open-source demo was about building controllers for ACAPy. ACAPy intends to provide services
for applications (controllers) that aim to utilize Aries credential flows in their logic.
In the demo, we saw how the ACAPy controllers could handle their agent hosted by ACAPy using
the ACAPy REST API. However, this demo was a bit disappointing as it did not show us anything
we hadn&amp;rsquo;t seen before.&lt;/p>
&lt;h2 id="decentralized-identity-is-ready-for-adoption-now">”Decentralized Identity Is Ready for Adoption Now”&lt;/h2>
&lt;p>One of the most exciting keynotes was a panel talk with four SSI legends, Drummond Reed,
Heather Dahl, Mary Wallace, and Kaliya Young. Their clear message was that we are now done
with the mere planning phase and should boldly move to execution and implement real-world
use cases with the technology. Also, the panelists raised the public sector to the conversation.
The point was that the public sector should act as an example and be the pioneer in using the technology.&lt;/p>
&lt;p>Some public sector organizations have already listened to this message as we heard about exciting
pilot projects happening in the Americas. The state of North Dakota is issuing a verifiable
credential to each graduating senior, and potential employers and universities can then verify
these credentials. The city of San Francisco uses verified credentials to replace legacy
authentication mechanisms in over 100 public sites. The change effectively means that users
must remember 100 fewer passwords, significantly improving the user experience.
Furthermore, &lt;a href="https://www.aruba.com/us/traveler-health-requirements/commonpass">the Aruba Health Pass&lt;/a>
allows Aruba travelers to enter the island using
the digital health pass. Hyperledger Indy and Aries technologies empower all of the abovementioned cases.&lt;/p>
&lt;h2 id="workshopping">Workshopping&lt;/h2>
&lt;p>The last day of the conference was about workshopping. We joined the workshop intended
for building SSI agents with &lt;a href="https://github.com/hyperledger/aries-framework-javascript">the Aries JavaScript framework&lt;/a>.
The framework approach for building the agent functionality differs from the approach
we use with our agency: the framework makes building an agent more effortless compared to
starting from scratch, but one still needs to host the agent themselves.
In the agency way, agency software runs and hosts the agent even though the client application
would be offline.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2022/09/27/the-hyperledger-global-forum-experience/workshop_hu57e824dd752ff6ada135420358affa73_990223_925x925_fit_q75_catmullrom.jpg" width="925" height="694">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Timo Glastra from Animo was one of the workshop hosts.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The workshop&amp;rsquo;s purpose was to set up a web service for issuing and verifying credentials
and a mobile application for storing and proving the credentials. Both projects,
the Node.js and the React Native applications, used the Aries JavaScript Framework
to implement the agent functionality under the hood. The organizers provided
templates – all the participants needed to do was fill out the missing parts.&lt;/p>
&lt;p>The organizers arranged the workshop quite nicely, and after we solved the first hiccups
related to the building with Docker in ARM architecture, it was pretty easy to get going with
the development – at least for experienced SSI developers like us.
The session showed again how important these hands-on events are, as there was
a lot of valuable technical discussion going on the whole day.&lt;/p>
&lt;h2 id="the-most-important-takeaways">The Most Important Takeaways&lt;/h2>
&lt;p>&lt;strong>The technology is not mature, but we should still go full speed ahead.&lt;/strong>&lt;/p>
&lt;p>&lt;a href="https://identitywoman.net/being-real-about-hyperledger-indy-aries-anoncreds/">Kaliya Young&amp;rsquo;s blog post&lt;/a>
listing the challenges in the Hyperledger Indy and Aries technologies shook
the Hyperledger SSI community just a week before the conference started. The article was
a needed wake-up call to make the community start discussing that much work is still required
before the technology is ready for the masses.&lt;/p>
&lt;p>It is essential to take into account these deficiencies of the technology. Still, it shouldn&amp;rsquo;t stop
us from concentrating on the most complicated problems: figuring out the best user experience
and how to construct the integrations to the legacy systems. To get started with the pilot projects,
we should take conscious technical debt regarding the underlying credential technology and rely on
the expert community to figure it out eventually. This approach is possible when we use products
such as Findy Agency that hide the underlying technical details from client applications.&lt;/p>
&lt;p>&lt;strong>Creating a first-class SSI developer experience is challenging.&lt;/strong>&lt;/p>
&lt;p>There are many participants in a credential utilizing application flow. Quite often end-user is using
some digital wallet on her mobile device to receive and prove credentials. There might be running
a dedicated (web) application both for issuing and verifying. And, of course, a shared ledger is
required where the different participants can find the needed public information
for issuing and verifying credentials.&lt;/p>
&lt;p>Sounds like a complex environment to set up on one&amp;rsquo;s local computer? Making these three
applications talk with each other and access the shared ledger might be an overwhelming
task for a newcomer, not to mention grasping the theory behind SSI. However, getting
developers quickly onboard is essential when more and more developers start working with SSI.
We think we have successfully reduced the complexity level in the Findy Agency project,
which positively impacts the developer experience.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 704px">
&lt;img class="card-img-top" src="/blog/2022/09/27/the-hyperledger-global-forum-experience/interaction_hu5176f79cdb1ddf9169d247ac61c6193d_1175461_925x925_fit_q75_catmullrom.jpg" width="694" height="925">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The post-pandemic era with interaction buttons.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>&lt;strong>There&amp;rsquo;s no substitute for live events and meeting people f2f.&lt;/strong>&lt;/p>
&lt;p>The event proved that live interaction between people is often more efficient and
creative than many hours of online working and countless remote meetings. Meeting people
in informal discussions is sometimes needed for new ideas to be born.
Also, the change of knowledge is so much more efficient. For example, we have had
the ledgerless run mode in our agency for several years, but only now did our
fellow agent developers realize it, and they may utilize this finding as well.&lt;/p></description></item><item><title>Blog: The Findy Agency API</title><link>/blog/2022/08/29/the-findy-agency-api/</link><pubDate>Mon, 29 Aug 2022 00:00:00 +0000</pubDate><guid>/blog/2022/08/29/the-findy-agency-api/</guid><description>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 835px">
&lt;img class="card-img-top" src="/blog/2022/08/29/the-findy-agency-api/cover-agency-arch_hu69392f6fa2d36b75ea1764737da82802_153511_825x825_fit_catmullrom_3.png" width="825" height="451">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The gRPC API serves the client applications.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The Findy Agency clients can control their agents through the Findy Agency API
over &lt;a href="https://grpc.io/">the high-performing gRPC protocol&lt;/a>.
The API design results from iterative planning and multiple development cycles.
Initially, we implemented it using a custom protocol that utilized
JSON structures and DIDComm as the transport mechanism.
The initial design seemed like a good plan, as we got the chance to test the exact DIDComm implementation
we were using to send the agent-2-agent messages (used in the credential exchange flows).&lt;/p>
&lt;p>However, as we gained more experience using the API and the agent-2-agent protocol evolved as
&lt;a href="https://www.hyperledger.org/blog/2019/05/14/announcing-hyperledger-aries-infrastructure-supporting-interoperable-identity-solutions">the community introduced Hyperledger Aries&lt;/a>, we realized our API was too laborious, clumsy,
and inefficient for modern applications.&lt;/p>
&lt;p>One option would have been switching our API implementation to traditional REST over HTTP1.1.
&lt;strong>However, we wanted something better&lt;/strong>. We were tired of JSON parsing and wanted a better-performing
solution than REST. We also wanted to be able to use the API using multiple different
languages with ease. &lt;strong>The obvious choice was gRPC&lt;/strong>, which provided us with protocol buffer messaging
format, HTTP2-protocol performance gains, and tooling suitable for the polyglot, i.e., multilingual environment.&lt;/p>
&lt;p>The technology choice was even better than we expected. Given that we have an agency installation available
in the cloud, we can listen to agent events through the gRPC stream without setting up external endpoints
using tools such as ngrok. Thus, gRPC &lt;strong>streaming capabilities have&lt;/strong> considerably &lt;strong>simplified&lt;/strong> client application
&lt;strong>development in a localhost environment&lt;/strong>. Also, the logic of how gRPC handles errors out-of-the-box have helped
us trace the development time problems efficiently.&lt;/p>
&lt;h2 id="the-api-contract">The API Contract&lt;/h2>
&lt;p>Our API contract defined with proto files resides in a separate repository, &lt;a href="https://github.com/findy-network/findy-agent-api">findy-agent-api&lt;/a>.
Using the gRPC tooling, one can take these proto files and compile them to several target languages,
which enables the use of API structures directly from the target implementation.&lt;/p>
&lt;p>A brief example is displayed below.
&lt;a href="https://github.com/findy-network/findy-agent-api/blob/master/idl/v1/agent.proto#L54">We define the structures and an RPC call&lt;/a> for schema creation in protobuf language:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-protobuf" data-lang="protobuf">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">// SchemaCreate is structure for schema creation.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">message&lt;/span> &lt;span style="color:#000">SchemaCreate&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span> &lt;span style="color:#000">name&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// name is the name of the schema.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span> &lt;span style="color:#000">version&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// version is the schema version.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">repeated&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span> &lt;span style="color:#000">attributes&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// attributes is JSON array string.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">&lt;/span>&lt;span style="color:#8f5902;font-style:italic">// Schema is structure to transport schema ID.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">message&lt;/span> &lt;span style="color:#000">Schema&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">string&lt;/span> &lt;span style="color:#000">ID&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// ID is a schema ID.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">&lt;/span>&lt;span style="color:#8f5902;font-style:italic">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">AgentService is to communicate with your cloud agent. With the cloud agent
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">you can Listen your agent&amp;#39;s status, create invitations, manage its running environment,
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">and create schemas and credential definitions.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"> */&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">service&lt;/span> &lt;span style="color:#000">AgentService&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// CreateSchema creates a new schema and writes it to ledger.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">rpc&lt;/span> &lt;span style="color:#000">CreateSchema&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">SchemaCreate&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#204a87;font-weight:bold">returns&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">Schema&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{}&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">...&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a40000">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#a40000">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The protobuf code is compiled to target languages using gRPC tooling, and after that
the structures can be used natively from the application code.&lt;/p>
&lt;p>&lt;a href="https://github.com/findy-network/findy-agent-cli/blob/0dbee240e5cd5693ac818f2cacd0ce86987a950c/cmd/agent/createschema.go#L47">Go example&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">agent&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">NewAgentServiceClient&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">conn&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">r&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:=&lt;/span> &lt;span style="color:#000">try&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">To1&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">agent&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">CreateSchema&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">ctx&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">agency&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SchemaCreate&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">name&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Version&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">version&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">Attributes&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">attrs&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">fmt&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Println&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">r&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ID&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// plain output for pipes
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://github.com/findy-network/findy-issuer-tool/blob/master/api/src/agent/index.js#L40">Typescript example&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ts" data-lang="ts">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">log&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">`Creating schema &lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">JSON&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">stringify&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">body&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">`&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">msg&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">new&lt;/span> &lt;span style="color:#000">agencyv1&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">SchemaCreate&lt;/span>&lt;span style="color:#000;font-weight:bold">();&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">msg&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">setName&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">body&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">name&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">msg&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">setVersion&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">body&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">version&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">body&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">attrs&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">map&lt;/span>&lt;span style="color:#000;font-weight:bold">((&lt;/span>&lt;span style="color:#000">item&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&amp;gt;&lt;/span> &lt;span style="color:#000">msg&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">addAttributes&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">item&lt;/span>&lt;span style="color:#000;font-weight:bold">));&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">res&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#204a87;font-weight:bold">await&lt;/span> &lt;span style="color:#000">agentClient&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">createSchema&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">msg&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">schemaId&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">res&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">getId&lt;/span>&lt;span style="color:#000;font-weight:bold">();&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">log&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">info&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">`Schema created with id &lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">schemaId&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">`&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The examples show that the code is simple and readable compared
to making HTTP requests to arbitrary addresses and JSON manipulation.
The code generated from the proto-files guides
the programmer in the correct direction, and there are no obscurities about which kind of structures
the API takes in or spits out.&lt;/p>
&lt;h2 id="helpers-and-samples">Helpers and Samples&lt;/h2>
&lt;p>We have developed two helper libraries that contain some common functionalities needed for building API client applications.
One is for our favorite language Go (&lt;a href="https://github.com/findy-network/findy-common-go">findy-common-go&lt;/a>),
and the other is for Typescript (&lt;a href="https://github.com/findy-network/findy-common-ts">findy-common-ts&lt;/a>) to demonstrate the API usage for one of
the most popular web development languages.&lt;/p>
&lt;p>These helper libraries make building a Findy Agency
client application even more straightforward. They contain&lt;/p>
&lt;ul>
&lt;li>the ready-built proto-code,&lt;/li>
&lt;li>functionality for opening and closing the connection and streaming the data,&lt;/li>
&lt;li>utilities for client authentication, and&lt;/li>
&lt;li>further abstractions on top of the API interface.&lt;/li>
&lt;/ul>
&lt;p>There already exist two excellent example client applications that utilize these helper libraries.
In addition to being examples of using the API, they are handy tools for accessing and testing
the agency functionality.&lt;/p>
&lt;p>Our &lt;a href="https://github.com/findy-network/findy-agent-cli">CLI tool&lt;/a> provides agent manipulation functionality through a command-line interface.
It uses the agency API internally through the Go helper.&lt;/p>
&lt;figure>
&lt;img src="https://github.com/findy-network/findy-wallet-pwa/raw/dev/tools/env/docs/env-04.gif" width="925"/>
&lt;/figure>
&lt;p>&lt;em>Example above shows how it is possible to use the CLI tool for chatting with web wallet user.&lt;/em>&lt;/p>
&lt;p>&lt;a href="https://github.com/findy-network/findy-issuer-tool">The issuer tool&lt;/a> is a sample web service with a simple UI
that can issue and verify credentials using the issuer tool&amp;rsquo;s cloud agent.
It is written in Javascript and utilizes the Typescript helper.&lt;/p>
&lt;figure>
&lt;img src="https://github.com/findy-network/findy-issuer-tool/raw/master/docs/usage-04.gif" width="925"/>
&lt;/figure>
&lt;p>&lt;em>Issuer tool provides functionality for testing different Aries protocols.&lt;/em>&lt;/p>
&lt;p>One is not limited to using these two languages, as using the API from any language with
gRPC tooling support is possible. Stay tuned for my next post that describes our latest experiment
with Kotlin.&lt;/p></description></item><item><title>Blog: Trust in Your Wallet</title><link>/blog/2022/04/27/trust-in-your-wallet/</link><pubDate>Wed, 27 Apr 2022 00:00:00 +0000</pubDate><guid>/blog/2022/04/27/trust-in-your-wallet/</guid><description>
&lt;p>&lt;a href="/blog/2022/04/07/ssi-empowered-identity-provider/">Our previous post&lt;/a> showed how to speed up
the leap to the SSI world for existing OIDC clients, i.e., web services using external identity
providers for their user authentication. Our demonstrated concept enabled users to log in to
web services using credentials from their identity wallet.&lt;/p>
&lt;p>We used an FTN credential in &lt;a href="https://youtu.be/V5FWX0g3HVk">the demo&lt;/a>. After reading the post and
seeing the demo, you may have wondered what this FTN credential is? Where did the user get it?
And how the web service can trust this mysterious credential? This post will concentrate
on these questions.&lt;/p>
&lt;h2 id="the-cryptographic-magic">The Cryptographic Magic&lt;/h2>
&lt;p>The core concept of self-sovereign identity is verified data. The idea is that entities can hold
cryptographically signed data (aka credentials) in their digital identity wallets. They can produce
proof of this data and hand it over to other parties for verification.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2022/04/27/trust-in-your-wallet/triangle_hu10873f40dea6a8d6fde4ec70a9b2b7db_203065_925x925_fit_catmullrom_3.png" width="925" height="513">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The trust triangle describes the roles of the data verification scenario.
Verifier utilizes cryptography to verify the proof that the holder provides.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The cryptographic magic during the verification allows the verifier to be sure of two aspects.
Firstly, the issuer was the one who issued the credential, and secondly, the issuer issued
it to the prover&amp;rsquo;s wallet (and no one else&amp;rsquo;s). The verifier must know the issuer&amp;rsquo;s
public key for this magic to happen.&lt;/p>
&lt;p>We showcased the cryptographic verification in the demo mentioned above. When logging in to
the sample web service, instead of providing the user name and password, the user made proof of
his credential and handed it over to the identity provider. The identity provider then verified the proof
cryptographically and read and provided the needed data to the sample service (OIDC client application).&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2022/04/27/trust-in-your-wallet/idp_hu7c7bccbf80a443065b433183313da6ac_215387_925x925_fit_catmullrom_3.png" width="925" height="511">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>OIDC demo actors in the trust triangle. The user creates proof of his FTN credential for
the identity provider's verification.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="who-to-trust">Who to Trust?&lt;/h2>
&lt;p>So cryptography gets our back regarding the authenticity of the data and its origin. But how can we
trust the issuer, the entity that created the credential initially?&lt;/p>
&lt;figure>
&lt;img src="https://i.imgflip.com/2ab5u1.jpg" width="800px"/>
&lt;/figure>
&lt;p>The answer to this question is no different from the present situation regarding dealing with third
parties. &lt;em>We choose to trust the issuer.&lt;/em>&lt;/p>
&lt;p>For example, consider the current OIDC flow, where identity providers deliver data from their silos
to the client applications (relaying parties). The client application implementers consciously
decide to trust that the IdP (identity provider) runs their server in a documented URL and
provides them with correct data in the OIDC protocol flows. They may have secrets and keys
to keep the OIDC data exchange secure and private, but ultimately, the decision to trust
the OIDC provider is part of the application design.&lt;/p>
&lt;p>In the SSI scenario, we choose to trust the issuer similarly, only we are not aware of the issuer&amp;rsquo;s
servers but their public key for signing the credential. In our OIDC login demo,
the client application (&amp;ldquo;issuer-tool&amp;rdquo;) has decided to trust the &amp;ldquo;FTN service&amp;rdquo; that has issued
the data to the user&amp;rsquo;s wallet.&lt;/p>
&lt;h2 id="finnish-trust-network">Finnish Trust Network&lt;/h2>
&lt;p>&lt;a href="https://www.kyberturvallisuuskeskus.fi/en/our-activities/regulation-and-supervision/electronic-identification">Finnish Trust Network&lt;/a>
(FTN) consists of &amp;ldquo;strong electronic identification&amp;rdquo; providers. The concept
means proving one&amp;rsquo;s identity in electronic services that meets specific requirements laid down
by Finnish law. The identity providers are required to implement multi-factor authentication
to authenticate the users. The result data of the authentication process typically contains
the user&amp;rsquo;s name and personal identification code.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 952px">
&lt;img class="card-img-top" src="/blog/2022/04/27/trust-in-your-wallet/identity-service-broker-view_hu92eff1541b0faa9532b79dff259ec600_56678_1025x1025_fit_catmullrom_3.png" width="942" height="423">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>
In the FTN flow, users usually authenticate using their bank ID.
Before the users start the authentication,
they select the identity provider in the identity service broker view.
&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>FTN is an exciting playground for us as it is so essential part of the digital processes
of Finnish society. Integrating FTN in one way or another into the SSI wallet seems like a natural
next step for us when thinking about how to utilize verified data large scale in Finland.&lt;/p>
&lt;p>Even though regulation may initially prohibit using SSI wallets as a
“strong electronic identification” method, the FTN credential could be part of onboarding wallet
users or provide additional security to services that currently use weak authentication.
&lt;a href="https://www.w3.org/TR/vc-data-model/#dfn-selective-disclosure">The selective disclosure&lt;/a> feature
would allow users to share only the needed data, e.g., age or name, without revealing sensitive
personal identification code information.&lt;/p>
&lt;p>We decided to experiment with the FTN and create a PoC for a service (“FTN service”) that can issue
credentials through an FTN authentication integration. And as it happened, we met our old friend
OIDC protocol again.&lt;/p>
&lt;h2 id="the-demo">The Demo&lt;/h2>
&lt;p>The idea of the PoC FTN service is to authenticate users through FTN and issue a credential for
the received FTN data. The PoC integrates an &lt;a href="https://github.com/op-developer/Identity-Service-Broker-API">identity broker test service&lt;/a>
with dummy data that enables us to test out the actual authentication flow.&lt;/p>
&lt;p>The process starts with the user reading the FTN service connection invitation QR code with his SSI wallet.
After the connection is ready, the interaction with the FTN service and the user happens
in the mobile device browser. FTN service instructs the user to authenticate with
his bank credentials. After successful authentication, the FTN service receives
the user information and issues a credential for the data.&lt;/p>
&lt;p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/7b4tKnSndxk" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;em>The demo video shows how the technical PoC works.
The user receives the FTN credential by authenticating himself with bank credentials.&lt;/em>&lt;/p>
&lt;p>Our previous OIDC demo provided data from the credentials through the OIDC protocol.
In this FTN issuer demo, we utilized the OIDC protocol again but now used it &lt;em>as
the credential data source&lt;/em>. Once the user has acquired the FTN credential to his wallet,
he can prove facts about himself without reauthenticating with his bank credentials.&lt;/p>
&lt;h3 id="the-sequence-flow">The Sequence Flow&lt;/h3>
&lt;p>The entire process sequence is below in detail:&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="/blog/2022/04/27/trust-in-your-wallet/sequence.svg"/>
&lt;/figure>
&lt;em>&lt;a href="https://github.com/findy-network/findy-issuer-tool/blob/master/api/README.md#ftn-credential-flow">Step-by-step sequence for the issuing process&lt;/a>&lt;/em>&lt;/p>
&lt;h2 id="food-for-thought-self-service-issuers">Food for Thought: Self-Service Issuers&lt;/h2>
&lt;p>In the SSI dream world of the future, each organization would have the capabilities to issue
credentials for the data they possess. Individuals could store these credentials in their wallets
and use them how they see fit in other services. Verified data would enable many use cases that
are cumbersome or even manual today. Only in the financial sector the possibilities to improve
various processes (for example, AML, KYC, or GDPR) are countless.&lt;/p>
&lt;p>However, our pragmatic team realizes that this future may be distant, as the adoption of SSI
technologies seems to be still slow. The presented experimentation led us to consider another
shortcut to the SSI world. What if we could create similar services as the PoC FTN service
to speed up the adoption? These “issuer self-services” would utilize existing API interfaces
(such as OIDC) and issue credentials to users.&lt;/p>
&lt;p>And at the same time, we could utilize another significant benefit of verified data technology:
&lt;em>reducing the count of integrations between systems&lt;/em>.&lt;/p>
&lt;p>Once we have the data available in the user’s wallet, we do not need to fetch it from online servers
and integrate services with countless APIs. Instead, the required data is directly available in
the digital wallets of different process actors using a standard protocol for verified data exchange,
Hyperledger Aries.&lt;/p>
&lt;p>Also, from the application developer’s point of view, the count of integrations reduces only to one
point—and for that, the SSI agent provides the needed functionality.&lt;/p>
&lt;h2 id="try-it-out">Try It Out&lt;/h2>
&lt;p>The codes are available on GitHub. You can set up the demo on your localhost by launching
&lt;a href="https://github.com/findy-network/findy-wallet-pwa/tree/dev/tools/env#agency-setup-for-local-development">the agency&lt;/a>
and &lt;a href="https://github.com/findy-network/findy-issuer-tool">the issuer service&lt;/a>.
Once you have the services running, you can access the web wallet opening browser at &lt;code>http://localhost:3000&lt;/code>
and the FTN service at &lt;code>http://localhost:8081&lt;/code>.&lt;/p>
&lt;p>If you have any questions about these demos or Findy Agency, you can contact our team and me
via &lt;a href="https://github.com/findy-network">GitHub&lt;/a>, &lt;a href="https://www.linkedin.com/in/lauravuorenoja/">LinkedIn&lt;/a>,
or &lt;a href="https://twitter.com/vuorenoja">Twitter&lt;/a>. You can also find me in
&lt;a href="https://discord.gg/hyperledger">Hyperledger Discord&lt;/a>.&lt;/p></description></item><item><title>Blog: SSI-Empowered Identity Provider</title><link>/blog/2022/04/07/ssi-empowered-identity-provider/</link><pubDate>Thu, 07 Apr 2022 00:00:00 +0000</pubDate><guid>/blog/2022/04/07/ssi-empowered-identity-provider/</guid><description>
&lt;p>Utilizing SSI wallets and verifiable credentials in OIDC authentication flows has been an
interesting research topic for &lt;a href="https://findy-network.github.io">our team&lt;/a> already for a while now.
As said, &lt;a href="https://openid.net/connect/">the OIDC protocol&lt;/a> is popular. Countless web services sign
their users in using OIDC identity providers. And indeed, it provides many benefits, as it
simplifies the authentication for service developers and end-users. The developers do not have
to reinvent the authentication wheel and worry about storing username/password information.
The users do not have to maintain countless digital identities with several different passwords.&lt;/p>
&lt;figure>
&lt;img src="https://pbs.twimg.com/media/FA_yO0jUcAM2fMa.jpg" width="500px"/> &lt;figcaption>
&lt;p>
&lt;a href="https://indieweb.org/NASCAR_problem">&lt;small>Example of login page with support for multiple identity providers.&lt;br/> Image source: IndieWeb NASCAR Problem&lt;/small>&lt;/a>&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>However, &lt;a href="https://medium.com/mattr-global/if-you-build-an-island-youll-need-a-boat-537f48525edc">the protocol is not flawless&lt;/a>,
and it seems evident that using verified data would fix many of the known weaknesses.&lt;/p>
&lt;p>&lt;strong>Our most significant concerns for current OIDC protocol practices are related to privacy.&lt;/strong>&lt;/p>
&lt;p>Let&amp;rsquo;s suppose that our imaginary friend Alice uses an application, say a dating service,
that provides a Facebook login button for its users. Each time Alice logs in, Facebook becomes
aware that Alice uses the dating service. Depending on the service authentication model, i.e., how
often the service requires users to reauthenticate, it can also
learn a great deal at which time and how often Alice is using the service.&lt;/p>
&lt;p>Alice probably didn&amp;rsquo;t want to share this data with Facebook and did this
unintentionally. Even worse, Alice probably uses a similar login approach with other applications.
Little by little, Facebook learns about which applications Alice is using
and how often. Moreover, as applications usually provide a limited amount of login options,
most users choose the biggest identity providers such as Facebook and Google.
The big players end up collecting an enormous amount of data over users.&lt;/p>
&lt;h2 id="how-would-ssi-and-verified-data-change-the-scenario">How Would SSI and Verified Data Change the Scenario?&lt;/h2>
&lt;p>In the traditional OIDC flow, identity providers hold the sensitive end-user data and personally
identifiable information. Yet, this is not the case with the SSI model, where the user owns
her data and stores it in her digital wallet as verifiable credentials. In the SSI-enabled
authentication process, instead of typing username and password to the identity provider login
form, &lt;em>the user presents verifiable proof of the needed data&lt;/em>. No third parties are necessary for
the login to take place.&lt;/p>
&lt;p>Furthermore, the transparent proof presentation process lets the user know which data fields
the application sees. In the traditional flow, even though the service usually asks if the user
wishes to share her profile information, the data is transferred server-to-server invisibly.
The level of transparency depends on the identity provider’s goodwill and service design quality.
In the proof presentation, the wallet user sees in detail which attributes she shares with the application.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 635px">
&lt;img class="card-img-top" src="/blog/2022/04/07/ssi-empowered-identity-provider/attributes_hu577c77636a56cb15542063a613041bde_197358_625x625_fit_catmullrom_3.png" width="625" height="436">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>In the proof presentation, the wallet user sees in detail which attributes she shares with the application.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The verifiable credentials technology would even allow computations on the user data without
revealing it. For example, if we assume that Alice has a credential about her birthdate
in her wallet, she could prove that she is over 18 without exposing her birthdate when registering
to the dating service.&lt;/p>
&lt;h2 id="midway-solution-for-speeding-up-adoption">Midway Solution for Speeding up Adoption&lt;/h2>
&lt;p>The ideal SSI-enabled OIDC login process wouldn&amp;rsquo;t have any identity provider role, or actually,
the user would be the identity provider herself. The current identity provider (or any other service
holding the needed identity data) would issue the credential to the user’s wallet before any logins.
After the issuance, the user could use the data directly with the client applications
as she wishes without the original issuer knowing it.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2022/04/07/ssi-empowered-identity-provider/cover.shift.drawio_hu78bea64891b44cd1059188eeedccda7e_263949_925x925_fit_catmullrom_3.png" width="925" height="456">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>In SSI-Enabled OIDC login flow there is no need for traditional identity provider
with user data silos.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The OIDC extension
&lt;a href="https://openid.net/specs/openid-connect-self-issued-v2-1_0.html">SIOP (Self-Issued OpenID Provider)&lt;/a>
tries to reach this ambitious goal. The specification defines how the client applications can verify
users&amp;rsquo; credential data through the renewed OIDC protocol. Unfortunately, implementing SIOP would require
considerable changes to existing OIDC client applications.&lt;/p>
&lt;p>As adapting these changes to OIDC client applications is undoubtedly slow, we think a midway
solution not requiring too many changes to the OIDC clients would be ideal for speeding up
the SSI adoption. The identity provider would work as an SSI proxy in this solution, utilizing
SSI agent capabilities. Instead of storing the sensitive user data in its database, the provider
would verify the user&amp;rsquo;s credential data and deliver it to the client applications using the same
API interfaces as traditional OIDC.&lt;/p>
&lt;h2 id="findy-agency-under-test">Findy Agency under Test&lt;/h2>
&lt;p>In the summer of 2020, our team did some initial proofs-of-concept around this subject.
The experiments were successful, but our technology stack
&lt;a href="https://findy-network.github.io/blog/2021/08/11/announcing-findy-agency/">has matured&lt;/a> since then.
We decided to rewrite the experiments on top of our latest stack and take a closer look at this topic.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 835px">
&lt;img class="card-img-top" src="/blog/2022/04/07/ssi-empowered-identity-provider/overview.drawio_hu9ec8414f57daa6762ef8cf1942977f73_180118_825x825_fit_catmullrom_3.png" width="825" height="427">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Overview of the midway solution process participants&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Other teams have created &lt;a href="https://github.com/bcgov/vc-authn-oidc/blob/main/docs/README.md">similar demos&lt;/a>
in the past but using different SSI technology stacks. Our target was to test our
&lt;a href="https://github.com/findy-network/findy-agent-api">Findy Agency gRPC API&lt;/a> hands-on. Also, our
web wallet&amp;rsquo;s user experience is somewhat different from other SSI wallets. The web wallet
can be used securely with the browser without installing mobile applications. Furthermore,
the core concept of our wallet app is the chat feature, which is almost missing altogether from
other SSI wallet applications. We think that the chat feature has an essential role in creating
an excellent user experience for SSI wallet users.&lt;/p>
&lt;h2 id="demo">Demo&lt;/h2>
&lt;p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/V5FWX0g3HVk" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;em>The demo video shows how the technical PoC works on localhost setup.
The user logs in to a protected service using the web wallet.&lt;/em>&lt;/p>
&lt;p>The basic setup for the demo is familiar to OIDC utilizers. The end-user uses a browser
on the laptop and wishes to log in to a protected web service. The protected sample service
for this demo playing the OIDC client role is called
the &lt;a href="https://github.com/findy-network/findy-issuer-tool">&amp;ldquo;issuer tool&amp;rdquo;&lt;/a>. The service has configured
&lt;a href="https://github.com/findy-network/findy-oidc-provider">an SSI-enabled identity provider&lt;/a>
as a login method. It displays the button “Login via credential” on its login page.
The service redirects the user to the identity provider login page with a button click.&lt;/p>
&lt;p>Then the flow changes from the usual OIDC routine. Before the login, the user has already acquired
the needed data (an FTN - Finnish Trust Network credential) in her SSI wallet. She uses her
&lt;a href="https://github.com/findy-network/findy-wallet-pwa">web wallet&lt;/a> on her mobile device to read
the connection invitation as a QR code from the login page
to begin the DIDComm communication with the identity provider. The identity provider will then
verify the user’s credential and acquire the data the client application needs for the login.
The rest of the flow continues as with traditional OIDC, and finally, the client application
redirects the user to the protected service. The entire process sequence is below in detail:&lt;/p>
&lt;p>
&lt;figure>
&lt;img src="/blog/2022/04/07/ssi-empowered-identity-provider/sequence.svg"/>
&lt;/figure>
&lt;em>Step-by-step sequence for the login process&lt;/em>&lt;/p>
&lt;h2 id="implementation">Implementation&lt;/h2>
&lt;p>The demo services utilize OIDC JS helper libraries
(&lt;a href="https://github.com/panva/node-openid-client">client&lt;/a>,
&lt;a href="https://github.com/panva/node-oidc-provider">server&lt;/a>). We implemented the client application
integration similarly to any OIDC login integration, so there was no need to add any dedicated code
for SSI functionality. For the identity provider, we took
&lt;a href="https://github.com/panva/node-oidc-provider/tree/main/example">the JS OIDC provider sample code&lt;/a>
as the basis and extended the logic with
&lt;a href="https://github.com/findy-network/findy-oidc-provider/blob/master/src/agent/index.js">the SSI-agent controller&lt;/a>.
The number of needed code changes was relatively small, which showed us that these integrations to
the “legacy” world are possible and &lt;em>easy&lt;/em> to implement with an SSI agency that provides
a straightforward API.&lt;/p>
&lt;p>All of the codes are available on GitHub
(&lt;a href="https://github.com/findy-network/findy-issuer-tool">client&lt;/a>,
&lt;a href="https://github.com/findy-network/findy-oidc-provider">provider&lt;/a>)
so that you can take a closer look or even set up the demo on your local computer.&lt;/p>
&lt;p>&lt;em>We will continue our exploration journey with the verified data and the OIDC world, so stay tuned!&lt;/em>&lt;/p></description></item><item><title>Blog: Replacing Indy SDK</title><link>/blog/2022/03/14/replacing-indy-sdk/</link><pubDate>Mon, 14 Mar 2022 00:00:00 +0000</pubDate><guid>/blog/2022/03/14/replacing-indy-sdk/</guid><description>
&lt;p>&lt;a href="https://findy-network.github.io/blog/2021/09/08/travelogue/">Once again, we are at the technology
crossroad&lt;/a>: we have
to decide how to proceed with our SSI/DID research and development. Naturally,
the business potential is the most critical aspect, but the research subject has
faced the phase where &lt;em>we have to change the foundation&lt;/em>.&lt;/p>
&lt;p>&lt;img src="https://findy-network.github.io/blog/2021/09/08/travelogue/TechTree_hucb3e947ff7ac3c644fea522c44e98b42_1584631_1991x0_resize_catmullrom_3.png" alt="SSI Layers">&lt;/p>
&lt;p align = "center"> Our Technology Tree - &lt;a
href="https://findy-network.github.io/blog/2021/09/08/travelogue/">
Travelogue&lt;/a>&lt;/p>
&lt;p>Changing any foundation could be an enormous task, especially when a broad
spectrum of technologies is put together. (Please see the picture above).
Fortunately, we have taken care of this type of a need early in the design when
the underlying foundation, &lt;a href="https://github.com/hyperledger/indy-sdk">Indy SDK&lt;/a>
is double wrapped:&lt;/p>
&lt;ol>
&lt;li>We needed a Go wrapper for &lt;code>libindy&lt;/code> itself, i.e. &lt;em>language wrapping&lt;/em>.&lt;/li>
&lt;li>At the beginning of the &lt;code>findy-agent&lt;/code> project, we tried to find agent-level
concepts and interfaces for multi-tenant agency use, i.e. &lt;em>conceptual
wrapping&lt;/em>.&lt;/li>
&lt;/ol>
&lt;p>This post is peculiar because I&amp;rsquo;m writing it up front and not just reporting
something that we have been studied and verified carefully.&lt;/p>
&lt;blockquote>
&lt;p>&amp;ldquo;I am in a bit of a paradox, for I have assumed that there is no good in
assuming.&amp;rdquo; - Mr. Eugene Lewis Fordsworthe&lt;/p>
&lt;/blockquote>
&lt;p>I&amp;rsquo;m still writing this. Be patient; I&amp;rsquo;ll try to answer &lt;em>why&lt;/em> in the following chapters.&lt;/p>
&lt;h2 id="who-should-read-this">Who Should Read This?&lt;/h2>
&lt;p>You should read this if:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>You are considering jumping on the SSI/DID wagon, and you are searching good
technology platform for your SSI application. You will get selection criteria
and fundamentals from here.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>You are in the middle of the development of your own platform, and you need
a concrete list of aspects you should take care of.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>You are currently using Indy SDK, and you are designing your architecture based
on &lt;a href="https://github.com/hyperledger/aries">Aries reference architecture&lt;/a>
and its shared libraries.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>You are interested to see the direction the &lt;code>findy-agent&lt;/code> DID agency core is
taking.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="indy-sdk-is-obsolete">Indy SDK Is Obsolete&lt;/h2>
&lt;p>Indy SDK and related technologies are obsolete, and they are proprietary already.&lt;/p>
&lt;p>We have just reported that our Indy SDK based DID agency is &lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/concepts/0302-aries-interop-profile/README.md">AIP
1.0&lt;/a>
compatible, and everything is wonderful. How in the hell did Indy SDK become
obsolete and proprietary in a month or so?&lt;/p>
&lt;p>Well, let&amp;rsquo;s start from the beginning. I did write the following on January
19th 2022:&lt;/p>
&lt;p>&lt;strong>Indy SDK is on the sidetrack from the DID state of the art.&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Core concepts as explicit entities are missing: &lt;em>DID method&lt;/em>,
&lt;em>DID resolving&lt;/em>, &lt;em>DID Documents&lt;/em>, etc.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Because of the previous reasons, the &lt;em>API&lt;/em> of Indy SDK is not optimal
anymore.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>libindy&lt;/code> is too much framework than a library, i.e. it assumes how things
will be tight together, it tries to do too much in one function, or it
doesn&amp;rsquo;t isolate parts like ledger from other components like a wallet in a correct
way, etc.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Indy SDK has too many dynamic library dependencies when compared to
what those libraries achieve.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="the-problem-statement-summary">The Problem Statement Summary&lt;/h2>
&lt;p>We have faced two different but related problems:&lt;/p>
&lt;ol>
&lt;li>Indy SDK doesn&amp;rsquo;t align with the current W3C and Aries specifications.&lt;/li>
&lt;li>&lt;a href="https://findy-network.github.io/blog/2022/03/05/the-missing-network-layer-model/">The W3C and Aries specifications are too broad and lack clear
focus&lt;/a>.&lt;/li>
&lt;/ol>
&lt;h3 id="did-specifications">DID Specifications&lt;/h3>
&lt;p>I cannot guide the work of W3C or Aries, but I can participate in our own team&amp;rsquo;s
decision making, and we will continue on the road where we&amp;rsquo;ll concentrate our
efforts to &lt;a href="https://identity.foundation/didcomm-messaging/spec/">DIDComm&lt;/a>,
which will mean that we&amp;rsquo;ll keep the same Aries protocols implemented as we have
now, but with the latest DID message formats:&lt;/p>
&lt;ol>
&lt;li>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0023-did-exchange/README.md">DID
Exchange&lt;/a>
to build a DIDComm connection over an invitation or towards public DID.&lt;/li>
&lt;li>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0453-issue-credential-v2/README.md">Issue
Credential&lt;/a>
to use a DIDComm connection to issue credentials to a holder.&lt;/li>
&lt;li>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0454-present-proof-v2/README.md">Present
Proofs&lt;/a>
to present proof over a DIDComm connection.&lt;/li>
&lt;li>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0095-basic-message/README.md">Basic
Message&lt;/a>
to have private conversations over a DIDComm connection.&lt;/li>
&lt;li>&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0048-trust-ping/README.md">Trust
Ping&lt;/a>
to test a DIDComm connection.&lt;/li>
&lt;/ol>
&lt;p>Keeping the same protocol set might sound simple, but unfortunately, it&amp;rsquo;s not because
Indy SDK doesn&amp;rsquo;t have, e.g. a concept for &lt;code>DID Method&lt;/code>. At the end of the January
2022, no one has implemented the &lt;code>did:indy&lt;/code> method either, and its specification is
still in work-in-progress.&lt;/p>
&lt;p>The methods we&amp;rsquo;ll support first are &lt;code>did:peer&lt;/code> and &lt;code>did:key&lt;/code>. The first is
evident because our current Indy implementation builds almost identical pairwise
connections with Indy DIDs. The &lt;code>did:key&lt;/code> method replaces all public keys in
DIDComm messages. It has other use as well.&lt;/p>
&lt;p>The &lt;code>did:web&lt;/code> method is probably the next. It gives us an
implementation baseline for the actual &lt;em>super&lt;/em> &lt;a href="https://blockchaincommons.github.io/did-method-onion/">DID Method
&lt;code>did:onion&lt;/code>&lt;/a>.
In summary, onion routing gives us &lt;a href="https://findy-network.github.io/blog/2022/03/05/the-missing-network-layer-model/">a new transport layer (OSI
L4)&lt;/a>.&lt;/p>
&lt;p>We all know how difficult adding security and privacy to the internet&amp;rsquo;s (TCP/IP)
network layers are
(&lt;a href="https://www.securityweek.com/top-five-worst-dns-security-incidents">DNS&lt;/a>,
&lt;a href="https://neeva.com/learn/data-privacy-4-common-issues-and-how-to-solve-them">etc.&lt;/a>).
But replacing the transport layer with a new one is the best solution. Using
&lt;strong>onion addresses for &lt;a href="https://ldapwiki.com/wiki/DID%20Service%20Endpoint">the DID Service
Endpoints&lt;/a> solves
routing in own decoupled layer&lt;/strong> which reduces complexity tremendously.&lt;/p>
&lt;p>&lt;img src="https://i.imgflip.com/xk14q.jpg" alt="air">&lt;/p>
&lt;blockquote>
&lt;p>&amp;ldquo;In some sense IP addresses are not even meaningful to Onion Services: they
are not even used in the protocol.&amp;rdquo; - &lt;a href="https://community.torproject.org/onion-services/overview/">Onion
Services&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h3 id="indy-sdk-replacement">Indy SDK Replacement&lt;/h3>
&lt;p>Indy SDK is obsolete and proprietary. It&amp;rsquo;s not based on &lt;a href="https://www.w3.org/TR/did-core/">the current W3C DID core
concepts&lt;/a>. That makes it too hard to build reasonable
solutions over Indy SDK without reinventing the wheel. We have decided to
architect the ideal solution first and then make the selection criteria from it.
With the requirements, we start to select candidates for our crypto libraries.&lt;/p>
&lt;p>We don&amp;rsquo;t want to replace Indy SDK right away. We want to keep it until we don&amp;rsquo;t
need it anymore. When all parties have changed their verified credential formats
according to the standard, we decide again if we can drop it.&lt;/p>
&lt;h2 id="putting-all-together">Putting All Together&lt;/h2>
&lt;p>We described our problems in &lt;a href="#the-problem-statement-summary">the problem statement summary&lt;/a>.
We will put things together in the following chapters and present our problem-solving strategy.&lt;/p>
&lt;p>First, we need to align our current software solution to W3C specifications.
Aries protocols are already covered. Secondly, we need to find our way for
specification issues like selecting &lt;a href="https://findy-network.github.io/blog/2022/03/05/the-missing-network-layer-model/">proper DID methods to
support&lt;/a>.&lt;/p>
&lt;p>The missing (from Indy SDK) DID core concepts: &lt;code>DID&lt;/code>, &lt;code>DID document&lt;/code>, &lt;code>DID method&lt;/code>, &lt;code>DID resolving&lt;/code>, will be the base for &lt;strong>our target architecture&lt;/strong>. The following UML
diagram presents our high-level conceptual model of these concepts and
their relations.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1210px">
&lt;img class="card-img-top" src="/blog/2022/03/14/replacing-indy-sdk/cover-classes_hu68169d6d854aa04b756d328f13ce2f4e_177274_1200x0_resize_catmullrom_3.png" width="1200" height="1046">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Agency DID Core Concepts&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The class diagram shows that &lt;code>DIDMethodBase&lt;/code> is a critical abstraction because
it hides implementation details together with the interfaces it extends. Our
current agent implementation uses &lt;em>factory pattern&lt;/em> with &lt;em>new-by-name&lt;/em>, which
allows our system to read protocol streams and implicitly create native Go objects.
That has proven to be extremely fast and programmer-friendly. We will use
a similar strategy in our upcoming &lt;code>DID method&lt;/code> and &lt;code>DID resolving&lt;/code> solutions.&lt;/p>
&lt;h3 id="resolving">Resolving&lt;/h3>
&lt;p>The following diagram is our first draft of how we will integrate DID document
resolving to our agency.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 810px">
&lt;img class="card-img-top" src="/blog/2022/03/14/replacing-indy-sdk/resolve_hu68843e186b7e94ed4412e82ad891eddc_57470_800x0_resize_catmullrom_3.png" width="800" height="988">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Agency DID Core Concepts&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The sequence diagram is a draft where &lt;code>did:key&lt;/code> is solved. The method is solved
by computation. It doesn&amp;rsquo;t need persistent storage for &lt;code>DID documents&lt;/code>. However,
the drawing still illustrates our idea to have one internal resolver (&lt;em>factory&lt;/em>)
for everything. That gives many advantages like caching, but it also
keeps things simple and testable.&lt;/p>
&lt;h3 id="building-pairwise----did-exchange">Building Pairwise &amp;ndash; DID Exchange&lt;/h3>
&lt;p>You can have an explicit invitation
(&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/features/0434-outofband/README.md">OOB&lt;/a>)
protocol or you can just have &lt;a href="https://findy-network.github.io/blog/2022/03/05/the-missing-network-layer-model/#what-is-a-public-did">a public
DID&lt;/a>
that implies an invitation just by existing and resolvable the way that leads
service endpoints. Our resolver handles DIDs and DID documents and &lt;em>invitations&lt;/em>
as well. It&amp;rsquo;s essential because our existing applications have proven that
a pairwise connection is the fundamental building block of the DID system.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 810px">
&lt;img class="card-img-top" src="/blog/2022/03/14/replacing-indy-sdk/pairwise_hu8e4606477e1f49816dced191085ba872_138973_800x0_resize_catmullrom_3.png" width="800" height="826">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Agency DID Core Concepts&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>We should be critical just to avoid complexity. If the goal is to reuse existing
pairwise (connection), and the most common case is a public website, should we
leave that for public DIDs and try not to solve by invitation? When public DIDs
would scale and wouldn&amp;rsquo;t be correlatable, we might be able to simplify
invitations at least? Or, should we think if we really need &lt;em>connectable&lt;/em> public
DIDs? Or maybe we don&amp;rsquo;t need both of them anymore, just another?&lt;/p>
&lt;p>&lt;strong>Our target architecture&lt;/strong> helps us to find answers to these questions. It also
allows us to keep track of non-functional requirements like &lt;em>modifiability,
scalability, security, privacy, performance, simplicity, testability&lt;/em>. These are
the most important ones, and everyone is equally important to us.&lt;/p>
&lt;h2 id="existing-sdk-options">Existing SDK Options?&lt;/h2>
&lt;p>Naturally, Indy SDK is not the only solution for SSI/DID. When the Aries project
and its goals were published, most of us thought that replacing SDKs for Indy
would come faster. Unfortunately, that didn&amp;rsquo;t happen, and there are many reasons
for that.&lt;/p>
&lt;p>Building software has many internal &amp;rsquo;ecosystems&amp;rsquo; mainly directed by programming
languages. For instance, it&amp;rsquo;s unfortunate that gophers behave like managed
language programmers and rarely use pure native binary libraries because we lose
too many good Go features. For example, we would have compromised in super-fast
builds, standalone binaries, broad platform support, etc. They might sound like
small things, but they aren&amp;rsquo;t. For example, the container image sizes for
standalone Go binaries are almost the same as the original Go binary.&lt;/p>
&lt;p>It is easier to keep your Go project only written in Go. Just one
&lt;a href="https://en.wikipedia.org/wiki/Application_binary_interface">ABI&lt;/a> library usage
would force you to follow the binary dependency tree, and you could not use
standalone Go binary. If you can find a module just written in Go, you select
that even it would be some sort of a compromise.&lt;/p>
&lt;p>That&amp;rsquo;s been one reason we have to build our own API with gRPC. That will offer
the best from both worlds and allow efficient polyglot usage. I hope others do
the same and use modern API technologies with local/remote transparency.&lt;/p>
&lt;h2 id="we-are-going-to-evaluate-afgo">We Are Going To Evaluate AFGO&lt;/h2>
&lt;p>Currently, the Aries Framework Go seems to be the best &lt;em>evaluation&lt;/em> option for us
because:&lt;/p>
&lt;ul>
&lt;li>It&amp;rsquo;s written in Go, and all its dependencies are native Go packages.&lt;/li>
&lt;li>It follows the Aries specifications by the book.&lt;/li>
&lt;/ul>
&lt;p>Unfortunately, it also has the following problems:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>It&amp;rsquo;s is &lt;em>a framework&lt;/em> which typically means all or nothing, i.e. you have to
use the whole framework because it takes care of everything, and it only offers
you extension points where you can put your application handlers. A
framework is much more complex to replace than a library.&lt;/p>
&lt;p>&lt;img src="https://csharpcorner-mindcrackerinc.netdna-ssl.com/UploadFile/a85b23/framework-vs-library/Images/DqCkT.png" alt="framework vs library">&lt;/p>
&lt;p align = "center"> Difference Between Library and Framework - &lt;a
href="https://www.c-sharpcorner.com/uploadfile/a85b23/framework-vs-library/">The Blog
Post&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Its protocol state machine implementation is not as good as ours:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>It doesn&amp;rsquo;t fork protocol handlers immediately after receiving the
message payload.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>It doesn&amp;rsquo;t offer a 30.000 ft view to machines, i.e. it doesn&amp;rsquo;t seem to
be declarative enough.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>It has totally different concepts than we and Indy SDK have for the critical
entities like DID and storage like a wallet. Of course, that&amp;rsquo;s not
necessarily a bad thing. We have to check how AFGO&amp;rsquo;s concepts map to our
target architecture.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>During the first skimming of the code, a few alarms were raised primarily for
the performance.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>We will try to wrap AFGO to use it as a library and produce an interface that we
can implement with Indy SDK and AFGO. This way, we can use our current core
components to implement different Aries protocols and even verifiable
credentials.&lt;/p>
&lt;p>Our agency has bought the following features and components which we have measured
to be superior to other similar DID solutions:&lt;/p>
&lt;ul>
&lt;li>Multi-tenancy model, i.e. symmetric agent model&lt;/li>
&lt;li>Fast server-side secure enclaves for KMS&lt;/li>
&lt;li>General and simple DID controller gRPC API&lt;/li>
&lt;li>Minimal dependencies&lt;/li>
&lt;li>Horizontal scalability&lt;/li>
&lt;li>Minimal requirements for hardware&lt;/li>
&lt;li>Cloud-centric design&lt;/li>
&lt;/ul>
&lt;p>We really try to avoid inventing the wheel, but with the current knowledge, we
cannot switch to AFGO. Instead, we can wrap it and use it as an independent
library.&lt;/p>
&lt;blockquote>
&lt;p>Don&amp;rsquo;t call us, we&amp;rsquo;ll call you. - &lt;a href="https://en.wiktionary.org/wiki/Hollywood_principle">Hollywood
Principle&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>We will continue to report our progress and publish the AFGO wrapper when
ready. Stay tuned, folks, something extraordinary is coming!&lt;/p></description></item><item><title>Blog: The Missing Network Layer Model</title><link>/blog/2022/03/05/the-missing-network-layer-model/</link><pubDate>Sat, 05 Mar 2022 00:00:00 +0000</pubDate><guid>/blog/2022/03/05/the-missing-network-layer-model/</guid><description>
&lt;p>&lt;a href="https://www.w3.org/TR/did-core/">The W3C&amp;rsquo;s DID Specification&lt;/a> is flawed without
&lt;strong>the network layer model&lt;/strong>.&lt;/p>
&lt;p>You might think that I have lost my mind. We have just reported that our Indy
SDK based DID agency is &lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/concepts/0302-aries-interop-profile/README.md">AIP
1.0&lt;/a>
compatible, and everything is wonderful. What&amp;rsquo;s going on?&lt;/p>
&lt;p>Well, let&amp;rsquo;s start from the beginning. I did write the following list on January
19th 2022:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Indy SDK doesn&amp;rsquo;t align the current W3C and Aries specifications.&lt;/p>
&lt;ul>
&lt;li>Core concepts (below) as explicit entities are missing: &lt;em>DID method&lt;/em>,
&lt;em>DID resolving&lt;/em>, &lt;em>DID Documents&lt;/em>, etc.&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://www.w3.org/TR/did-core/diagrams/did_brief_architecture_overview.svg" alt="DID Concepts">&lt;/p>
&lt;p align = "center"> DID Concepts - &lt;a href="https://www.w3.org/TR/did-core/diagrams/did_brief_architecture_overview.svg">www.w3.org&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>No one in the SSI industry seems to be able to find perfect focus.&lt;/p>
&lt;ul>
&lt;li>
&lt;p>There are too few solutions running in production (yes, globally as well)
which would give us needed references to drive a good design from.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://lists.w3.org/Archives/Public/public-new-work/2021Sep/0000.html">Standardization in W3C didn&amp;rsquo;t proceed as it
should&lt;/a>.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Findings during our study of SSI/DID and others in the industry.&lt;/p>
&lt;ul>
&lt;li>
&lt;p>We don&amp;rsquo;t need a ledger to solve
&lt;a href="https://github.com/SmithSamuelM/Papers/blob/master/whitepapers/10-ssi-key-management.pdf">self-certified&lt;/a>
identities.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>We don&amp;rsquo;t need human &lt;em>memorable&lt;/em> identifiers. (memorable \(\ne\) meaningful
\(\ne\) typeable \(\ne\) codeable)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>We &lt;em>rarely&lt;/em> need an identifier just for &lt;em>referring&lt;/em> but we continuously need
&lt;em>self-certified identifiers for secure communication&lt;/em>: should we first fully
solve the communication problem and not the other way around?&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Trust always seems to lead back to a specific type of centralization. There are
many existing studies like web-of-trust that should at least take in a
review. &lt;a href="https://www.weboftrust.info/">Rebooting Web-of-Trust&lt;/a> is an excellent
example of that kind of work.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>We must align the SSI/DID technology to the current state of the art like
Open ID and federated identity providers. &lt;a href="https://openid.net/specs/openid-connect-self-issued-v2-1_0.html">Self-Issued OpenID Provider
v2&lt;/a>
the protocol takes steps in the right direction and will work as a bridge.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="w3c-did-specification-problems">W3C DID Specification Problems&lt;/h2>
&lt;p>Now, February 20th 2022, the list is still valid, but now, when we have dug
deeper, we have learned that the DID W3C &amp;ldquo;standard&amp;rdquo; has its flaws itself.&lt;/p>
&lt;ol>
&lt;li>
&lt;p>It&amp;rsquo;s far too complex and redundant &amp;ndash; the scope is too broad.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>There should not be so many DID methods. &lt;a href="https://lists.w3.org/Archives/Public/public-new-work/2021Sep/0000.html">&amp;ldquo;No practical interoperability.&amp;rdquo; &amp;amp;
&amp;ldquo;Encourages divergence rather than
convergence.&amp;rdquo;&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>For some reason, &lt;a href="https://www.w3.org/TR/did-core/">DID-core&lt;/a> doesn&amp;rsquo;t
cover protocol specifications, but protocols are in &lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/index.md">Aries
RFCs&lt;/a>. You&amp;rsquo;ll
face the problem in &lt;a href="https://identity.foundation/peer-did-method-spec/">the DID peer method
specification&lt;/a>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>It misses layer structures typical for network protocols. When you start to
implement it, you notice that there are no network layers to help you to hide
abstractions. Could we have &lt;a href="https://www.networkworld.com/article/3239677/the-osi-model-explained-and-how-to-easily-remember-its-7-layers.html">OSI
layer&lt;/a>
mappings or similar at least? (Please see the chapter &lt;a href="#the-missing-layer---fixing-the-internet">The Missing Layer - Fixing The
Internet&lt;/a>)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Many performance red flags pop up when you start to engineer the
implementation. Just think about &lt;a href="https://brooker.co.za/blog/2021/04/19/latency.html">tail
latency&lt;/a> in DID resolving
and you see it. Especially if you think &lt;a href="https://lig-membres.imag.fr/loiseapa/pdfs/2015/Hours-etal_ImpactDNSCausal_ITC2015.pdf">the performance demand of the
DNS&lt;/a>.
The comparison is pretty fair.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="no-need-for-the-ledger">No Need For The Ledger&lt;/h2>
&lt;p>The &lt;code>did:onion&lt;/code> method is currently the only straightforward way to build
self-certified &lt;em>public&lt;/em> DIDs that cannot be correlated. The &lt;code>did:web&lt;/code> is
analogue, but it doesn&amp;rsquo;t offer privacy as itself. However, it provides privacy
for the individual agents through &lt;a href="https://github.com/w3c/did-core/issues/539">&lt;em>herd privacy&lt;/em> if DID specification doesn&amp;rsquo;t
fail in it&lt;/a>.&lt;/p>
&lt;p>Indy stores &lt;a href="https://docs.cheqd.io/node/architecture/adr-list/adr-008-identity-resources">credential definitions and
schemas&lt;/a>
to the ledger addition to public DIDs. Nonetheless, when &lt;a href="https://www.evernym.com/blog/bbs-verifiable-credentials/">verifiable credentials
move to use BBS+ credential definitions aren&amp;rsquo;t
needed&lt;/a> and schemas
can be read, e.g. from &lt;a href="schema.org">schema.org&lt;/a>. Only those DID methods need
a ledger that is using a ledger as &lt;em>public DID&amp;rsquo;s&lt;/em> &lt;a href="https://findy-network.github.io/blog/2021/11/09/anchoring-chains-of-trust/">trust
anchor&lt;/a>
and source of truth.&lt;/p>
&lt;h3 id="what-is-a-public-did">What Is A Public DID?&lt;/h3>
&lt;p>It&amp;rsquo;s a DID who&amp;rsquo;s DIDDoc you can solve without an
&lt;a href="https://github.com/hyperledger/aries-rfcs/blob/b3a3942ef052039e73cd23d847f42947f8287da2/features/0434-outofband/README.md">invitation&lt;/a>.&lt;/p>
&lt;p>The &lt;code>did:key&lt;/code> is superior because it is complete. You can compute (solve) a DID
document by receiving a valid DID key identifier. No third party or additional
source of truth is needed. However, we cannot communicate with the &lt;code>did:key&lt;/code>&amp;rsquo;s
holder because the DIDDoc doesn&amp;rsquo;t include &lt;a href="https://www.w3.org/TR/did-core/#services">service
endpoints&lt;/a>. So, there is no one
listening and nothing to connect to.&lt;/p>
&lt;p>Both &lt;code>did:onion&lt;/code>&amp;rsquo;s and &lt;code>did:web&lt;/code>&amp;rsquo;s DIDDocs can include service endpoints because
they can offer the DID document by their selves from their own servers. We must
remember that the DID document offers &lt;a href="https://www.w3.org/TR/did-core/#verification-methods">verification
methods&lt;/a> which can be used
to build the actual &lt;a href="https://findy-network.github.io/blog/2021/11/09/anchoring-chains-of-trust/">cryptographic
trust&lt;/a>.&lt;/p>
&lt;h2 id="how-to-design-best-agency">How To Design Best Agency?&lt;/h2>
&lt;p>How to do it right now when &lt;em>we don&amp;rsquo;t have a working standard or de facto
specifications&lt;/em>? We have thought that for a long time, over three years for now.&lt;/p>
&lt;p>I have thought and compared SSI/DID networks and solutions. I think we need to
have a layer model similar to the OSI network model to handle complexity.
Unfortunately, the famous trust-over-IP picture below isn&amp;rsquo;t the one that is
missing:&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1210px">
&lt;img class="card-img-top" src="/blog/2022/03/05/the-missing-network-layer-model/toip-stack_hue7e4f66bde09e85903cc24abf2b16ca3_676033_1200x0_resize_catmullrom_3.png" width="1200" height="774">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>ToIP Stacks&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Even though the ToIP has a layer model, it doesn&amp;rsquo;t help us build technical
solutions. It&amp;rsquo;s even more unfortunate that &lt;em>many in the industry think that
it&amp;rsquo;s the network layer model when it&amp;rsquo;s not&lt;/em>. It&amp;rsquo;s been making communication between
different stakeholders difficult because we see things differently, and we don&amp;rsquo;t
share common ground detailed enough.&lt;/p>
&lt;p>Luckily, I found &lt;a href="https://medium.com/decentralized-identity/the-self-sovereign-identity-stack-8a2cc95f2d45">a blog
post&lt;/a>
which seems to be the right one, but I didn&amp;rsquo;t find any follow-up work.
Nonetheless, we can use it as a reference and proof that there exists this kind of
need.&lt;/p>
&lt;p>The following picture is from the blog post. As we can see, &lt;em>it includes
problems&lt;/em>, and the weirdest one is the &lt;em>missing OSI mapping&lt;/em>. Even the post
explains how vital the layer model is for &lt;em>interoperability&lt;/em> and &lt;em>portability&lt;/em>.
Another maybe even more weird mistake is mentioning that layers could &lt;em>be
coupled&lt;/em> when the whole point of layered models is to have &lt;strong>decoupled layers&lt;/strong>.
Especially when building &lt;strong>privacy holding technology&lt;/strong>, it should be evident
that &lt;strong>there cannot be leaks between layers&lt;/strong>.&lt;/p>
&lt;p>&lt;img src="https://miro.medium.com/max/1400/1*4zUczSBaVH-8qilvK4nKwQ.png"
width="550" />&lt;/p>
&lt;p align = "center"> The Self-sovereign Identity Stack - &lt;a
href="https://medium.com/decentralized-identity/the-self-sovereign-identity-stack-8a2cc95f2d45">The Blog
Post&lt;/a>&lt;/p>
&lt;h3 id="the-missing-layer---fixing-the-internet">The Missing Layer - Fixing The Internet&lt;/h3>
&lt;p>The following picture illustrates mappings from the OSI model through protocols to TCP/IP
model.&lt;/p>
&lt;p>&lt;img src="https://www.dummies.com/wp-content/uploads/296299.image0.jpg" alt="TCP/IP and OSI">&lt;/p>
&lt;p>We all know that the internet was created without security and privacy, and still,
it&amp;rsquo;s incredibly successful and scalable. From the layer model, it&amp;rsquo;s easy to see
that security and privacy solutions should be put under the transport layer to
allow all of the current applications to work without changes. But it&amp;rsquo;s not
enough if we want to have end-to-end encrypted and secure communication pipes.&lt;/p>
&lt;p>&lt;strong>We need to take the best of both worlds: fix as much as possible, as a low layer
as you can one layer at a time.&lt;/strong>&lt;/p>
&lt;h3 id="secure--private-transport-layer">Secure &amp;amp; Private Transport Layer&lt;/h3>
&lt;p>There is one existing solution, and others are coming:&lt;/p>
&lt;ol>
&lt;li>&lt;a href="https://www.torproject.org/">Tor&lt;/a> and its onion routing.&lt;/li>
&lt;li>&lt;a href="https://nymtech.net/">NYM&lt;/a>, etc.&lt;/li>
&lt;/ol>
&lt;p>I know that Tor has its performance problems, etc., but the point is not about
that. The point is to which network layer should handle secure and private
transport. It&amp;rsquo;s not DIDComm, and it definitely isn&amp;rsquo;t implemented as &lt;em>statical
routing like currently in DIDComm&lt;/em>. Just think about it: What it means when you
have to change your mediator or add another one, and compare it to current
TCP/IP network? It&amp;rsquo;s a no-brainer that routing should be isolated in a layer.&lt;/p>
&lt;p>The following picture shows how OSI and TCP/IP layers map. It also shows one
possibility to use onion routing instead on insecure and public TCP/IP routing
for DID communication.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1210px">
&lt;img class="card-img-top" src="/blog/2022/03/05/the-missing-network-layer-model/OSIMap_hue1e7d1ebdd8994d467756b8af57eda38_245909_1200x0_resize_catmullrom_3.png" width="1200" height="945">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>DID Communication OSI Mapping&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The solution is secure and private, and there aren&amp;rsquo;t no leaks between layers which
could lead to correlation.&lt;/p>
&lt;h2 id="putting-all-together">Putting All Together&lt;/h2>
&lt;p>The elephant is eaten one bite at a time is a strategy we have used
successfully and continue to use here. We start with missing core
concepts: &lt;code>DID&lt;/code>, &lt;code>DID document&lt;/code>, &lt;code>DID method&lt;/code>, &lt;code>DID resolving&lt;/code>. The following
UML diagram present our high-level conceptual model of these concepts and their
relations.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1210px">
&lt;img class="card-img-top" src="/blog/2022/03/05/the-missing-network-layer-model/classes_hu68169d6d854aa04b756d328f13ce2f4e_177274_1200x0_resize_catmullrom_3.png" width="1200" height="1046">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Agency DID Core Concepts&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Because current DID specification allows or supports many different &lt;em>DID
Methods&lt;/em> we have to take care of them in the model. It would be naive to think
we could use only external &lt;em>DID resolver&lt;/em> and delegate DIDDoc solving.
Just for think about performance, it would be a nightmare, security issues even
more.&lt;/p>
&lt;h3 id="replacing-the-indy-sdk">Replacing the Indy SDK&lt;/h3>
&lt;p>We will publish a separate post about replacing Indy SDK or bringing other Aries
solutions as a library. What the basic strategy will be is decided
during the work. We’ll implement new concepts and implement only these DID
methods during the process:&lt;/p>
&lt;ul>
&lt;li>&lt;em>DID Key&lt;/em>, needed to replace public key references, and it&amp;rsquo;s usable for many
other purposes as well.&lt;/li>
&lt;li>&lt;em>DID Peer&lt;/em>, building pairwise connection is a foundation to DIDComm. However,
we are still figuring out the proper implementation scope for
the &lt;code>did:peer&lt;/code>.&lt;/li>
&lt;li>&lt;em>DID Web and Onion&lt;/em>, it seems that this is an excellent transition method towards
more private and sovereign &lt;code>did:onion&lt;/code> method.&lt;/li>
&lt;/ul>
&lt;p>Stay tuned. The following blog post is coming out in a week.&lt;/p></description></item><item><title>Blog: Fostering Interoperability</title><link>/blog/2022/01/19/fostering-interoperability/</link><pubDate>Wed, 19 Jan 2022 00:00:00 +0000</pubDate><guid>/blog/2022/01/19/fostering-interoperability/</guid><description>
&lt;p>Different services have different requirements and technical stacks; there are also multiple ways to implement the Aries agent support in an application. Some projects choose to rely on an Aries framework of a specific language and bundle the functionality within the service. Others might run the agent as a separate service or, as in the case of Findy Agency, as an agency that serves multiple clients.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2022/01/19/fostering-interoperability/manual-test_hu2ad66fb4e4e3677b9f68960c3b1b7d49_90636_925x925_fit_catmullrom_3.png" width="925" height="486">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Sending Aries basic messages between wallets from different technology stacks. See full demo in &lt;a href="https://www.youtube.com/watch?v=W1H7ppS2Y6M" target="_blank" rel="noopener noreferer">YouTube&lt;/a>.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Interoperability is a crucial element when we think about the adaptation and success of the Aries protocol. Even though the agent software might fulfill all the functional requirements and pass testing with use cases executed with a single agent technology stack, the story ending might be different when running the cases against another agent implementation. How can we then ensure that the two agents built with varying technology stacks can still work together and reach the same goals? Interoperability testing solves this problem. Its purpose is to verify that the agent software complies with the Aries protocol used to communicate between agents.&lt;/p>
&lt;h2 id="aries-interoperability-testing">Aries Interoperability Testing&lt;/h2>
&lt;p>Interoperability considerations came along quite early to the protocol work of the Aries community. The community faced similar challenges as other technical protocol developers have faced over time. When the number of Aries protocols increases and the protocol flows and messages are updated as the protocols evolve, how can the agent developers maintain compatibility with other agent implementations? The community decided to take &lt;a href="https://github.com/hyperledger/aries-rfcs/tree/main/concepts/0302-aries-interop-profile">Aries Interoperability Profiles (AIPs)&lt;/a> in use. Each AIP version defines a list of &lt;a href="https://github.com/hyperledger/aries-rfcs">Aries RFCs&lt;/a> with specific versions. Every agent implementation states which AIP version it supports and expects other implementations with the same version support to be compatible.&lt;/p>
&lt;p>To ensure compatibility, the community had &lt;a href="https://github.com/hyperledger/aries-rfcs/tree/main/concepts/0270-interop-test-suite">an idea of a test suite&lt;/a> that the agent developers could use to make sure that the agent supports the defined AIP version. The test suite would launch the agent software and run a test set that measures if the agent under test behaves as the specific protocol version requires. The test suite would generate a report of the test run, and anyone could then easily compare the interoperability results of different agents.&lt;/p>
&lt;p>At first, there were two competing test suites with different approaches to execute the tests. &lt;a href="https://github.com/hyperledger/aries-protocol-test-suite">Aries Protocol Test Suite (APTS)&lt;/a> includes an agent implementation that interacts with the tested agent through the protocol messages. On the other hand, &lt;a href="https://github.com/hyperledger/aries-agent-test-harness">Aries Agent Test Harness (AATH)&lt;/a> runs the tests operating the agent-client interface. This approach makes it possible to measure the compatibility of any two agent implementations. AATH seems to be the winning horse of the test suite race. Its test suite includes several test cases and has extensive reporting in place.&lt;/p>
&lt;h3 id="aries-agent-test-harness">Aries Agent Test Harness&lt;/h3>
&lt;p>Aries Agent Test Harness provides a BDD (behavioral driven) test execution engine and a set of tests derived from Aries RFCs. The aim is to run these tests regularly between different Aries agents (and agent frameworks) to monitor the compatibility score for each combination and catch compatibility issues.&lt;/p>
&lt;p>Harness operates the agents under test through backchannels. Backchannel is a REST interface defined by &lt;a href="https://github.com/hyperledger/aries-agent-test-harness/blob/main/docs/assets/openapi-spec.yml">an OpenAPI definition&lt;/a>, and its purpose is to pass the harness requests to the agents. The target is to handle the agent as a black box without interfering with the agent&amp;rsquo;s internal structures. Thus, the backchannel uses the agent&amp;rsquo;s client interface to pass on the harness requests.&lt;/p>
&lt;figure>
&lt;img src="https://courses.edx.org/assets/courseware/v1/571727dd6d3f57d64158c9567f0d8ff2/asset-v1:LinuxFoundationX&amp;#43;LFS173x&amp;#43;1T2020&amp;#43;type@asset&amp;#43;block/The_Aries_Agent_Test_Harness.png"/> &lt;figcaption>
&lt;p>
&lt;a href="https://learning.edx.org/course/course-v1:LinuxFoundationX&amp;#43;LFS173x&amp;#43;1T2020/home">image source: LinuxFoundationX LFS173x (CC BY 4.0)&lt;/a>&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Harness utilizes Docker containers for testing. It launches a container based on a required agent image for each test scenario actor during the test run. Before the test run, one needs to build a single image containing all the needed agent services and the backchannel. The recipes for making each of the different agent images, i.e., Dockerfiles with the needed scripts, are stored in the AATH repository. The same repository also contains CI scripts for executing the tests regularly and generating &lt;a href="https://aries-interop.info/">an extensive test report site&lt;/a>.&lt;/p>
&lt;h2 id="interoperability-for-findy-agency">Interoperability for Findy Agency&lt;/h2>
&lt;p>One of our main themes for 2H/2021 was to verify the Aries interoperability level for Findy Agency. When I investigated the Aries interoperability tooling more, it became evident that we needed to utilize the AATH to accomplish the satisfactory test automation level.&lt;/p>
&lt;p>My first task was to create &lt;a href="https://github.com/findy-network/findy-agent-backchannel">a backchannel&lt;/a> for the harness to operate Findy Agency-hosted agents. Backchannel&amp;rsquo;s role is to convert the harness&amp;rsquo;s REST API requests to Findy Agency gRPC client interface. Another challenge was to combine the agency microservices into &lt;a href="https://github.com/findy-network/findy-agent-backchannel/blob/master/aath/Dockerfile">a single Docker image&lt;/a>. Each agency microservice runs in its dedicated container in a regular agency deployment. For AATH, I needed to bundle all of the required services into a single container, together with the backchannel.&lt;/p>
&lt;p>Once the bundle was ready, I made &lt;a href="https://github.com/hyperledger/aries-agent-test-harness/pull/341">a PR to the AATH repository&lt;/a> to include Findy Agency in the Aries interoperability test set. We decided to support AIP version 1.0, but leave out the revocation for now. Tests exposed some essential but mainly minor interoperability issues with our implementation, and we were able to solve all of the found problems quite swiftly. The tests use the latest Findy Agency release with each test run. One can monitor &lt;a href="https://aries-interop.info/findy.html">the test results for Findy Agency&lt;/a> on the test result site.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 949px">
&lt;img class="card-img-top" src="/blog/2022/01/19/fostering-interoperability/results_hufa4ee9cabbf5b53022a6b7fed8ad758e_125699_939x649_fit_catmullrom_3.png" width="939" height="644">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Test result snapshot from &lt;a href="https://aries-interop.info/" target="_blank" rel="noopener noreferer">Aries test reporting site&lt;/a>&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>In addition to interoperability testing, we currently utilize the AATH tooling for our functional acceptance testing. Whenever PR gets merged to our agency core repository that hosts the code for Aries protocol handlers, &lt;a href="https://github.com/findy-network/findy-agent/blob/master/.github/workflows/iop.yml">CI builds&lt;/a> an image of the code snapshot and runs a partial test set with AATH. The testing does not work as a replacement for unit tests but more as a last acceptance gate. The agency core runs in the actual deployment Docker container. The intention is to verify both the successful agency bootup and the functionality of the primary protocol handlers. This testing step has proven to be an excellent addition to our test repertoire.&lt;/p>
&lt;h3 id="manual-tests">Manual Tests&lt;/h3>
&lt;p>Once the interoperability test automation reached an acceptable level, my focus moved to actual use cases that I could execute between the different agents.&lt;/p>
&lt;p>My main interests were two wallet applications freely available in the app stores, &lt;a href="https://lissi.id/">Lissi Wallet&lt;/a> and &lt;a href="https://trinsic.id/trinsic-wallet/">Trinsic Wallet&lt;/a>. I was intrigued by how Findy Agency-based applications would work with these identity wallets. I also wanted to test our Findy Agency web wallet with an application from a different technology stack. &lt;a href="https://github.com/bcgov">BCGov&lt;/a> provides a freely available test network that both wallet applications support, so it was possible to execute the tests without network-related hassle.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2022/01/19/fostering-interoperability/cover-demo.drawio_huf36e1a42bdf7cc78eb70fb813ee7e03b_414690_925x925_fit_catmullrom_3.png" width="925" height="537">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Manual test setup&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>I executed the following tests:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Test 1: Findy Agency based issuer/verifier with Lissi Wallet&lt;/strong>&lt;/p>
&lt;p>A Findy Agency utilizing &lt;a href="https://github.com/findy-network/findy-issuer-tool">issuer tool&lt;/a> invites Lissi Wallet to form a pairwise connection. Issuer tool sends and verifies a credential with Lissi Wallet.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Test 2: Findy Agency Web Wallet with Trinsic Wallet&lt;/strong>&lt;/p>
&lt;p>Findy Agency Web Wallet user forms a pairwise connection with Trinsic Wallet user. Wallet applications send Aries basic messages to each other.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Test 3: ACA-Py based issuer/verifier with Findy Agency Web Wallet&lt;/strong>&lt;/p>
&lt;p>Aries Test Harness runs &lt;a href="https://github.com/hyperledger/aries-cloudagent-python">ACA-Py&lt;/a>-based agents that issue and verify credentials with Findy Agency Web Wallet.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>The practical interoperability of Findy Agency also seems to be good, as proven with these manual tests. You can find the video of the test screen recording on &lt;a href="https://www.youtube.com/watch?v=W1H7ppS2Y6M">YouTube&lt;/a>.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/W1H7ppS2Y6M" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;h2 id="next-steps">Next Steps&lt;/h2>
&lt;p>Without a doubt, Aries interoperability will be one of the drivers guiding the development of Findy Agency also in the future. With the current test harness integration, the work towards AIP2.0 is now easier to verify. Our team will continue working with the most critical Aries features relevant to our use cases. We also welcome contributions from others who see the benefit in building an OS world-class enterprise-level identity agency.&lt;/p></description></item><item><title>Blog: Anchoring Chains of Trust</title><link>/blog/2021/11/09/anchoring-chains-of-trust/</link><pubDate>Tue, 09 Nov 2021 00:00:00 +0000</pubDate><guid>/blog/2021/11/09/anchoring-chains-of-trust/</guid><description>
&lt;p>You will notice a repetitive pattern once you start to play with &lt;a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public-key cryptography&lt;/a>. Everything is about chains, or more
precisely about &lt;em>the links in the chain&lt;/em>. You build these links with
public/private key pairs. Links are unidirectional, which means that if you must
link or point both ways, you need to have two key pairs, one for each
direction.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 601px">
&lt;img class="card-img-top" src="/blog/2021/11/09/anchoring-chains-of-trust/RootOfChainWithAuthenticator_hud95e60c4b93d4f99683425572d5ff616_352781_591x0_resize_catmullrom_3.png" width="591" height="344">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Crypto Chain with Authenticator&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>In this blog post, we talk mostly about protocols built with asymmetric key pairs,
but we can build immutable data structures like Merkle trees and blockchains with
&lt;a href="https://en.wikipedia.org/wiki/One-way_function">one-way functions&lt;/a> as well. We
will return to these data types in future posts by building something
interesting to replace general ledgers as DID&amp;rsquo;s
&lt;a href="https://www.w3.org/TR/did-imp-guide/#verifiable-data-registry">VDR&lt;/a>.&lt;/p>
&lt;h2 id="crypto-chain-protocols">Crypto Chain Protocols&lt;/h2>
&lt;p>We all know that the connection protocols should cover all security
issues, but protocols based on public-key cryptography might not be so
obvious &lt;em>public&lt;/em> key, you know? There are known subjects with protocols based on
asymmetric cryptography like
&lt;a href="https://en.wikipedia.org/wiki/Trust_on_first_use">trust-on-first-use&lt;/a>.&lt;/p>
&lt;img src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Man_in_the_middle_attack.svg" width="400" height="10" />
&lt;p align = "center"> MITM - &lt;a href="https://upload.wikimedia.org/wikipedia/commons/e/e7/Man_in_the_middle_attack.svg">Wikipedia&lt;/a>&lt;/p>
&lt;p>It&amp;rsquo;s trivial to execute &lt;a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">MITM&lt;/a>
attack if we cannot be sure that the public key source is the one it
should be. The industry has developed different ways to make sure that presented
details are valid. That lays down one of the most fundamental aspects of modern
cryptographic systems &amp;ndash; &lt;a href="https://en.wikipedia.org/wiki/Chain_of_trust">chain of
trust&lt;/a>.&lt;/p>
&lt;p>&lt;img src="https://upload.wikimedia.org/wikipedia/commons/0/02/Chain_Of_Trust.svg" alt="Trust Chain">&lt;/p>
&lt;p align = "center"> PKI Chain of trust - &lt;a href="https://upload.wikimedia.org/wikipedia/commons/0/02/Chain_Of_Trust.svg">Wikipedia&lt;/a>&lt;/p>
&lt;p>It is essential to understand that most of the modern security protocols use
public-key cryptography only for
&lt;a href="https://en.wikipedia.org/wiki/Authentication">authentication&lt;/a> and switch to
&lt;a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm">symmetric keys&lt;/a> during
the data transfer for performance reasons. The famous example of this kind of
protocol is &lt;a href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange">Diffie-Hellman&lt;/a>
where the shared secret (the symmetric key) is transported over public network.&lt;/p>
&lt;p>The &lt;a href="https://github.com/hyperledger/aries-rfcs/blob/main/concepts/0005-didcomm/README.md">DIDComm&lt;/a>
protocol is something that is not used only for authentication but
communication without sacrificing privacy. My prediction is that the current
message-oriented DIDComm protocol as a holistic transport layer is not enough.
The ongoing &lt;a href="https://github.com/decentralized-identity/didcomm-messaging">DIDComm
V2&lt;/a> mentions
potential other protocols like DIDComm Stream, DIDComm Multicast, and so forth,
but that will not be an easy task because of the current routing model, and
especially because of the privacy needs. That has been one reason we have
focused our efforts on finding a solution that would scale for all modern needs
of transporting data and keeping individuals private. For that, our cloud agency
is a perfect candidate.&lt;/p>
&lt;h2 id="symmetry-vs-asymmetry-in-protocols">Symmetry vs Asymmetry in Protocols&lt;/h2>
&lt;p>Before we go any further with DIDComm, let&amp;rsquo;s think about what it means to have
an asymmetric protocol. We know the differences between symmetric and asymmetric
cryptography. Let&amp;rsquo;s focus on communication, i.e. how we transport keys during
the protocol.&lt;/p>
&lt;p>Asymmetric protocol means that Bob can trust Alice when Alice
have given her public key to Bob, and Bob can be sure that it&amp;rsquo;s Alice whose key
he has received.&lt;/p>
&lt;p>Every time Bob needs to authenticate Alice, he asks Alice to sign
something with her private key. To make it crystal-clear, cryptographically, we
can be only sure that it&amp;rsquo;s Alice who (still) controls the private key.&lt;/p>
&lt;p>We could achieve symmetry only by that Alice has Bob&amp;rsquo;s public key as well. Now
Alice can ask Bob to sign something for the authenticity of Bob.&lt;/p>
&lt;p>Why is this important? There are several reasons for that, but the most crucial
reason is &lt;strong>the root-of-trust model&lt;/strong>. &lt;em>The last link in the crypto chain
doesn&amp;rsquo;t need to be bidirectional&lt;/em>, because &lt;em>the last private key is the
cryptographic root-of-trust, i.e. it&amp;rsquo;s passive&lt;/em>. It doesn&amp;rsquo;t need authentication
from the referrer. It&amp;rsquo;s like grounding in electronics.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 601px">
&lt;img class="card-img-top" src="/blog/2021/11/09/anchoring-chains-of-trust/FirstChain_hud3a6f47a3b24ec8a1164faa8f7d21f8f_322561_591x0_resize_catmullrom_3.png" width="591" height="335">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Crypto Chain with Grounding&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="did-concepts">DID Concepts&lt;/h2>
&lt;p>The DID&amp;rsquo;s controller is an essential piece of the puzzle. It defines
who is the entity in the analogue world, i.e. who owns the DID cryptographically.
As long as we stay in a digital world, it is easiest to bind the controller to
its DID is by using public-key cryptography. The one who has DID controller&amp;rsquo;s
private key is the actual controller.&lt;/p>
&lt;p>For instance, an essential thing for SSI is &lt;em>a DID pairwise&lt;/em>, i.e. a secure
connection between two DIDs or &lt;a href="https://www.w3.org/TR/did-core/#dfn-service">DID
services&lt;/a>. Unfortunately, W3C&amp;rsquo;s
specifications don&amp;rsquo;t underline that enough. Probably because it concentrates on
external properties of DIDs and how the presented specification can implement
different methods. But DIDs cannot work on their own properly. They need to have
a controller, and in Aries, they have agents as well. Also, DIDs doesn&amp;rsquo;t always
present the entity they are pointing, should I say, alone. DIDs present a
&lt;em>subject&lt;/em>. A subject like an IoT device can have many different DIDs for many
different contexts.&lt;/p>
&lt;p>&lt;img src="https://www.w3.org/TR/did-core/diagrams/did_brief_architecture_overview.svg" alt="DID Concepts">&lt;/p>
&lt;p align = "center"> DID Concepts - &lt;a href="https://www.w3.org/TR/did-core/diagrams/did_brief_architecture_overview.svg">www.w3.org&lt;/a>&lt;/p>
&lt;p>In the digital world, it is expected that a controller has its controller, which
has its controller, etc. When public-key cryptography is used to verify this
controlling structure, it&amp;rsquo;s a chain with its root, the final private key, i.e.
&lt;em>the root-of-trust&lt;/em>.&lt;/p>
&lt;h2 id="didcomm-protocols">DIDComm Protocols&lt;/h2>
&lt;p>The following drawing describes a common installation scenario where an agency
based DID controller (leftmost) is implemented as verifiable automata (Finite
State Machine) and it&amp;rsquo;s controlling the DID in the agency. At the right, there
is conventional Edge Agent running in a mobile device that needs a mediator to
help the agent is accessible from the network.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1001px">
&lt;img class="card-img-top" src="/blog/2021/11/09/anchoring-chains-of-trust/BaseArchitecture_hu7901b95f6d30b4426ee2fd9a43a69eb4_499659_991x0_resize_catmullrom_3.png" width="991" height="406">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>DIDComm Installation Example&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>As we can see in the drawing below, there are many different crypto chains in
the current installation. During the study, we were most interested in the
question: what is the best way to implement the root-of-trust for the DID
managed by the multi-tenant agency. Now we have found the answer. Luckily it
existed already.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1001px">
&lt;img class="card-img-top" src="/blog/2021/11/09/anchoring-chains-of-trust/FullArchitecture_hu4b865196eaf2233c1035106d36ae8f15_921984_991x0_resize_catmullrom_3.png" width="991" height="657">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>DIDComm Installation Example and Crypto Chain&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="fido2-authentication">FIDO2 Authentication&lt;/h2>
&lt;p>When we started to understand that the DIDComm protocol chain is not symmetric
to all directions. Or, more precisely, when we understood that there must be one
core agent for each identity domain and from that core or root agent, you should
refer to multiple &lt;strong>separated authenticators&lt;/strong>.&lt;/p>
&lt;p>Let&amp;rsquo;s see what it means to have separate authenticators. The following drawing
illustrates an oldish and problematic way of implementing, e.g. password
manager, DID controller, SSI Edge Agent, etc.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 501px">
&lt;img class="card-img-top" src="/blog/2021/11/09/anchoring-chains-of-trust/PwdMgrStart_hu0f6a53f8c1ff5985fbc060f44873529a_328558_491x0_resize_catmullrom_3.png" width="491" height="549">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Integrated Secure Enclave&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>That is how we first thought our edge agent implementation where the mobile
device&amp;rsquo;s secure element was felt as a cryptographic root-of-trust for an
identity domain that can be individual, organization, etc. However, that leads
to many unnecessary problems in protocol implementation. Most importantly, to
which part of the end-to-end protocol we should implement the use cases like:&lt;/p>
&lt;ul>
&lt;li>I want to use my identity domain from iPhone, iPad, etc. same time.&lt;/li>
&lt;li>I want to have a &amp;lsquo;forget password&amp;rsquo; -type recovery option (by doing nothing)&lt;/li>
&lt;li>I want to handle my identity domain&amp;rsquo;s keys easily. More precisely, I don&amp;rsquo;t
want to know public-key cryptography is used under the hood&lt;/li>
&lt;li>I want to have automatic backups and recovery&lt;/li>
&lt;/ul>
&lt;p>If we think about the drawing above, it&amp;rsquo;s easy to see that the presented use
cases aren&amp;rsquo;t easy to implement secure way if you have integrated a secure
element to your agent in the same machine. In case you have only one integrated
secure enclave for each edge agent, it&amp;rsquo;s near impossible.&lt;/p>
&lt;p>When we separate the secure enclave from the identity domain&amp;rsquo;s root controller
at the design level, everything seems to be set in a place as we can see in the
next drawing.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1001px">
&lt;img class="card-img-top" src="/blog/2021/11/09/anchoring-chains-of-trust/PwdMgrFull_hu4232b9d9afbfe01e455d6f477f2365d3_1060150_991x0_resize_catmullrom_3.png" width="991" height="665">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Separated Secure Enclaves in Multiple Authenticators&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>I don&amp;rsquo;t imply that all of the other parties in the SSI/DID study scene have done
or are making the same mistake we did at the beginning. My point is that
treating secure elements as the root of the crypto chain only and not
integrating it into the software agent or the device agent is running guided us
in the right direction. That allowed us to realize that we don&amp;rsquo;t need a fully
symmetric protocol to bind the controller to the agent. All we needed was the
simplest possible thing, an authenticator, &lt;strong>a trust anchor&lt;/strong> in all potential
cases.&lt;/p>
&lt;p>That innovation brought us a possibility to use modern existing solutions and
still have an equally robust system where we have cryptographic root-of-rust.&lt;/p>
&lt;p>It&amp;rsquo;s essential to understand why we had to consider this so carefully. Should
it be just obvious? We must remember what kind of technology we were
developing. We didn&amp;rsquo;t want to make a mistake that would lead back to
centralization. For example, if we would still totally relay
&lt;a href="https://en.wikipedia.org/wiki/Public_key_infrastructure">PKI&lt;/a>, which is
centralized, we couldn&amp;rsquo;t do that.&lt;/p>
&lt;p>During the years we have studied the SSI/DID technology, we have constantly
tested the architecture with these questions:&lt;/p>
&lt;ol>
&lt;li>Could this work and be safe without any help from the current PKI? (Naturally,
it doesn&amp;rsquo;t mean that we couldn&amp;rsquo;t use individual protocols like TLS, etc. The
infrastructure is the keyword here.)&lt;/li>
&lt;li>Can a use case or a protocol action be executed peer to peer, i.e.
between only two parties? (Doesn&amp;rsquo;t still necessarily mean off-line)&lt;/li>
&lt;/ol>
&lt;h2 id="headless-fido2webauthn-authenticator">Headless FIDO2/WebAuthn Authenticator&lt;/h2>
&lt;blockquote>
&lt;p>FIDO2 is the name of the standard. WebAuthn is just browser JS API to talk to
the authenticators. So correct way to call your server is &amp;ldquo;FIDO2 Server&amp;rdquo; and
to say &amp;ldquo;Authentication with FIDO2&amp;rdquo;. -
&lt;a href="https://github.com/herrjemand/awesome-webauthn#faq">WebAuthn Resource List&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>We started our tests with the new agent API by using implementing our &lt;em>FIDO2
server&lt;/em> and by using only browsers at the beginning. When results, especially
the performance and simplicity, were so good, we decided to go further.&lt;/p>
&lt;p>The following architecture-drawing present the final deployment diagram of the
overall system. The needed FIDO2 components are marked light red, and the ones
we implemented ourselves are marked in red.&lt;/p>
&lt;p>The basic idea was to have a system-level SSO where we implemented authorization
with JWT and authentication with FIDO2 regardless of which type of the entity
needs to be authenticated: individuals, organizations, legal entities, or system
components. For us, it implicated that we needed FIDO2 for service agents, which
meant that a &lt;em>headless&lt;/em> FIDO2 Authenticator was required.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1601px">
&lt;img class="card-img-top" src="/blog/2021/11/09/anchoring-chains-of-trust/DeploymentArchitecture_hu35f0112cd83673eb5666a9c53975c3bf_2052432_1591x0_resize_catmullrom_3.png" width="1591" height="867">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>All Key Components of The System Architecture&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Architectural requirements for the solution were quite complex because we wanted
to have security covered, not to compromise performance, and still support
polyglot development.&lt;/p>
&lt;h2 id="polyglot-authenticator-interface">Polyglot Authenticator Interface&lt;/h2>
&lt;p>FIDO2/WebAuthn specification gives a well over a description of how main
components work. Here we focus on the two most important ones. The first is the
authenticator registration flow which is presented picture below.&lt;/p>
&lt;p>&lt;img src="https://www.w3.org/TR/webauthn/images/webauthn-registration-flow-01.svg" alt="WebAuthn Registration">&lt;/p>
&lt;p align = "center"> FIDO2 Authenticator Registration - &lt;a href="https://www.w3.org/TR/webauthn/images/webauthn-registration-flow-01.svg">www.w3.org&lt;/a>&lt;/p>
&lt;p>To summarise, the above flow registers a new instance of an authenticator. Then
it verifies that the same authenticator is bound to the account. That is done
using a unique public/private key pair where the private key is in the
authenticator. Note that the authenticator doesn&amp;rsquo;t map a particular user to an
account. That is done thru the other process flow and by the &lt;a href="https://www.w3.org/TR/webauthn/#webauthn-relying-party">relying
party&lt;/a>.&lt;/p>
&lt;p>The flow below shows how a registered authenticator is used to authenticate the
account holder.&lt;/p>
&lt;p>&lt;img src="https://www.w3.org/TR/webauthn/images/webauthn-authentication-flow-01.svg" alt="WebAuthn Authentication">&lt;/p>
&lt;p align = "center"> FIDO2 Authentication - &lt;a href="https://www.w3.org/TR/webauthn/images/webauthn-authentication-flow-01.svg">www.w3.org&lt;/a>&lt;/p>
&lt;p>The Command pattern was the perfect solution for the first authenticator
implementation because it supported all of our use cases, but same time was
simplest. Most straightforward to integration was naturally with a programming
language it was implemented which was Go.&lt;/p>
&lt;p>The second thing was to figure out how we would like to implement interprocess
communication. For that, the command pattern is suited very well. Fill the
command with all the needed data and give one of the operations we were
supporting: &lt;code>register&lt;/code> and &lt;code>login&lt;/code> from the FIDO2 standard. The process
communication is handled just as the process starts by reading the command from
JSON. That is suited for Node.js use as well. (For the record, my fantastic
colleague Laura did all the needed Node.js work.)&lt;/p>
&lt;p>When we considered security, we followed our post-compromise principle. We
didn&amp;rsquo;t (yet) try to solve the situation where someone managed to hack the server
and hook a debugger to our processes without our notice. To solve that, we need
&lt;a href="https://en.wikipedia.org/wiki/Trusted_execution_environment">TEE&lt;/a> or similar.
Our specification is ready, but before the implementation, we should think if
it&amp;rsquo;s worth it, and about the use case we are implementing.&lt;/p>
&lt;h3 id="stateless-authenticator">Stateless Authenticator&lt;/h3>
&lt;p>Because you rarely find anything that removes complexity from your
implementation from security-related standards or specifications, it&amp;rsquo;s forth of
mentioning: By following &lt;a href="https://www.w3.org/TR/webauthn/">WebAuthn
specification&lt;/a> I did learn that I could, once
again, use crypto chaining!&lt;/p>
&lt;p>We knew that you would use one authenticator for many different places. That was
clear, of course. But when an authenticator is used for the service or as a
service, there is the next tenancy level.&lt;/p>
&lt;p>Before I started to write the whole thing, I thought that I use our server-side
secure enclave to store all the key pairs there and let the tenant set the
enclave&amp;rsquo;s master key. It would still mean that the implementation would be
state-full. From the operations&amp;rsquo; perspective, we all know what that means: more
things to take care of and manage, but most importantly, one potential
scalability issue to solve.&lt;/p>
&lt;p>The FIDO2 standard documentation describes a perfect solution for our needs
which made our authenticator stateless. You give the other party your public
key, but you give your private key in your &lt;code>credential ID&lt;/code>. It might
first sound crazy, but it&amp;rsquo;s genius indeed.&lt;/p>
&lt;p>Hold on! That cannot be?&lt;/p>
&lt;p>But it is. You have to build your identifier to include your private key, but no
one but you can use it because you have encrypted it with a symmetric master
key. The key that no one but you controls.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1301px">
&lt;img class="card-img-top" src="/blog/2021/11/09/anchoring-chains-of-trust/MasterKeyMain_hu010c6f71b85452493ec3cbb36ce48ca0_2698229_1291x0_resize_catmullrom_3.png" width="1291" height="663">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Stateless Authenticator Implementation&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>The draft above illustrates how our stateless FIDO2 authenticator works at
a master key level. Other factors like a cloning counter and an authenticator ID
are left out for simplicity.&lt;/p>
&lt;ol>
&lt;li>We can ask TEE to create a new key pair for FIDO2 registration, which gives
us a unique key pair that includes &lt;code>public key&lt;/code> and &lt;em>encrypted private key&lt;/em>,
i.e. &lt;code>credential ID&lt;/code>.&lt;/li>
&lt;li>Our authenticator sends the FIDO2 &lt;code>attestation object&lt;/code> to the server.&lt;/li>
&lt;li>When the authenticator receives the FIDO2 challenge during authentication, it builds
it to the key pair in the same format as registration.&lt;/li>
&lt;li>The TEE inside the authenticator builds us the &lt;code>assertion object&lt;/code> ready to send
to the FIDO2 server.&lt;/li>
&lt;/ol>
&lt;p>As we can see, the master key never leaves the TEE. The implementation can
be done with help cloud
&lt;a href="https://en.wikipedia.org/wiki/Hardware_security_module">HSM&lt;/a> or
&lt;a href="https://www.neclab.eu/research-areas/security/nec-labs-introduce-a-new-solution-enables-seamless-provisioning-and-decommissioning-of-tee-based-applications-in-the-cloud">TEE-based app&lt;/a>;
or we can implement an application with the help of &lt;a href="https://aws.amazon.com/ec2/nitro/nitro-enclaves/">AWS
Nitro Enclaves&lt;/a> or similar.&lt;/p>
&lt;p>&lt;strong>Note!&lt;/strong> This is not a good solution for a pure client-side &lt;em>software-based&lt;/em>
authenticator, because it needs help from the hardware, i.e. secure enclave.
It&amp;rsquo;s suitable for &lt;em>hardware-based and certain types of server-side solutions&lt;/em>
where you can use TEE or similar solutions.&lt;/p>
&lt;h2 id="conclusion">Conclusion&lt;/h2>
&lt;p>FIDO2 authentication is an excellent match for DID Wallet authentication. gRPC
transport combined with JWT authorization has been straightforward to use. Our
gRPC SDK allows you to implicitly move the JWT token during the API calls after
opening the server connection. Plus, gRPC&amp;rsquo;s capability to have bidirectional
streams make the programming experience very pleasant. Finally, an option is to
authenticate the gRPC connection between server and client with (no PKI is
needed) TLS certificates: You can authorize software components to bind to your
deployment.&lt;/p>
&lt;p>The SDK and the API we have built with this stack have fulfilled all our
expectations:&lt;/p>
&lt;ul>
&lt;li>security&lt;/li>
&lt;li>performance&lt;/li>
&lt;li>easy to use&lt;/li>
&lt;li>solving &lt;a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY&lt;/a> e.g.
error handling&lt;/li>
&lt;li>polyglot&lt;/li>
&lt;li>cloud-ready&lt;/li>
&lt;li>micro-service friendly&lt;/li>
&lt;/ul>
&lt;p>And hopefully yours. Give it a try!&lt;/p></description></item><item><title>Blog: The Arm Adventure on Docker</title><link>/blog/2021/09/20/the-arm-adventure-on-docker/</link><pubDate>Mon, 20 Sep 2021 00:00:00 +0000</pubDate><guid>/blog/2021/09/20/the-arm-adventure-on-docker/</guid><description>
&lt;p>Since the Findy Agency project launched, Docker has been one of our main tools to help set up the agency development and deployment environments. First of all, we use Docker images for our cloud deployment. On a new release, the CI build pipeline bundles all needed binaries to each service image. After the build, the pipeline pushes Docker images to &lt;a href="https://github.blog/2020-09-01-introducing-github-container-registry/">the GitHub container registry&lt;/a>, from where the deployment pipeline fetches them and updates the cloud environment.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 706px">
&lt;img class="card-img-top" src="/blog/2021/09/20/the-arm-adventure-on-docker/cover-agency-deployment-pipeline_hu45c26a180b4a9f8ed9e980905a894a35_52542_925x925_fit_catmullrom_3.png" width="696" height="385">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Agency deployment pipeline: New release triggers image build in GitHub actions. When the new container image is in the registry, AWS Code Pipelines handles the deployment environment update.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>In addition, we’ve used Docker to take care of the service orchestration in a local development environment. When developing the agency itself, a native setup with full debugging capabilities is naturally our primary choice. However, suppose one wishes only to use the agency services and develop, e.g., a web service utilizing agency capabilities. In that case, the most straightforward approach is to run agency containers with a preconfigured docker-compose script. The script pulls correct images to the local desktop and sets needed configuration parameters. Setting up and updating the three services could be cumbersome without the orchestration, at least for newbies.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 635px">
&lt;img class="card-img-top" src="/blog/2021/09/20/the-arm-adventure-on-docker/arch-overview_hud3b603a9121f1582ad6844475842d5cd_90814_625x625_fit_catmullrom_3.png" width="625" height="546">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>High-level architecture of Findy Agency. Setting up the agency to localhost is most straightforward with the help of a container orchestration tool.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Until recently, we were happy with our image-building pipeline. Local environments booted up with ease, and the deployment pipeline rolled out updates beautifully. Then one day, our colleague with an M1-equipped Mac tried out the docker-compose script. Running the agency images in an Arm-based architecture was something we hadn&amp;rsquo;t considered. We built our Docker images for amd64 architecture, while M1 Macs expect container images for arm64 CPU architecture. It became clear we needed to support also the arm64, as we knew that the popularity of the M1 chipped computers would only increase in the future.&lt;/p>
&lt;h2 id="multi-architecture-support-in-docker">Multi-architecture Support in Docker&lt;/h2>
&lt;p>Typically, when building images for Docker, the image inherits the architecture type from the building machine. And as each processor architecture requires a dedicated Docker image, one needs to build a different container image for each target architecture. To avoid the hassle with the multiple images, Docker has added support for multi-architecture images. It means that there is a single image in the registry, but it can have many variants. Docker will automatically choose the appropriate architecture for the processor and platform in question and pull the correct variant.&lt;/p>
&lt;p>Ok, so Docker takes care of the image selection when running images. How about building them then? There are &lt;a href="https://docs.docker.com/buildx/working-with-buildx/#build-multi-platform-images">three strategies&lt;/a>.&lt;/p>
&lt;ol>
&lt;li>&lt;strong>QEMU emulation support in the kernel&lt;/strong>: QEMU works by emulating all instructions of a foreign CPU instruction set on the host processor. For example, it can emulate ARM CPU instructions on an x86 host machine, and thus, the QEMU emulator enables building images that target another architecture than the host. This approach usually requires the fewest modifications to the existing Dockerfiles, but the build time is the slowest.&lt;/li>
&lt;li>&lt;strong>Multiple native nodes using the same builder instance&lt;/strong>: Hosts with different CPU architectures execute the build. The build time is faster than with the other two alternatives. The drawback is that it requires access to as many native nodes as there are target architectures.&lt;/li>
&lt;li>&lt;strong>Stage in a Dockerfile for cross-compilation&lt;/strong>: This option is possible with languages that support cross-compilation. Arguments exposing the build and the target platforms are automatically available to the build stage. The build command can utilize these parameters to build the binary for the correct target. The drawback is that the builder needs to modify the Dockerfile build commands and perhaps familiarize oneself with using the cross-compilation tools for the target language.&lt;/li>
&lt;/ol>
&lt;p>From these three options, we chose the first one, as it seemed the most straightforward route. However, in our case, the third option might have worked as well since we are building with tools that support cross-compilation, Rust, and GoLang.&lt;/p>
&lt;p>A Docker CLI plugin, &lt;a href="https://docs.docker.com/buildx/working-with-buildx/">buildx&lt;/a>, is required to build multi-architecture images. It extends the docker command with additional features, the multi-architecture build capability being one of them. Using buildx is almost the same as using the ordinary Docker build function. The target platform is added to the command with the flag &lt;code>--platform&lt;/code>.&lt;/p>
&lt;p>Example of building Docker image with buildx for arm64:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker buildx build --platform linux/arm64 -t image_label .
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="reviewing-the-build-receipts">Reviewing the Build Receipts&lt;/h2>
&lt;p>Now we had chosen the strategy and had the tools installed. The next step was to review each image stack and ensure that it was possible to build all image layers for the needed variants.&lt;/p>
&lt;p>Our default image stack consists of &lt;a href="https://github.com/findy-network/findy-common-go/blob/master/infra/aws/Dockerfile.indy.ubuntu">the custom base image&lt;/a> and an application layer (service binary in question). The custom base image contains some tools and libraries that are common for all of our services. It expands the official Docker image for Ubuntu.&lt;/p>
&lt;p>For the official Docker images, there are no problems since Docker provides the needed variants out-of-the-shelf. However, our custom base image installs indy-sdk libraries from the Sovrin Debian repository, and unfortunately, the Debian repository did not provide binaries for arm64. So instead of installing the library from the Debian repository, we needed to add &lt;a href="https://github.com/findy-network/findy-common-go/blob/8bef1cbc4cc7d698275a69a9c9c4aff2622b84de/infra/aws/Dockerfile.indy.ubuntu#L12">a build step&lt;/a> that would build and install the indy-sdk from the sources. Otherwise, building for arm64 revealed no problems.&lt;/p>
&lt;h2 id="integration-to-github-actions">Integration to GitHub Actions&lt;/h2>
&lt;p>The final step was to modify our GitHub Actions pipelines to build the images for the different architectures. Fortunately, Docker provides ready-made actions for setting up QEMU (&lt;em>&lt;a href="https://github.com/docker/setup-qemu-action">setup-qemu-action&lt;/a>&lt;/em>) and buildx (&lt;em>&lt;a href="https://github.com/docker/setup-buildx-action">setup-buildx-action&lt;/a>&lt;/em>), logging to the Docker registry (&lt;em>&lt;a href="https://github.com/docker/login-action">login-action&lt;/a>&lt;/em>), and building and pushing the ready images to the registry (&lt;em>&lt;a href="https://github.com/docker/build-push-action">build-push-action&lt;/a>&lt;/em>).&lt;/p>
&lt;p>We utilized the actions provided by Docker, and &lt;a href="https://github.com/findy-network/findy-agent/blob/master/.github/workflows/release.yml">the release workflow&lt;/a> for findy-agent looks now like this:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yml" data-lang="yml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">release&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">on&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">push&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">tags&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#4e9a06">&amp;#39;*&amp;#39;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">jobs&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">push-image&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">runs-on&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">ubuntu-latest&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">permissions&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">packages&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">write&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">contents&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">read&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">steps&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">actions/checkout@v2&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Set up QEMU&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">docker/setup-qemu-action@v1&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">with&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">platforms&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">all&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Set up Docker Buildx&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">docker/setup-buildx-action@v1&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">name&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">Login to Registry&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">docker/login-action@v1&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">with&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">registry&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">ghcr.io&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">username&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">${{ github.repository_owner }}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">password&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">${{ secrets.GITHUB_TOKEN }}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">run&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">echo &amp;#34;version=$(cat ./VERSION)&amp;#34; &amp;gt;&amp;gt; $GITHUB_ENV&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>- &lt;span style="color:#204a87;font-weight:bold">uses&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">docker/build-push-action@v2&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">with&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">platforms&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">linux/amd64,linux/arm64&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">push&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">true&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">tags&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">|&lt;/span>&lt;span style="color:#8f5902;font-style:italic">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"> ghcr.io/${{ github.repository_owner }}/findy-agent:${{ env.version }}
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"> ghcr.io/${{ github.repository_owner }}/findy-agent:latest&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">cache-from&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">type=registry,ref=ghcr.io/${{ github.repository_owner }}/findy-agent:latest&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">cache-to&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">type=inline&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">file&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">./scripts/deploy/Dockerfile&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The result was as expected; the actions took care of building of the container images successfully. The build process is considerably slower with QEMU, but luckily, the build caches speed up the process.&lt;/p>
&lt;p>Now have the needed variants for our service images in the registry. Furthermore, our colleague with the M1-Mac can run the agency successfully with his desktop.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2021/09/20/the-arm-adventure-on-docker/findy-agent-packages_huee06773afc479fec8fbdb4f9dc73d730_149630_925x925_fit_catmullrom_3.png" width="925" height="483">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>&lt;a href="https://github.com/findy-network/findy-agent/pkgs/container/findy-agent">Docker registry&lt;/a> for Findy agent&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure></description></item><item><title>Blog: Travelogue</title><link>/blog/2021/09/08/travelogue/</link><pubDate>Wed, 08 Sep 2021 00:00:00 +0000</pubDate><guid>/blog/2021/09/08/travelogue/</guid><description>
&lt;p>The success of our team is measured:&lt;/p>
&lt;ul>
&lt;li>How well do we understand &lt;em>certain&lt;/em> emerging technologies?&lt;/li>
&lt;li>How relevant they are to the business we are in?&lt;/li>
&lt;li>How much potential do they have for our company&amp;rsquo;s business?&lt;/li>
&lt;/ul>
&lt;p>If you are asking yourself if the order of the list is wrong, the answer is, it
is not.&lt;/p>
&lt;p>We have learned that you will fail if you prioritize technologies by their
business value too early. There is a catch, though. You must be sure that you
will not fall in love with the technologies you are studying. Certain scepticism
is welcomed in our line of work. That attitude may follow thru this post as
well. You have now been warned, at least.&lt;/p>
&lt;h3 id="technology-tree">Technology Tree&lt;/h3>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 2001px">
&lt;img class="card-img-top" src="/blog/2021/09/08/travelogue/TechTree_hucb3e947ff7ac3c644fea522c44e98b42_1584631_1991x0_resize_catmullrom_3.png" width="1991" height="1120">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Findy Agency Tech Tree&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Technology roots present the most important &lt;em>background knowledge&lt;/em> of our study.
The most fundamental technologies and study subjects are in the trunk. The
trunk is the backbone of our work. It ties it all together. Branches and leaves
are outcomes, conclusions, and key learnings. At the top of the tree, some
future topics are considered but not implemented or even tried yet.&lt;/p>
&lt;p>Even if the technology tree illustrates the relevant technologies for the
subject, we will not address them in this post. &lt;strong>We recommend you to study the
tree for a moment&lt;/strong> to get the picture. You will notice that there aren&amp;rsquo;t any
mention of VC. For us, the concept of VC is an internal feature of
&lt;a href="https://www.w3.org/TR/vc-data-model/">DID system&lt;/a>. Naturally, there are a huge
amount of enormous study subjects inside VCs like ZKP, etc. But this approach
has to lead us to concentrate on the network itself and the structure it should
have.&lt;/p>
&lt;p>The tree has helped us to see how things are bound together and what topics are
the most relevant for the study area.&lt;/p>
&lt;h3 id="trust-triangle">Trust Triangle&lt;/h3>
&lt;p>The famous SSI trust triangle is an excellent tool to simplify what is
important and what is not. As we can see, everything builds on peer to peer
connections, thick arrows. VCs are issued, and proofs are presented thru them.
The only thing that&amp;rsquo;s not yet solved &lt;em>at the technology level&lt;/em> is the trust
arrow in the triangle. (I know the recursive trust triangle, but I disagree with
how it&amp;rsquo;s thought to be implemented). But &lt;em>this blog post&lt;/em> is not about that
either.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 605px">
&lt;img class="card-img-top" src="/blog/2021/09/08/travelogue/trust-triangle_hua2e42792a9d20037c5f572b0412e67c1_57626_925x925_fit_catmullrom_3.png" width="595" height="392">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The SSI Trust Triangle&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="targets-and-goals">Targets and Goals&lt;/h3>
&lt;p>Every project&amp;rsquo;s objectives and goals change during the execution. The longer the
project, the more pivots it has. (Note that I use the term &lt;em>project&lt;/em> quite
freely in the post). When we started to work with DID/SSI field, the goal was to
build &lt;strong>a standalone mobile app demo&lt;/strong> of the identity wallet based on
Hyperledger Indy. We started in &lt;em>test drive mode&lt;/em> but built a full DID agency
and published it as OSS. The journey has been inspiring, and we have learned a
lot.&lt;/p>
&lt;p>In every project, it&amp;rsquo;s important to maintain the scope. Thanks to the nature of
our organisation we didn&amp;rsquo;t have changing requirements. The widening of the scope
came mostly from the fact that the whole area of SSI and DID were evolving. It
still is.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2021/09/08/travelogue/targets_hu3c26761ab0ee4aee9c5a7a0b4088e778_867526_925x925_fit_catmullrom_3.png" width="925" height="520">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>The Journey From Identity Wallet to Identity Ecosystem&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Many project goals changed significantly during the execution, but that was part
of the job. And as DID/SSI matured, we matured as well, and goals to our work
aren&amp;rsquo;t &lt;em>so&lt;/em> &lt;em>test-driven&lt;/em> mode anymore. We still test other related technologies
that can be matched to DID/SSI or even replace some parts of it
but have transited to the state where we have started to build our own related
core technologies to the field.&lt;/p>
&lt;p>Incubators usually start their trip by testing different hypotheses and trying
them out in practice. We did the same but more on the practical side. We didn&amp;rsquo;t
have a formal hypothesis, but we had some use cases and a vision of how modern
architecture should work and its scaling requirements. Those kinds of
principles lead our &lt;em>decision-making process&lt;/em> during the project.
(Maybe some of us write a detailed blog about how our emerging tech process and
organisation worked.)&lt;/p>
&lt;h2 id="the-journey">The journey&lt;/h2>
&lt;p>We have been building our multi-tenant agency since the beginning of 2019.
During that time, we have tried many different techniques, technologies and
architectures, and application metaphors. We think we have succeeded to find
interesting results.&lt;/p>
&lt;p>In the following chapters, we will report the time period from the beginning of
2019 to autumn of 2021 in half of a year intervals. I really recommend that you
look at the timelines carefully because they include valuable outcomes.&lt;/p>
&lt;h3 id="2019h1">2019/H1&lt;/h3>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 2010px">
&lt;img class="card-img-top" src="/blog/2021/09/08/travelogue/spring19_hu29db0a4a24cce1cc4a7a017360286d3b_559718_2000x0_resize_catmullrom_3.png" width="2000" height="1125">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>2019/H1&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h5 id="the-start">The Start&lt;/h5>
&lt;p>Me:&lt;/p>
&lt;blockquote>
&lt;p>&amp;ldquo;I&amp;rsquo;m interested in studying new tech by programming with it.&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;p>Some block-chain experts in the emerging technologies team:&lt;/p>
&lt;blockquote>
&lt;p>&amp;ldquo;We need an identity wallet to be able to continue with our other projects.
Have you ever heard of Hyperledger Indy..&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;p>In one week, I have been smoke-tested indy SDK on iOS and Linux. During the
spring, we ended up following the Indy&amp;rsquo;s proprietary agent to agent
protocol, &lt;strong>but&lt;/strong> we didn&amp;rsquo;t use &lt;em>libcvx&lt;/em> for that because:&lt;/p>
&lt;blockquote>
&lt;p>This library is currently in an &lt;strong>experimental&lt;/strong> state and is not part of
official releases. - [indy SDK GitHub pages]&lt;/p>
&lt;/blockquote>
&lt;p>To be honest, that was the most important reason because we have had so much
extra work with other Indy libs, and of course, we would need a wrapper at least for
Go. It was an easy decision. Afterwards, it was the right because the DIDComm
protocol is the backbone of everything with SSI/DID. And now, when it&amp;rsquo;s in our
own (capable) hands, it&amp;rsquo;s made many such things possible which weren&amp;rsquo;t otherwise.
We will publish a whole new technical blog series of our multi-tenant DIDComm
protocol engine.&lt;/p>
&lt;p>All of the modern, native mobile apps end up been written from two parts: the mobile
app component running on the device and the server part doing everything it can
to make the mobile app&amp;rsquo;s life easier. Early stages, DIDComm&amp;rsquo;s edge and cloud agent
roles weren&amp;rsquo;t that straightforward. From every point of view, it seemed overly
complicated. But still, we stuck to it.&lt;/p>
&lt;h5 id="first-results">First Results&lt;/h5>
&lt;p>At the end of spring 2019, we had a quick and dirty demo of the system, which had
&lt;strong>multi-tenant&lt;/strong> agency to serve cloud agents and iOS mobile app to run edge
agents. An EA onboarded itself to the agency with the same DID Connect
protocol, which was used everywhere. Actually, an EA and a CA
used Web Sockets as a transport mechanism for indy&amp;rsquo;s DIDComm messages.&lt;/p>
&lt;p>We hated the protocol. It was insane. But it was DID protocol, wasn&amp;rsquo;t it?&lt;/p>
&lt;p>The system was end to end encrypted, but the indy protocol had its flaws, like
being synchronous. We didn&amp;rsquo;t yet have any persistent state machine or the other
basics of the communication protocol systems. Also, the whole thing felted
overly complicated and old &amp;ndash; it wasn&amp;rsquo;t modern cloud protocol.&lt;/p>
&lt;h5 id="third-party-integration-demo">Third party integration demo&lt;/h5>
&lt;p>In early summer ended up building a demo that didn&amp;rsquo;t follow totally the current
architecture, because the mobile app&amp;rsquo;s edge agent was communicating directly to
the third party agent. This gave us a lot of experience, and for me, it gave
needed time to spec what kind of protocol the DIDComm should be and what kind of
protocol engine should run it.&lt;/p>
&lt;p>It was a weird time because indy&amp;rsquo;s legacy agent to agent protocol didn&amp;rsquo;t have a
public, structured and formal specification of its protocol.&lt;/p>
&lt;p>Those who are interested in history can read more from
&lt;a href="https://hyperledger-indy.readthedocs.io/projects/hipe/en/latest/text/0002-agents/README.html">here&lt;/a>.&lt;/p>
&lt;p>The integration project made it pretty clear for us what kind of protocol was
needed.&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Async with explicit state machine&lt;/strong>&lt;/p>
&lt;/blockquote>
&lt;p>DIDComm must be async and message-driven simple because it&amp;rsquo;s deliberative in
its nature. Two agents are negotiating for issuing, proofing, etc.&lt;/p>
&lt;h5 id="aries-news">Aries news&lt;/h5>
&lt;p>Hyperledger Aries was set up during the summer, which was good because it showed
the same we learned. We were on the right path.&lt;/p>
&lt;h5 id="code-delivery-for-a-business-partner">Code Delivery For a Business Partner&lt;/h5>
&lt;p>For this mail-stone, we ended up producing some documentation, mostly to
explain the architecture. During the whole project, we have had a comprehensive
unit and integration test harness.&lt;/p>
&lt;p>At this point, we had all of the important features covered: issuing, holding,
present and verify proofs in a quick and dirty way. Now we knew the potential.&lt;/p>
&lt;h5 id="results-2019-summer">Results 2019 Summer&lt;/h5>
&lt;p>We had managed to implement pre-Aries DIDComm over HTTP and WebSocket. We had
a multi-tenant agency running cloud agents even though it was far from
production readiness. Everything was end to end encrypted. The current agency
supported indy&amp;rsquo;s ledger transactions, and first, we had taken some tests from
issuing and proofing protocols. We started to understand what kind of beast was
tearing at us from another end of the road.&lt;/p>
&lt;h3 id="2019h2">2019/H2&lt;/h3>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 2010px">
&lt;img class="card-img-top" src="/blog/2021/09/08/travelogue/autumn19_hu29db0a4a24cce1cc4a7a017360286d3b_515478_2000x0_resize_catmullrom_3.png" width="2000" height="1125">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>2019/H2&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h5 id="start-of-the-async-protocol-development">Start Of The Async Protocol Development&lt;/h5>
&lt;p>When we started architecture redesign after the summer break,
we had a clear idea of what kind of direction we should take and what to leave for
later:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Cloud-first&lt;/strong> and we have newer wanted to step back on that.&lt;/li>
&lt;li>&lt;strong>Modern micro-service architecture&lt;/strong> targeting continuous delivery and
scalability. That leads to a certain type of technology stack which consists of
techs like Go, gRPC, Docker (or other containerization technology), container
orchestration like K8s, etc. One key requirement was that hardware utilization
must be perfect, i.e. tiny servers are enough.&lt;/li>
&lt;li>&lt;strong>No support for offline&lt;/strong> use cases &lt;em>for now&lt;/em>.&lt;/li>
&lt;li>&lt;strong>No revocation&lt;/strong> until there is a working solution. Credit card revocation has
taught us a lot. Scalable and fast revocation is a hard problem to solve.&lt;/li>
&lt;li>Message routing should not be part of the protocol&amp;rsquo;s explicit &amp;lsquo;headers&amp;rsquo;, i.e.
there is &lt;strong>only one service endpoint for a DID&lt;/strong>. We should naturally handle the
service endpoint so that privacy is maintained as it is in our agency. By
leaving routing out, it has been making everything so much simple. Some
technologies can do that for us for free, like Tor. We have tested Tor, and it
works pretty well for setting service endpoints and also connecting to them.&lt;/li>
&lt;li>&lt;strong>Use push notifications along with the WebSockets&lt;/strong>, i.e. lent APNS to trigger
edge agents when they were not connected to the server.&lt;/li>
&lt;/ul>
&lt;h5 id="multi-ledger-architecture">Multi-ledger Architecture&lt;/h5>
&lt;p>Because everything goes through our Go wrapper to the Plenum ledger, I made a
version that used memory or plain file instead of the ledger as a hobby project.
It was meant to be used only for tests and development. Later the plug-in
architecture has allowed us to have other persistent saving media as well. But
more importantly, it has helped development and automatic testing a lot.&lt;/p>
&lt;p>Technically the &lt;em>hack&lt;/em> is to use &lt;code>pool handle&lt;/code> to tell if the system is
connected to a ledger or some other predefined media. &lt;code>indy&lt;/code> API has only two
functions that take &lt;code>pool handle&lt;/code> as an argument but doesn&amp;rsquo;t use it at all &lt;em>or&lt;/em>
a handle is an option.&lt;/p>
&lt;h5 id="server-side-secure-enclaves">Server Side Secure Enclaves&lt;/h5>
&lt;p>During the server-side development, we wanted to have at least post-compromised
secured key storage for cloud servers. Cloud environments like AWS give you
managed storage for master secrets, but we needed more when developing OSS
solutions with high performance and scalability requirements.&lt;/p>
&lt;p>Now we store our most important keys for LMDB-based fast key-value storage
fully encrypted. Master keys for installation are in a managed cloud environments
like AWS, Google, Azure, etc.&lt;/p>
&lt;h5 id="first-multi-tenant-chat-bot">First Multi-tenant Chat Bot&lt;/h5>
&lt;p>The first running version of the chatbot used a semi-hard-coded version.
It supported only sequential steps: a single line in a text file,
&lt;code>CredDefIds&lt;/code> in its own file, and finally text messages in its own files. The
result was just a few lines of Go code, thanks to its concurrent model.&lt;/p>
&lt;p>The result was so good that I made a backlog issue to start studying to
use SCXML or some other exciting language for chatbot state machines later.
About a year later, I implemented a state machine on my own with a proprietary YAML
format.&lt;/p>
&lt;p>But that search isn&amp;rsquo;t totally over. Before that, I considered many different
options, but there wasn&amp;rsquo;t much of an OSS alternative. One option could be to
embed Lua combined with the current state machine engine and replace the memory
model with Lua. We shall see what the real use case needs are.&lt;/p>
&lt;p>I personally think that an even more important approach would be &lt;strong>a state machine
verifier&lt;/strong>. Keeping that as a goal sets strict limits to the computation
model we could use. What we have learned now is you don&amp;rsquo;t need the full power of
general programming language but
&lt;a href="https://en.wikipedia.org/wiki/Automata_theory">finite state machine (automata theory)&lt;/a>
could just be enough.&lt;/p>
&lt;h4 id="2019h2-results">2019/H2 Results&lt;/h4>
&lt;p>We had implemented all the most important use cases with our new protocol
engine. We had an symmetric agent which could be in all of the needed roles of SSI:
a holder, an issuer, and a verifier. Also, the API seemed to be OK at a high
level of abstraction. The individual messages were shit.&lt;/p>
&lt;p>At the end of the year, we also had a decent toolbox both on command-line and
especially on the web.&lt;/p>
&lt;h3 id="2020h1">2020/H1&lt;/h3>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 2010px">
&lt;img class="card-img-top" src="/blog/2021/09/08/travelogue/spring20_hu29db0a4a24cce1cc4a7a017360286d3b_486983_2000x0_resize_catmullrom_3.png" width="2000" height="1125">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>2020/H1&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h5 id="findy-consortium-level-oss-publication">Findy-consortium Level OSS Publication&lt;/h5>
&lt;p>At the beginning of 2020, we decided to publish all the produced
code inside the Findy consortium. We produced the new GitHub account, and code
without history moved from original repos to new ones.&lt;/p>
&lt;p>Even the decision brought a lot of routine work for that moment, it also brought
many good things:&lt;/p>
&lt;ul>
&lt;li>refactoring,&lt;/li>
&lt;li>interface cleanups,&lt;/li>
&lt;li>documentation updates.&lt;/li>
&lt;/ul>
&lt;h5 id="aca-py-interoperability-tests">ACA-Py Interoperability Tests&lt;/h5>
&lt;p>We implemented the first version of the new async protocol engine with existing
JSON messages came from legacy indy a2a protocols. It&amp;rsquo;s mostly because I
wanted to build it in small steps, and it worked pretty well.&lt;/p>
&lt;p>Most of the extra work did come from the legacy API we had. JSON messages over
indy&amp;rsquo;s proprietary DIDComm. As always, some bad but some good: because we had to
keep both DIDComm message formats, I managed to integrate a clever way to
separate different formats and still generalise with Go&amp;rsquo;s interfaces.&lt;/p>
&lt;h5 id="new-cli">New CLI&lt;/h5>
&lt;p>We noticed that Agency&amp;rsquo;s command-line UI started to be too complicated. Go has
a clever idea of how you can do services without environmental variables. I&amp;rsquo;m
still the guy who would stick with that, but it was a good idea to widen the
scope to make our tools comfortable for all new users.&lt;/p>
&lt;p>Our design idea was to build CLI, which follows subcommands like git and docker
nowadays. The latest version we have now is quite good already, but the road was
rocky. It is not easy to find the right structure the first time. The more you
use your CLI by yourself, the more you start to notice what is intuitive and
what is not.&lt;/p>
&lt;p>We decided to separate CLI commands from Agency to own tool and git repo. It was
good to move for that time, and when we managed to make it right, we were able to
move those same commands pack to the agency one year later because we needed CLI
tool without any &lt;em>libindy&lt;/em> dependencies. That is a good example of successful
software architecture work. You cannot predict the future, but you can prepare
yourself for change.&lt;/p>
&lt;h3 id="2020h2">2020/H2&lt;/h3>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 2010px">
&lt;img class="card-img-top" src="/blog/2021/09/08/travelogue/autumn20_hu29db0a4a24cce1cc4a7a017360286d3b_544015_2000x0_resize_catmullrom_3.png" width="2000" height="1125">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>2020/H2&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h5 id="architecture-planning">Architecture Planning&lt;/h5>
&lt;p>I had had quite a long time the idea of using gRPC for the Cloud Agent
controller. My core idea was to get rid of the EA because, currently, it was
just an onboarding tool. The wallet had, included only the pairwise DID to its
cloud agent, nothing else. The actual wallet (we called it worker edge agent
wallet) was the real wallet, where the VCs were. I went thru
many similar protocols until I found FIDO UAF. The protocol is similar to
DIDComm&amp;rsquo;s pairwise protocol, but it&amp;rsquo;s not symmetric. Another end is the server,
and the other has the authenticator &amp;ndash; the cryptographical root of
trust.&lt;/p>
&lt;p>When I presented an internal demo of the gRPC with the JWT authorization and
explained that authentications would be FIDO2 WebAuthn, we were ready to start
the architecture transition. Everything was still good when I implemented the
first FIDO server with the help of Duo Labs Go packages. Our FIDO2 server was
now capable of allocating cloud agents. But there was one missing part I was
hoping someone in the OSS community would implement until we needed it. It was a
headless WebAuthn/UAF authenticator for those issuers/verifiers running as
service agents. How to onboard them, and how they would access the agency&amp;rsquo;s
resources with the same JWT authorization? To allow us to proceed, we added
support to get JWT by our old API. It&amp;rsquo;s was only intermediated solution but
served its purpose.&lt;/p>
&lt;h5 id="learnings-when-implementing-the-new-architecture">Learnings when implementing the new architecture&lt;/h5>
&lt;ul>
&lt;li>implicit JWT authorization helps gRPC usage a lot and simplifies it too.&lt;/li>
&lt;li>gRPC streams and Go&amp;rsquo;s channel is just excellent together.&lt;/li>
&lt;li>You should use pre-generated wallet keys for indy wallets.&lt;/li>
&lt;li>We can integrate performance and scalability tests into CI.&lt;/li>
&lt;li>gRPC integration and unit testing could be done in the same way as with HTTP
stack in Go, i.e. inside a single process that can play both client and server.&lt;/li>
&lt;/ul>
&lt;h5 id="highlights-of-the-end-of-the-year-2020">Highlights of the end of the year 2020&lt;/h5>
&lt;p>We started to build for new SA architecture and allowed both our APIs to
existing. WebAuth server, headless authenticator, and Vault first versions were
now ready. Also, I did the first version of a state machine for service agent
implementation. We had an option to use immuDB instead of Plenum ledger.&lt;/p>
&lt;h3 id="2021h1">2021/H1&lt;/h3>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 2010px">
&lt;img class="card-img-top" src="/blog/2021/09/08/travelogue/spring21_hu29db0a4a24cce1cc4a7a017360286d3b_511190_2000x0_resize_catmullrom_3.png" width="2000" height="1125">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>2021/H1&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Now we have an architecture that we can live with. All the important elements
are in place. Now we just clean it up.&lt;/p>
&lt;h5 id="summary-of-spring-2021-results">Summary of Spring 2021 Results&lt;/h5>
&lt;p>Until the summer, the most important results have been:&lt;/p>
&lt;ul>
&lt;li>Headless WebAuthn authenticator&lt;/li>
&lt;li>React-based Web Wallet&lt;/li>
&lt;li>Lots of documentation and examples&lt;/li>
&lt;li>Agency&amp;rsquo;s gRPC API v1&lt;/li>
&lt;li>Polyglot implementations gRPC: TypeScript, Go, JavaScript&lt;/li>
&lt;li>New toolbox both Web and Command-line&lt;/li>
&lt;li>The full OSS release&lt;/li>
&lt;/ul>
&lt;p>As said, all of the important elements are in place. However, our solution is
based on &lt;code>libindy&lt;/code>, which will be interesting because the Aries group moves to
shared libraries, whereas the original contributor continues with it. We haven&amp;rsquo;t
made the decision yet on which direction we will go. Or do we even need to
choose? At least in the meantime, we could add some new solutions and run them
both. Thanks to our own architecture and interfaces, those are plausible options
for our agency.&lt;/p>
&lt;p>There are many interesting study subjects we are continuing to work on within
SSI/DID. We will report them in upcoming blog posts. Stay tuned, folks!&lt;/p></description></item><item><title>Blog: Announcing Findy Agency</title><link>/blog/2021/08/11/announcing-findy-agency/</link><pubDate>Wed, 11 Aug 2021 00:00:00 +0000</pubDate><guid>/blog/2021/08/11/announcing-findy-agency/</guid><description>
&lt;p>Findy Agency provides a &lt;a href="https://www.hyperledger.org/use/aries">Hyperledger Aries&lt;/a> compatible identity agent service. It includes a web wallet for individuals and an API for organizations to utilize functionality related to verified data exchange: issuing, holding, verifying, and proving credentials. The agents hosted by the agency operate using DIDComm messaging and &lt;a href="https://github.com/hyperledger/aries-rfcs">Hyperledger Aries protocols&lt;/a>. Thus it is interoperable with other Hyperledger Aries compatible agents. The supported verified credential format is currently &lt;a href="https://github.com/hyperledger/indy-sdk">Hyperledger Indy&lt;/a> “Anoncreds” that work with Hyperledger Indy distributed ledger. However, the plan is to add more credential formats in the future.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2021/08/11/announcing-findy-agency/vision_hu68846d3af499a7706e2100471d9aa9d5_34254_925x925_fit_catmullrom_3.png" width="925" height="322">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>Main design principles of Findy Agency&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>In this post, we share some background information on the project. If you want to skip the history, start directly with &lt;a href="/docs">the documentation&lt;/a> or &lt;a href="https://github.com/findy-network/findy-wallet-pwa/tree/dev/tools/env#agency-setup-for-local-development">launch Findy Agency in your local computer&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Verified data exchange as digitalization enabler&lt;/strong>&lt;/p>
&lt;p>Distributed and self-sovereign identity, along with verified data exchange between different parties, has been an area of our interest at &lt;a href="https://op-lab.fi/">the OP innovation unit&lt;/a> for quite some time. After all, when thinking about the next steps of digitalization, secure and privacy-preserving handling of identity is one of the main problem areas. When individuals and organizations can prove facts of themselves digitally, it will enable us to streamline and digitalize many processes that may be still cumbersome today, including those in the banking and insurance sectors.&lt;/p>
&lt;p>Since 2019 the Findy team at OP has been working on two fronts. We have collaborated with other Finnish organizations to set up a cooperative to govern &lt;a href="https://findy.fi/en/">a national identity network Findy&lt;/a>. At the same time, our developers have researched credential exchange technologies, concentrating heavily on Hyperledger Indy and Aries.&lt;/p>
&lt;p>&lt;strong>From scratch to success with incremental cycles&lt;/strong>&lt;/p>
&lt;p>When we started the development at the beginning of 2019, the verified credential world looked a whole lot different. Low-level indy-sdk was all that a developer had if wanting to work with indy credentials. It contained basic credential manipulation functionality but almost nothing usable related to communication between individuals or organizations. We were puzzled because the scenarios we had in mind involved users with mobile applications and organizations with web services and interaction happening between these two.&lt;/p>
&lt;p>Soon we realized that we needed to build all the missing components ourselves if we would want to do the experiments. And so, after multiple development cycles and as a result of these experiments became Findy Agency. The path to this publication has not always been straightforward: there have been complete refactorings and changes in the project direction along the way. However, we feel that now we have accomplished something that truly reflects our vision.&lt;/p>
&lt;figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 935px">
&lt;img class="card-img-top" src="/blog/2021/08/11/announcing-findy-agency/bot-scenario_hu15894898d496192ef1d77a0f852ae033_200283_925x925_fit_catmullrom_3.png" width="925" height="520">
&lt;figcaption class="card-body px-0 pt-2 pb-0">
&lt;p class="card-text">
&lt;em>One of the team's experiments, Findy Bots, was built on Findy Agency. See demo video in &lt;a href="https://www.youtube.com/watch?v=gVr8KwISMS4">Youtube&lt;/a>.&lt;/em>
&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>&lt;strong>Why the hard way?&lt;/strong>&lt;/p>
&lt;p>The situation is not anymore so sad for developers wanting to add credential support to their app as it was three years ago. There are several service providers and even &lt;a href="https://github.com/hyperledger/aries#aries-agent-frameworks">open source solutions&lt;/a> one can choose from. So why did we choose the hard way and wrote an agency of our own? There are several reasons.&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Experience&lt;/strong>: We believe that verified data technology will transform the internet in a profound way. It will have an impact on perhaps even the most important data processing systems in our society. We want to understand the technology thoroughly so that we know what we are betting on.&lt;/li>
&lt;li>&lt;strong>Open-source&lt;/strong>: As we stated in the previous bullet, we want to be able to read and understand the software we are running. In addition, community-given feedback and contributions improve the software quality. There is also a good chance that open-sourced software is more secure than proprietary since it has more eyes looking at the possible security flaws.&lt;/li>
&lt;li>&lt;strong>Pragmatic approach&lt;/strong>: We have scarce resources, so we have to concentrate on the most essential use cases. We do not wish to bloat the software with features that are far in the future if valid at all.&lt;/li>
&lt;li>&lt;strong>Performance&lt;/strong>: We aim to write performant software with the right tools for the job. We also value developer performance and hence have a special eye for the quality of the API.&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>The Vision&lt;/strong>&lt;/p>
&lt;p>Our solution contains several features that make our vision and that we feel most of other open-source solutions are missing.&lt;/p>
&lt;p>Findy Agency has been &lt;strong>multi-tenant&lt;/strong> from the beginning of the project. It means single agency installation can securely serve multiple individuals and organizations without extra hassle.&lt;/p>
&lt;p>Agency architecture is based on &lt;strong>a cloud strategy&lt;/strong>. Credential data is stored securely in the cloud and cloud agents do all the credentials-related hard work on behalf of the agency users (wallet application/API users). The reasoning for the cloud strategy is that we think that individuals store their credential data rather with a confided service provider than worry about losing their device or setting up complex backup processes. Furthermore, the use cases relevant to us are also always executed online, so we have knowingly left out the logic aiming for offline scenarios. This enabled us to reduce the complexity related to mediator implementation.&lt;/p>
&lt;p>Due to the cloud strategy, we could drop out the requirement for the mobile application. Individuals can use &lt;strong>the web wallet&lt;/strong> with their device browser. Authentication to the web wallet is done with secure and passwordless &lt;strong>&lt;a href="https://webauthn.guide/">WebAuthn/FIDO protocol&lt;/a>&lt;/strong>.&lt;/p>
&lt;p>Agency backend services are implemented with &lt;strong>performance&lt;/strong> in mind. That is why we selected performant &lt;a href="https://golang.org/">GoLang&lt;/a> and &lt;a href="https://grpc.io/">gRPC&lt;/a> as the base technologies of the project.&lt;/p>
&lt;p>&lt;strong>Next steps&lt;/strong>&lt;/p>
&lt;p>We do not regard Findy Agency as a finalized product, there is still a lot to be done. However, we think it can already be used to experiment and build verified data utilizing scenarios. Our work continues with further use case implementations as well as improving the agency with selected features based on our experimentation results.&lt;/p>
&lt;p>The codes are available in &lt;a href="https://github.com/findy-network">GitHub&lt;/a> and &lt;a href="/docs">the developer documentation&lt;/a> will be improved in the near future. We look forward getting feedback from the community.&lt;/p></description></item></channel></rss>